<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clasificación básica de imágenes con TensorFlow 2.4 — 51:05 min &mdash; documentación de Cursos de Analítica y Machine Learning - </title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Predicción de la eficiencia de combustible usando regresión con Early Stopping : 40:00 min" href="1-02_Prediccion_de_la_eficiencia_de_combustible_usando_regresion_con_Early_Stopping.html" />
    <link rel="prev" title="Segmentación del mercado de adolecentes en PySpark" href="../pyspark/6-15-MLlib-main-clustering.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Cursos de Analítica y Machine Learning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Pregrado</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html">Redes Neuronales Artificiales y Aprendizaje Profundo</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-01-2022-03-08">Sesión 01 (2022-03-08)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-02-2022-03-15">Sesión 02 (2022-03-15)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-03-2022-03-22">Sesión 03 (2022-03-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-04-2022-03-29">Sesión 04 (2022-03-29)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-05-2022-04-05">Sesión 05 (2022-04-05)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-06-2022-04-19">Sesión 06 (2022-04-19)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-07-2022-04-26">Sesión 07 (2022-04-26)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-08-2022-05-03">Sesión 08 (2022-05-03)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-09-2022-05-10">Sesión 09 (2022-05-10)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-10-2022-05-17">Sesión 10 (2022-05-17)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-11-2022-05-24">Sesión 11 (2022-05-24)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-12-2022-05-31">Sesión 12 (2022-05-31)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-13-2022-06-07">Sesión 13 (2022-06-07)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-14-2022-06-14">Sesión 14 (2022-06-14)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-15-2022-06-21">Sesión 15 (2022-06-21)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-16-2022-06-28">Sesión 16 (2022-06-28)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#material-para-proximos-cursos-2022">Material para próximos cursos (2022)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos_de_analitica/index.html">Fundamentos de Analítica</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Posgrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_de_grandes_datos/index.html">Analítica de Grandes Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ciencia_de_los_datos/index.html">Ciencia de los Datos Aplicada</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../productos_de_datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_avanzada/index.html">Analítica Avanzada</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cursos de Analítica y Machine Learning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html">Redes Neuronales Artificiales y Aprendizaje Profundo</a> &raquo;</li>
      <li>Clasificación básica de imágenes con TensorFlow 2.4 — 51:05 min</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/tensorflow__ML_basics/1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Clasificación-básica-de-imágenes-con-TensorFlow-2.4-—-51:05-min">
<h1>Clasificación básica de imágenes con TensorFlow 2.4 — 51:05 min<a class="headerlink" href="#Clasificación-básica-de-imágenes-con-TensorFlow-2.4-—-51:05-min" title="Enlazar permanentemente con este título"></a></h1>
<ul class="simple">
<li><p>Última modificación: Mayo 3, 2021 | <a class="reference external" href="https://youtu.be/yz2qcY_kEco">YouTube</a></p></li>
</ul>
<p>Adaptado de en:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.tensorflow.org/tutorials/quickstart/beginner">https://www.tensorflow.org/tutorials/quickstart/beginner</a></p></li>
<li><p><a class="reference external" href="https://www.tensorflow.org/tutorials/keras/classification">https://www.tensorflow.org/tutorials/keras/classification</a></p></li>
</ul>
<p><img alt="assets/fashion-mnist-sprite.png" src="../../_images/fashion-mnist-sprite.png" /></p>
<div class="section" id="Importación-de-librerías">
<h2>Importación de librerías<a class="headerlink" href="#Importación-de-librerías" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.5.0
</pre></div></div>
</div>
</div>
<div class="section" id="Carga-y-configuración-del-dataset-FASHION-MNIST">
<h2>Carga y configuración del dataset FASHION MNIST<a class="headerlink" href="#Carga-y-configuración-del-dataset-FASHION-MNIST" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Descarga de los datos</span>
<span class="c1">#</span>
<span class="p">(</span>
    <span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">),</span>
    <span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">),</span>
<span class="p">)</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fashion_mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="c1">#</span>
<span class="c1">#  Nombres de las clases</span>
<span class="c1">#</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;T-shirt/top&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Trouser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Pullover&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Dress&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Coat&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sandal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Shirt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sneaker&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bag&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Ankle boot&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valor</span><span class="se">\t</span><span class="s2">Nombre&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">class_names</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-labels-idx1-ubyte.gz
32768/29515 [=================================] - 0s 5us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-images-idx3-ubyte.gz
26427392/26421880 [==============================] - 2s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-labels-idx1-ubyte.gz
8192/5148 [===============================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-images-idx3-ubyte.gz
4423680/4422102 [==============================] - 1s 0us/step
Valor   Nombre
----------------------------------------
0       T-shirt/top
1       Trouser
2       Pullover
3       Dress
4       Coat
5       Sandal
6       Shirt
7       Sneaker
8       Bag
9       Ankle boot
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Cantidad de patrones de entrenamiento y prueba</span>
<span class="c1">#</span>
<span class="n">train_images</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_labels</span><span class="p">),</span> <span class="n">test_images</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((60000, 28, 28), 60000, (10000, 28, 28), 10000)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Ejemplos de las figuras que contiene el dataset</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">plot_mnist_examples</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>

    <span class="c1"># images, labels = images.copy(), labels.copy()</span>

    <span class="c1">#</span>
    <span class="c1"># Las figuras son de 28x28 pixels, y el</span>
    <span class="c1"># color va enntre 0 y 255. Se realiza la</span>
    <span class="c1"># normalización del color al rango [0, 1]</span>
    <span class="c1">#</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">images</span> <span class="o">/</span> <span class="mf">255.0</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">img</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">class_names</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[(</span><span class="n">img</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span>  <span class="k">for</span> <span class="n">img</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">lbl</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>


<span class="n">plot_mnist_examples</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_0.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_1.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_2.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_3.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_4.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_5.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_6.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_7.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_8.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_8.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_9.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_9_9.png" />
</div>
</div>
</div>
<div class="section" id="Especificación-del-modelo-usando-el-API-funcional">
<h2>Especificación del modelo usando el API funcional<a class="headerlink" href="#Especificación-del-modelo-usando-el-API-funcional" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">create_model</span><span class="p">():</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>

    <span class="c1">#</span>
    <span class="c1"># Esta capa reduce una dimension de la matriz de entrada.</span>
    <span class="c1"># El conjunto de entrada es una lista de matrices de 28x28.</span>
    <span class="c1"># Flatten genera una lista de vectores de dimensión 28x28</span>
    <span class="c1">#</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()(</span><span class="n">inputs</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Preprocesamiento de la entrada [0, 255] --&gt; [0, 1]</span>
    <span class="c1">#</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">Rescaling</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Esta es una capa que conecta todas las neuronas de la</span>
    <span class="c1"># capa anterior con todas las neuronas de la capa actual.</span>
    <span class="c1">#</span>
    <span class="c1"># Las funciones de activación disponibles son:</span>
    <span class="c1">#</span>
    <span class="c1">#  - relu (rectified linear unit):  relu(x) = max(0, x)</span>
    <span class="c1">#</span>
    <span class="c1">#  - elu (exponential linear unit): elu(x) = x if x &gt;= 0 else exp(x) - 1</span>
    <span class="c1">#</span>
    <span class="c1">#  - exponential: exp(x)</span>
    <span class="c1">#</span>
    <span class="c1">#  - gelu (gaussian error linear unit): gelu(x) = x * P(X &lt;= x)  con  P(X) ~ N(0,1)</span>
    <span class="c1">#</span>
    <span class="c1">#  - hard_sigmoid:  hard_sigmoid(x) = max(0, min(1, 0.2 * x + 0.5))</span>
    <span class="c1">#</span>
    <span class="c1">#  - linear: linear(x) = x</span>
    <span class="c1">#</span>
    <span class="c1">#  - selu (scaled exponential linear unit): selu(x) = scale * alpha *(exp(x) - 1)</span>
    <span class="c1">#</span>
    <span class="c1">#  - sigmoid: sigmoid(x) = 1 / [1 + exp(-x)]</span>
    <span class="c1">#</span>
    <span class="c1">#  - softmax: softmax(z) = exp(z_i) / sum_j (exp(z_j))</span>
    <span class="c1">#</span>
    <span class="c1">#  - softplus: softplus(x) = log(exp(x) + 1)</span>
    <span class="c1">#</span>
    <span class="c1">#  - softsign: softsign(x) = x / (abs(x) + 1)</span>
    <span class="c1">#</span>
    <span class="c1">#  - swish: swish(x) = x * sigmoid(x)</span>
    <span class="c1">#</span>
    <span class="c1">#  - tanh</span>
    <span class="c1">#</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
        <span class="mi">128</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">,</span>
    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Capa densa con un numero de neuronas igual a la cantidad</span>
    <span class="c1"># de clases en el dataset</span>
    <span class="c1">#</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
        <span class="mi">10</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">,</span>
    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Crea el modelo y lo retorna</span>
    <span class="c1">#</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
        <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span>
        <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>


<span class="c1">#</span>
<span class="c1"># Creación del modelo</span>
<span class="c1">#</span>
<span class="n">base_model</span> <span class="o">=</span> <span class="n">create_model</span><span class="p">()</span>

<span class="c1">#</span>
<span class="c1"># Resumen del modelo creado</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;model&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         [(None, 28, 28)]          0
_________________________________________________________________
flatten (Flatten)            (None, 784)               0
_________________________________________________________________
rescaling (Rescaling)        (None, 784)               0
_________________________________________________________________
dense (Dense)                (None, 128)               100480
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1290
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">base_model</span><span class="p">,</span> <span class="s2">&quot;base_model.png&quot;</span><span class="p">,</span> <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;You must install pydot (`pip install pydot`) and install graphviz (see instructions at https://graphviz.gitlab.io/download/) &#39;, &#39;for plot_model/model_to_dot to work.&#39;)
</pre></div></div>
</div>
</div>
<div class="section" id="Propagación-de-la-señal">
<h2>Propagación de la señal<a class="headerlink" href="#Propagación-de-la-señal" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La salida del modelo son probabilidades para</span>
<span class="c1"># cada una de las clases. Aunque el modelo no</span>
<span class="c1"># esta entrenado si tiene pesos aleatorios.</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.22021957, 0.10066025, 0.05933173, 0.09393696, 0.10508198,
        0.19082478, 0.12461631, 0.02792821, 0.04839974, 0.02900052]],
      dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La suma del vector de salida es ~ 1.0</span>
<span class="c1">#</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0000000465661287
</pre></div></div>
</div>
</div>
<div class="section" id="Construcción-del-modelo-usando-Sequential">
<h2>Construcción del modelo usando Sequential<a class="headerlink" href="#Construcción-del-modelo-usando-Sequential" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Resulta más práctico especificar el modelo</span>
<span class="c1"># como una secuencia de capas</span>
<span class="c1">#</span>
<span class="n">base_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">Rescaling</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># base_model.built()</span>

<span class="c1">#</span>
<span class="c1"># Características del modelo creado</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
flatten_1 (Flatten)          (None, 784)               0
_________________________________________________________________
rescaling_1 (Rescaling)      (None, 784)               0
_________________________________________________________________
dense_2 (Dense)              (None, 128)               100480
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1290
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La salida del modelo son probabilidades para</span>
<span class="c1"># cada una de las clases. Aunque el modelo no</span>
<span class="c1"># esta entrenado si tiene pesos aleatorios.</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.04740195, 0.11275452, 0.04420821, 0.07701786, 0.09865675,
        0.18166974, 0.00856028, 0.09411019, 0.10538605, 0.23023443]],
      dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">sum</span><span class="p">(</span><span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9999999813735485
</pre></div></div>
</div>
</div>
<div class="section" id="Función-de-costo-para-entrenamiento-del-modelo">
<h2>Función de costo para entrenamiento del modelo<a class="headerlink" href="#Función-de-costo-para-entrenamiento-del-modelo" title="Enlazar permanentemente con este título"></a></h2>
<p>En esta lección se usará la función de entropía cruzada. Esta es una medida del desempeño del clasificador que entrega probabilidad como salida. Esta medida incrementa cuando la probabilidad pronosticada diverge de la clase actual. En clasificación binaria <span class="math notranslate nohighlight">\(y \in \{0,1\}\)</span>, la entropía se calcula como:</p>
<div class="math notranslate nohighlight">
\[- y \cdot \log(p) - (1 - y) \log (1-p)\]</div>
<p>donde <span class="math notranslate nohighlight">\(p\)</span> es la probabilidad de que el pronóstico sea igual a <span class="math notranslate nohighlight">\(y\)</span></p>
<p>Si <span class="math notranslate nohighlight">\(y=1\)</span>, la función es <span class="math notranslate nohighlight">\(-\log(p)\)</span>; si <span class="math notranslate nohighlight">\(y=0\)</span>, la función es <span class="math notranslate nohighlight">\(-\log (1-p))\)</span>. La forma de curva de pérdida para cada caso es:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">plot_entropy</span><span class="p">():</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.9999</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Probabilidad pronosticada (p) con y=1&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$-\log(p)$&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Probabilidad pronosticada (p) con y=0&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$-\log(p)$&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plot_entropy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_23_0.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_23_0.png" />
</div>
</div>
<p>Para más de dos clases se generaliza a:</p>
<div class="math notranslate nohighlight">
\[- \sum d_c \cdot \log (p_c)\]</div>
<p>donde <span class="math notranslate nohighlight">\(d_c\)</span> indica que el punto pertenece a la clase <span class="math notranslate nohighlight">\(c\)</span> y <span class="math notranslate nohighlight">\(p_c\)</span> es su probabilidad de pertenencia (resultado del clasificador)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">loss_fn</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span>
    <span class="c1">#</span>
    <span class="c1"># Este parametro indica que las salidas son</span>
    <span class="c1"># probabilidades</span>
    <span class="c1">#</span>
    <span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Evaluación de la función de pérdida para la</span>
<span class="c1"># primera imagen del conjunto de prueba</span>
<span class="c1">#</span>
<span class="n">loss_fn</span><span class="p">(</span>
    <span class="n">train_labels</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span>
<span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.1743095
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Salida para el primer ejemplo de entrenamiento</span>
<span class="c1">#</span>
<span class="p">(</span>
    <span class="n">train_labels</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()),</span>
    <span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">())],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([9], dtype=uint8), 9, 0.23023443)
</pre></div></div>
</div>
</div>
<div class="section" id="Entrenamiento">
<h2>Entrenamiento<a class="headerlink" href="#Entrenamiento" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Compilación del modelo. En esta función se especifica:</span>
<span class="c1">#</span>
<span class="c1"># - El optimizador.</span>
<span class="c1"># - La función de pérdida.</span>
<span class="c1"># - Las metricas a monitorear.</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>

    <span class="c1">#</span>
    <span class="c1"># Especifica el algoritmo usado:</span>
    <span class="c1">#</span>
    <span class="c1">#   * &#39;adadelta&#39; : tf.keras.optimizers.Adadelta</span>
    <span class="c1">#   * &#39;adagrad&#39; : tf.keras.optimizers.Adagrad</span>
    <span class="c1">#   * &#39;adam&#39; : tf.keras.optimizers.Adam</span>
    <span class="c1">#   * &#39;adamax&#39; : tf.keras.optimizers.Adamax</span>
    <span class="c1">#   * &#39;ftrl&#39; : tf.keras.optimizers.Ftrl</span>
    <span class="c1">#   * &#39;nadam&#39; : tf.keras.optimizers.Nadam</span>
    <span class="c1">#   * &#39;rmsprop&#39; : tf.keras.optimizers.RMSprop</span>
    <span class="c1">#   * &#39;sgd&#39; : tf.keras.optimizers.SGD</span>
    <span class="c1">#</span>
    <span class="c1"># Puede usarse:</span>
    <span class="c1">#</span>
    <span class="c1">#   optimizer=&#39;adam&#39;</span>
    <span class="c1">#</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>

    <span class="c1">#</span>
    <span class="c1"># Función de costo</span>
    <span class="c1">#</span>
    <span class="c1">#   * tf.keras.losses.BinaryCrossentropy</span>
    <span class="c1">#   * tf.keras.losses.CategoricalCrossentropy</span>
    <span class="c1">#   * tf.keras.losses.CategoricalHinge</span>
    <span class="c1">#   * tf.keras.losses.CosineSimilarity</span>
    <span class="c1">#   * tf.keras.losses.Hinge</span>
    <span class="c1">#   * tf.keras.losses.Huber</span>
    <span class="c1">#   * tf.keras.losses.KLDivergence</span>
    <span class="c1">#   * tf.keras.losses.LogCosh</span>
    <span class="c1">#   * tf.keras.losses.MeanAbsoluteError</span>
    <span class="c1">#   * tf.keras.losses.MeanAbsolutePercentageError</span>
    <span class="c1">#   * tf.keras.losses.MeanSquaredError</span>
    <span class="c1">#   * tf.keras.losses.MeanSquaredLogarithmicError</span>
    <span class="c1">#   * tf.keras.losses.Poisson</span>
    <span class="c1">#   * tf.keras.losses.SparseCategoricalCrossentropy</span>
    <span class="c1">#   * tf.keras.losses.SquaredHinge</span>
    <span class="c1">#</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">,</span>

    <span class="c1">#</span>
    <span class="c1"># Define las metricas a monitorear</span>
    <span class="c1">#</span>
    <span class="c1">#   * &#39;accuracy&#39; : tf.keras.metrics.Accuracy</span>
    <span class="c1">#   * &#39;binary_accuracy&#39; : tf.keras.metrics.BinaryAccuracy</span>
    <span class="c1">#   * &#39;binary_crossentropy&#39; : tf.keras.metrics.BinaryCrossentropy</span>
    <span class="c1">#   * &#39;categorical_accuracy&#39; : tf.keras.metrics.CategoricalAccuracy</span>
    <span class="c1">#   * &#39;categorical_crossentropy&#39; : tf.keras.metrics.CategoricalCrossentropy</span>
    <span class="c1">#   * &#39;categorical_hinge&#39; : tf.keras.metrics.CategoricalHinge</span>
    <span class="c1">#   * &#39;cosine_similarity&#39; : tf.keras.metrics.CosineSimilarity</span>
    <span class="c1">#   * &#39;hinge&#39; : tf.keras.metrics.Hinge</span>
    <span class="c1">#   * &#39;kullback_leibler_divergence&#39; : tf.keras.metrics.KLDivergence</span>
    <span class="c1">#   * &#39;logcosh&#39; : tf.keras.metrics.LogCoshError</span>
    <span class="c1">#   * &#39;mean&#39; : tf.keras.metrics.Mean</span>
    <span class="c1">#   * &#39;mean_absolute_error&#39;: tf.keras.metrics.MeanAbsoluteError</span>
    <span class="c1">#   * &#39;mean_absolute_percentage_error&#39; : tf.keras.metrics.MeanAbsolutePercentageError</span>
    <span class="c1">#   * &#39;mean_squared_error&#39; : tf.keras.metrics.MeanSquaredError</span>
    <span class="c1">#   * &#39;mean_squared_logarithmic_error&#39; : tf.keras.metrics.MeanSquaredLogarithmicError</span>
    <span class="c1">#   * &#39;root_mean_squared_error&#39;: tf.keras.metrics.RootMeanSquaredError</span>
    <span class="c1">#   * &#39;squared_hinge&#39; : tf.keras.metrics.SquaredHinge</span>
    <span class="c1">#   ...</span>
    <span class="c1">#</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Entrenamiento del modelo</span>
<span class="c1">#</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>       <span class="c1"># Número de veces que se recorre el conjunto de entrenamiento</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>       <span class="c1"># 0 = silent, 1 = progress bar, 2 = one line per epoch</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>   <span class="c1"># Número de muestras para la actualización del gradiente</span>
<span class="p">)</span>

<span class="c1"># Note que 60.000 / 32 = 1875 batches</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.6746 - accuracy: 0.7957
Epoch 2/10
1875/1875 [==============================] - 3s 2ms/step - loss: 1.6205 - accuracy: 0.8435
Epoch 3/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.6087 - accuracy: 0.8544
Epoch 4/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.6033 - accuracy: 0.8587
Epoch 5/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5979 - accuracy: 0.8642
Epoch 6/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5927 - accuracy: 0.8691
Epoch 7/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5896 - accuracy: 0.8723
Epoch 8/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5852 - accuracy: 0.8763
Epoch 9/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5832 - accuracy: 0.8785
Epoch 10/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5802 - accuracy: 0.8815
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La componente history es un diccionario con la</span>
<span class="c1"># perdida para cada iteración y las metricas</span>
<span class="c1"># monitoreadas.</span>
<span class="c1">#</span>
<span class="n">history</span><span class="o">.</span><span class="n">history</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;loss&#39;: [1.674625039100647,
  1.6204687356948853,
  1.6086689233779907,
  1.6033360958099365,
  1.597866177558899,
  1.5926822423934937,
  1.589624047279358,
  1.5852152109146118,
  1.5831503868103027,
  1.5802371501922607],
 &#39;accuracy&#39;: [0.7957166433334351,
  0.8435333371162415,
  0.8544333577156067,
  0.8587333559989929,
  0.8641666769981384,
  0.8691499829292297,
  0.8723166584968567,
  0.8762833476066589,
  0.8785499930381775,
  0.8814666867256165]}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La componente epoch indica la iteración</span>
<span class="c1">#</span>
<span class="n">history</span><span class="o">.</span><span class="n">epoch</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</pre></div></div>
</div>
</div>
<div class="section" id="Uso-de-un-conjunto-de-validación-durante-el-entrenamiento">
<h2>Uso de un conjunto de validación durante el entrenamiento<a class="headerlink" href="#Uso-de-un-conjunto-de-validación-durante-el-entrenamiento" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">history</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">validation_split</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>

<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/10
1500/1500 [==============================] - 3s 2ms/step - loss: 1.5774 - accuracy: 0.8843 - val_loss: 1.5930 - val_accuracy: 0.8681
Epoch 2/10
1500/1500 [==============================] - 3s 2ms/step - loss: 1.5758 - accuracy: 0.8856 - val_loss: 1.5778 - val_accuracy: 0.8842
Epoch 3/10
1500/1500 [==============================] - 3s 2ms/step - loss: 1.5724 - accuracy: 0.8896 - val_loss: 1.5792 - val_accuracy: 0.8828
Epoch 4/10
1500/1500 [==============================] - 3s 2ms/step - loss: 1.5709 - accuracy: 0.8904 - val_loss: 1.5779 - val_accuracy: 0.8841
Epoch 5/10
1500/1500 [==============================] - 3s 2ms/step - loss: 1.5700 - accuracy: 0.8913 - val_loss: 1.5732 - val_accuracy: 0.8883
Epoch 6/10
1500/1500 [==============================] - 3s 2ms/step - loss: 1.5684 - accuracy: 0.8931 - val_loss: 1.5772 - val_accuracy: 0.8837
Epoch 7/10
1500/1500 [==============================] - 3s 2ms/step - loss: 1.5682 - accuracy: 0.8933 - val_loss: 1.5738 - val_accuracy: 0.8867
Epoch 8/10
1500/1500 [==============================] - 3s 2ms/step - loss: 1.5659 - accuracy: 0.8955 - val_loss: 1.5740 - val_accuracy: 0.8867
Epoch 9/10
1500/1500 [==============================] - 3s 2ms/step - loss: 1.5627 - accuracy: 0.8989 - val_loss: 1.5784 - val_accuracy: 0.8828
Epoch 10/10
1500/1500 [==============================] - 3s 2ms/step - loss: 1.5624 - accuracy: 0.8995 - val_loss: 1.5748 - val_accuracy: 0.8867
</pre></div></div>
</div>
</div>
<div class="section" id="Evaluación-y-pronóstico-para-nuevos-datos">
<h2>Evaluación y pronóstico para nuevos datos<a class="headerlink" href="#Evaluación-y-pronóstico-para-nuevos-datos" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Evaluación para el conjunto de entrenamiento</span>
<span class="c1">#</span>
<span class="n">train_loss</span><span class="p">,</span> <span class="n">train_acc</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">train_loss</span><span class="p">,</span> <span class="n">train_acc</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1875/1875 - 2s - loss: 1.5643 - accuracy: 0.8971
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1.5643036365509033, 0.8971499800682068)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Evaluación para el conjunto de prueba</span>
<span class="c1">#</span>
<span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span>  <span class="n">test_labels</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,)</span>

<span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
313/313 - 1s - loss: 1.5900 - accuracy: 0.8707
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1.5900427103042603, 0.8707000017166138)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Predicción para el conjunto de test</span>
<span class="c1">#</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_images</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1">#  Valores asignados a cada una de las clases</span>
<span class="c1">#  para el primer ejemplo</span>
<span class="c1">#</span>
<span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([1.4214594e-13, 4.3922870e-21, 1.2179734e-14, 3.7616126e-13,
       1.0380199e-13, 3.8927183e-07, 5.1836389e-13, 1.0148736e-06,
       2.2487627e-10, 9.9999857e-01], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Suma de los valores asignados a cada clase para el primer</span>
<span class="c1">#  ejemplo. Puede asimilarse a probabilidad.</span>
<span class="c1">#</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9999999738600334
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Label para el que se produce el valor más alto para el primer ejemplo</span>
<span class="c1">#</span>
<span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
9
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Graficos de predicciones</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">plot_prediction</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">):</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">48</span><span class="p">):</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">test_images</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">thisplot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="n">thisplot</span><span class="p">[</span><span class="n">test_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">class_names</span><span class="p">[</span><span class="n">test_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:2.0f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">class_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>


<span class="n">plot_prediction</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_39_0.png" src="../../_images/notebooks_tensorflow__ML_basics_1-01_Clasificacion_basica_de_imagenes_con_TensorFlow_2.4_39_0.png" />
</div>
</div>
</div>
<div class="section" id="Uso-del-modelo-entrenado">
<h2>Uso del modelo entrenado<a class="headerlink" href="#Uso-del-modelo-entrenado" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Imagen a ser pronosticada</span>
<span class="c1">#</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">test_images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">img</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># tamaño</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(28, 28)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Keras está optimizado para generar pronósticos</span>
<span class="c1"># sobre colecciones, por lo que debe crearse una</span>
<span class="c1"># colección de una sola figura</span>
<span class="c1">#</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">img</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 28, 28)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictions_single</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">predictions_single</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions_single</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1.4214729e-13 4.3922870e-21 1.2179827e-14 3.7616126e-13 1.0380278e-13
  3.8927368e-07 5.1836687e-13 1.0148775e-06 2.2487841e-10 9.9999857e-01]]

 9
</pre></div></div>
</div>
</div>
<div class="section" id="Guardar-y-restaurar-el-modelo-en-formato-SavedModel">
<h2>Guardar y restaurar el modelo en formato SavedModel<a class="headerlink" href="#Guardar-y-restaurar-el-modelo-en-formato-SavedModel" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># En este formato el modelo se debe salvar a</span>
<span class="c1"># una carpeta</span>
<span class="c1">#</span>
<span class="o">!</span>rm -rf /tmp/saved_model
<span class="o">!</span>mkdir -p /tmp/saved_model
<span class="n">base_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/saved_model/my_model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO:tensorflow:Assets written to: /tmp/saved_model/my_model/assets
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>ls /tmp/saved_model/my_model
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
assets  keras_metadata.pb  saved_model.pb  variables
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Carga el modelo a una nueva variable</span>
<span class="c1">#</span>
<span class="n">new_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;/tmp/saved_model/my_model&#39;</span><span class="p">)</span>
<span class="n">new_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
flatten_1 (Flatten)          (None, 784)               0
_________________________________________________________________
rescaling_1 (Rescaling)      (None, 784)               0
_________________________________________________________________
dense_2 (Dense)              (None, 128)               100480
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1290
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
</div>
<div class="section" id="Guardar-y-restarurar-del-modelo-en-formato-HDF5">
<h2>Guardar y restarurar del modelo en formato HDF5<a class="headerlink" href="#Guardar-y-restarurar-del-modelo-en-formato-HDF5" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># En este formato, todo el modelo queda guardado</span>
<span class="c1"># en un archivo</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/my_model.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;/tmp/my_model.h5&#39;</span><span class="p">)</span>
<span class="n">new_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
flatten_1 (Flatten)          (None, 784)               0
_________________________________________________________________
rescaling_1 (Rescaling)      (None, 784)               0
_________________________________________________________________
dense_2 (Dense)              (None, 128)               100480
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1290
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<p><strong>Ejercicio.—</strong> ¿Cómo varía la precisión del modelo con la cantidad de neuronas de la capa oculta?</p>
</div>
<div class="section" id="Notas">
<h2>Notas<a class="headerlink" href="#Notas" title="Enlazar permanentemente con este título"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">elu</span></code>: Exponential Linear Unit</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\text{elu}(x) =
\begin{cases}
x &amp; x \ge 0 \\
\exp(x) - 1 &amp; x \lt 0
\end{cases}\end{split}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">exponential</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\exp (x)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GELU</span></code>: Gaussian Error Linear Unit</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{GELU}(x) = x \cdot \text{P}(X \le x) \text{    con    } \text{P}(X) \sim \text{N}(0, 1)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hard_sigmoid</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\text{hard_sigmoid}(x) =
\begin{cases}
    0 &amp; x \lt -2.5 \\
    0.2 \cdot x + 0.5 &amp; -2.5 \le x \le 2.5 \\
    1 &amp; x \gt 2.5
\end{cases}\end{split}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{linear}(x) = x\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">relu</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{relu}(x) = \max(0, x)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">selu</span></code>: scaled exponential lineal</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{selu}(x) = \text{scale} \cdot \text{alpha} \cdot (\exp(x) - 1)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sigmoid</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{sigmoid}(x) = \frac{1}{1+\exp(-x)}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">softmax</span></code>: recibe un vector de valores <span class="math notranslate nohighlight">\(z_j\)</span> en el rango [0, 1]. Retorna un vector de igual tamaño con:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{\exp(z_j)}{\sum_i \exp(z_i)}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">softplus</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{softplus}(x) = \log(\exp(x) + 1)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">softsign</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{softsign}=\frac{x}{\text{abs}(x) + 1}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">swish</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{swish}=x \cdot \text{sigmoid}(x)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tanh</span></code>: tangente hiperbólica</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Nombre y dimensiones de salida de la capas</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">base_model</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>  <span class="n">layer</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
flatten_1 (None, 784)
rescaling_1 (None, 784)
dense_2 (None, 128)
dense_3 (None, 10)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Parametros entrenables</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">base_model</span><span class="o">.</span><span class="n">trainable_weights</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 0.02523642 -0.19320035 -0.13892779 ...  0.25482133  0.05806429
   0.26867586]
 [-0.03804168  0.02038164 -0.006284   ...  0.16254808  0.02753529
  -0.00986699]
 [-0.00757027  0.11309666 -0.02291138 ...  0.0274729  -0.04512969
  -0.21678929]
 ...
 [-0.04174613 -0.3455375  -0.23766771 ... -0.29078808 -0.02127831
   0.29991606]
 [ 0.03155699  0.03029648 -0.0568057  ... -0.23757298  0.04794163
   0.11482755]
 [-0.01396915  0.25640342 -0.2706748  ... -0.46710628  0.00098081
   0.10919512]]

[-0.01762484 -0.09084293  0.38769823 -0.02639416  0.0737404   0.46844688
 -0.18632577  0.07415511  0.4887477   0.08545718  0.34654474  0.0442532
  0.44876817  0.55909604 -0.36865106 -0.2169026   0.5235194  -0.80065525
  0.9781621   0.38284773 -0.7459351   0.41652602 -0.01858988  0.40701157
  0.21547161 -0.6506425  -0.20030208 -0.0124081   0.515583   -0.55029064
 -0.3598962   0.07482357 -0.14333369  0.32974452  0.1331769   0.09133935
  0.12111253  0.4700865  -0.03671464  0.2690117  -1.0903746  -0.29262102
  0.333757   -0.11134441 -0.35227618  0.63848174  0.46097302  0.7980116
 -0.01455518  0.37586945 -0.12810336  0.02658434  0.0425469   0.6124832
 -0.02629161  0.9508179   0.5654344   0.13803326  0.64499485 -0.4415237
  0.14493954  0.7487529   0.66833484 -0.66762066  0.00721187 -0.61438054
  0.12295862  0.4785883   0.07797128  0.31857854  0.25217545 -0.02118881
  0.62753224  1.1878873   0.00396755  0.3577776  -0.77582663  0.27690548
 -0.42516005  0.03658287  0.10457581 -0.34128135 -0.8151695   0.36338568
 -1.2056547   0.9100393  -1.0404911   0.51751447  0.39177442  0.13281615
 -0.7300501  -0.926014   -0.0161339   0.526762    0.43827692 -0.7225044
 -0.01474891 -1.2294499  -0.13910376 -0.08262425  0.69845515 -0.56574696
  0.678315   -0.1703031   0.463449    0.26923198  0.0138136  -0.32215518
  0.28355423 -0.02806884 -0.01385057  0.2636399  -0.03844718  0.18049406
 -0.4159972  -0.2767743  -0.40054536  0.09211113 -0.35374296 -0.10805225
 -0.10025197 -1.025308   -0.39277977  0.8646728  -0.02742814 -0.2984358
  0.04419117  0.47667024]

[[-0.08560503  0.05701101 -0.12201724 ...  0.04083689 -0.11437271
   0.02641986]
 [ 0.13335404 -0.2595834  -0.00533576 ... -0.26250756 -0.02563735
   0.22198287]
 [ 0.04082201 -0.6654178  -0.47209933 ... -1.0625321   0.42610997
   0.10680802]
 ...
 [-0.5848272  -1.3269665  -0.2586538  ... -0.1212085   0.4674903
   0.26302794]
 [ 0.20972542  0.7976841  -0.26795545 ... -0.07659299 -0.16065156
  -1.0443286 ]
 [-0.03142025  0.11342029  0.4014388  ... -0.819626   -0.5009497
  -0.63974005]]

[ 0.15286046 -0.5127938   0.4701876   0.36916298 -0.8535026   0.28795645
  0.5753921   0.43178794 -0.53161997 -0.8301559 ]

</pre></div></div>
</div>
</div>
<div class="section" id="layers.Flatten">
<h2>layers.Flatten<a class="headerlink" href="#layers.Flatten" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La capa Flatten reduce en una dimensión</span>
<span class="c1"># la matriz de entrada</span>
<span class="c1">#</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tf.Tensor(
[[[-0.26791513 -1.266201   -0.83630747 -0.10814322]
  [-0.084473   -2.0054448  -0.8222822  -0.86771226]
  [-0.509989    0.39117393 -0.75846374  0.6089144 ]]

 [[-1.6999341  -1.6094509  -0.97620654 -1.5503764 ]
  [ 0.8467756  -0.68558985  0.16485867 -2.8586705 ]
  [ 0.56159556 -0.8004292  -2.052016   -1.7236936 ]]], shape=(2, 3, 4), dtype=float32)

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;tf.Tensor: shape=(2, 12), dtype=float32, numpy=
array([[-0.26791513, -1.266201  , -0.83630747, -0.10814322, -0.084473  ,
        -2.0054448 , -0.8222822 , -0.86771226, -0.509989  ,  0.39117393,
        -0.75846374,  0.6089144 ],
       [-1.6999341 , -1.6094509 , -0.97620654, -1.5503764 ,  0.8467756 ,
        -0.68558985,  0.16485867, -2.8586705 ,  0.56159556, -0.8004292 ,
        -2.052016  , -1.7236936 ]], dtype=float32)&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Dimensiones de la salida de una capa Flatten</span>
<span class="c1">#</span>
<span class="n">demo_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">output_shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(None, 6)
</pre></div></div>
</div>
</div>
<div class="section" id="layers.Dense">
<h2>layers.Dense<a class="headerlink" href="#layers.Dense" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Dense: es una capa que conecta todas las entradas</span>
<span class="c1"># a todas las neuronas de la capa</span>
<span class="c1">#</span>
<span class="n">demo_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
    <span class="n">units</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># Si es None se usa Linear(x) = x</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,)),</span>
<span class="p">)</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">output_shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(None, 3)
</pre></div></div>
</div>
</div>
<div class="section" id="Ejemplo-de-propagación-de-una-señal">
<h2>Ejemplo de propagación de una señal<a class="headerlink" href="#Ejemplo-de-propagación-de-una-señal" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Propagación de la señal</span>
<span class="c1">#</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;tf.Tensor: shape=(4, 2), dtype=float32, numpy=
array([[-0.2796894 , -1.5260481 ],
       [ 0.037794  , -0.44561386],
       [ 0.22066343,  0.65695333],
       [ 0.95447856, -0.1292828 ]], dtype=float32)&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">demo_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential_2&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
dense_4 (Dense)              (None, 3)                 9
=================================================================
Total params: 9
Trainable params: 9
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Capa de entrada --&gt; capa salida</span>
<span class="c1">#</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.6940155 ,  0.16471303,  0.77589977],
       [-0.14429396, -1.0279266 , -0.25517637]], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Bias capa de salida</span>
<span class="c1">#</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0., 0., 0.], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">demo_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.02609074,  1.522597  ,  0.17240044],
       [ 0.09052901,  0.4642835 ,  0.14303449],
       [ 0.05834944, -0.6389536 ,  0.00357375],
       [ 0.6810776 ,  0.29010826,  0.77356964]], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Primer patron de entrada a la primera neurona oculta</span>
<span class="c1">#</span>
<span class="c1">#       x1 *         w1 +         x2 *        w2 + w0</span>
<span class="mf">0.34032142</span> <span class="o">*</span> <span class="mf">0.98092103</span> <span class="o">+</span> <span class="o">-</span><span class="mf">0.2889726</span> <span class="o">*</span> <span class="mf">0.3135172</span> <span class="o">+</span> <span class="mf">0.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.24323055740874255
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Primer patrón de entrada a la segunda neurona oculta</span>
<span class="c1">#</span>
<span class="c1">#       x1 *         w1 +         x2 *         w2 + w0</span>
<span class="mf">0.34032142</span> <span class="o">*</span> <span class="mf">0.86922000</span> <span class="o">+</span> <span class="o">-</span><span class="mf">0.2889726</span> <span class="o">*</span> <span class="mf">0.57068133</span> <span class="o">+</span> <span class="mf">0.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.130902916990842
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Nombre y dimensiones de salida de la capas</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">base_model</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>  <span class="n">layer</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
flatten_1 (None, 784)
rescaling_1 (None, 784)
dense_2 (None, 128)
dense_3 (None, 10)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Parametros entrenables</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">base_model</span><span class="o">.</span><span class="n">trainable_weights</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 0.02523642 -0.19320035 -0.13892779 ...  0.25482133  0.05806429
   0.26867586]
 [-0.03804168  0.02038164 -0.006284   ...  0.16254808  0.02753529
  -0.00986699]
 [-0.00757027  0.11309666 -0.02291138 ...  0.0274729  -0.04512969
  -0.21678929]
 ...
 [-0.04174613 -0.3455375  -0.23766771 ... -0.29078808 -0.02127831
   0.29991606]
 [ 0.03155699  0.03029648 -0.0568057  ... -0.23757298  0.04794163
   0.11482755]
 [-0.01396915  0.25640342 -0.2706748  ... -0.46710628  0.00098081
   0.10919512]]

[-0.01762484 -0.09084293  0.38769823 -0.02639416  0.0737404   0.46844688
 -0.18632577  0.07415511  0.4887477   0.08545718  0.34654474  0.0442532
  0.44876817  0.55909604 -0.36865106 -0.2169026   0.5235194  -0.80065525
  0.9781621   0.38284773 -0.7459351   0.41652602 -0.01858988  0.40701157
  0.21547161 -0.6506425  -0.20030208 -0.0124081   0.515583   -0.55029064
 -0.3598962   0.07482357 -0.14333369  0.32974452  0.1331769   0.09133935
  0.12111253  0.4700865  -0.03671464  0.2690117  -1.0903746  -0.29262102
  0.333757   -0.11134441 -0.35227618  0.63848174  0.46097302  0.7980116
 -0.01455518  0.37586945 -0.12810336  0.02658434  0.0425469   0.6124832
 -0.02629161  0.9508179   0.5654344   0.13803326  0.64499485 -0.4415237
  0.14493954  0.7487529   0.66833484 -0.66762066  0.00721187 -0.61438054
  0.12295862  0.4785883   0.07797128  0.31857854  0.25217545 -0.02118881
  0.62753224  1.1878873   0.00396755  0.3577776  -0.77582663  0.27690548
 -0.42516005  0.03658287  0.10457581 -0.34128135 -0.8151695   0.36338568
 -1.2056547   0.9100393  -1.0404911   0.51751447  0.39177442  0.13281615
 -0.7300501  -0.926014   -0.0161339   0.526762    0.43827692 -0.7225044
 -0.01474891 -1.2294499  -0.13910376 -0.08262425  0.69845515 -0.56574696
  0.678315   -0.1703031   0.463449    0.26923198  0.0138136  -0.32215518
  0.28355423 -0.02806884 -0.01385057  0.2636399  -0.03844718  0.18049406
 -0.4159972  -0.2767743  -0.40054536  0.09211113 -0.35374296 -0.10805225
 -0.10025197 -1.025308   -0.39277977  0.8646728  -0.02742814 -0.2984358
  0.04419117  0.47667024]

[[-0.08560503  0.05701101 -0.12201724 ...  0.04083689 -0.11437271
   0.02641986]
 [ 0.13335404 -0.2595834  -0.00533576 ... -0.26250756 -0.02563735
   0.22198287]
 [ 0.04082201 -0.6654178  -0.47209933 ... -1.0625321   0.42610997
   0.10680802]
 ...
 [-0.5848272  -1.3269665  -0.2586538  ... -0.1212085   0.4674903
   0.26302794]
 [ 0.20972542  0.7976841  -0.26795545 ... -0.07659299 -0.16065156
  -1.0443286 ]
 [-0.03142025  0.11342029  0.4014388  ... -0.819626   -0.5009497
  -0.63974005]]

[ 0.15286046 -0.5127938   0.4701876   0.36916298 -0.8535026   0.28795645
  0.5753921   0.43178794 -0.53161997 -0.8301559 ]

</pre></div></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2019-2021, Juan D. Velasquez.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>