

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Optimización usando ridge regression &mdash; documentación de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../../_static/clipboard.min.js"></script>
        <script type="text/javascript" src="../../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="Taller — Optimización usando LASSO" href="3-17-taller-lasso.html" />
    <link rel="prev" title="Optimización usando Early Stopping (parada temprana)" href="2-15_Optimizacion_usando_Early_Stopping_parada_temprana.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/course-info.html">Información del curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/programming-labs.html">Laboratorios de programación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/complement.html">Material Complementario</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/index.html">Analítica Predictiva</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/content.html">Sesiones</a> &raquo;</li>
        
      <li>Optimización usando ridge regression</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/notebooks/sklearn/fundamentals/3-16_Optimizacion_usando_ridge_regression.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Optimización-usando-ridge-regression">
<h1>Optimización usando ridge regression<a class="headerlink" href="#Optimización-usando-ridge-regression" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p>34:40 min | Ultima modificación: Marzo 30, 2021 | <a class="reference external" href="https://youtu.be/_G_MnnEGexw">YouTube</a></p></li>
</ul>
<p><strong>Preparación</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="section" id="Función-a-aproximar-usando-un-modelo-de-regresión">
<h2>Función a aproximar usando un modelo de regresión<a class="headerlink" href="#Función-a-aproximar-usando-un-modelo-de-regresión" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="math notranslate nohighlight">
\[\begin{split}f(\mathbf{x})=
\begin{cases}
    \exp \; (0.15 \cdot x + 1) + 0 \cdot y + 0 \cdot z &amp; \text{si } x \lt 5 \\ \\
    \exp\; (0.25 \cdot x + 1) + 0 \cdot y + 0 \cdot z &amp; \text{de lo contrario}
\end{cases}\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(\mathbf{x}=[x, y, z]'\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.15</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Generación-de-la-muestra-de-datos">
<h2>Generación de la muestra de datos<a class="headerlink" href="#Generación-de-la-muestra-de-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Semilla del generador de aleatorios</span>
<span class="c1">#</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Datos para entrenamiento del modelo</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">create_data</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>


<span class="n">X_data</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">X_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.        ,  0.19151945,  0.36488598],
       [ 0.52631579,  0.62210877,  0.61539618],
       [ 1.05263158,  0.43772774,  0.07538124],
       [ 1.57894737,  0.78535858,  0.36882401],
       [ 2.10526316,  0.77997581,  0.9331401 ],
       [ 2.63157895,  0.27259261,  0.65137814],
       [ 3.15789474,  0.27646426,  0.39720258],
       [ 3.68421053,  0.80187218,  0.78873014],
       [ 4.21052632,  0.95813935,  0.31683612],
       [ 4.73684211,  0.87593263,  0.56809865],
       [ 5.26315789,  0.35781727,  0.86912739],
       [ 5.78947368,  0.50099513,  0.43617342],
       [ 6.31578947,  0.68346294,  0.80214764],
       [ 6.84210526,  0.71270203,  0.14376682],
       [ 7.36842105,  0.37025075,  0.70426097],
       [ 7.89473684,  0.56119619,  0.70458131],
       [ 8.42105263,  0.50308317,  0.21879211],
       [ 8.94736842,  0.01376845,  0.92486763],
       [ 9.47368421,  0.77282662,  0.44214076],
       [10.        ,  0.88264119,  0.90931596]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_data</span><span class="p">)</span>
<span class="n">d_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 2.71828183,  2.94158152,  3.18322469,  3.44471821,  3.72769274,
        4.03391288,  4.36528819,  4.72388512,  5.11193983,  5.53187222,
       10.13291944, 11.55789116, 13.18325374, 15.03718774, 17.15183668,
       19.56386438, 22.31509059, 25.45321612, 29.03264982, 33.11545196])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X_real</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">X_real</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.00000000e+00, 5.98092228e-02, 9.34857450e-03],
       [1.01010101e-01, 1.84287084e-01, 9.00648621e-01],
       [2.02020202e-01, 4.73552788e-02, 9.77241431e-01],
       [3.03030303e-01, 6.74880944e-01, 5.56894679e-01],
       [4.04040404e-01, 5.94624780e-01, 8.47738434e-02],
       [5.05050505e-01, 5.33310163e-01, 3.33002466e-01],
       [6.06060606e-01, 4.33240627e-02, 7.28428676e-01],
       [7.07070707e-01, 5.61433080e-01, 1.42435373e-01],
       [8.08080808e-01, 3.29668446e-01, 5.52468939e-01],
       [9.09090909e-01, 5.02966833e-01, 2.73043260e-01],
       [1.01010101e+00, 1.11894318e-01, 9.74495138e-01],
       [1.11111111e+00, 6.07193706e-01, 6.67786906e-01],
       [1.21212121e+00, 5.65944643e-01, 2.55653286e-01],
       [1.31313131e+00, 6.76406199e-03, 1.08311494e-01],
       [1.41414141e+00, 6.17441709e-01, 7.76180723e-01],
       [1.51515152e+00, 9.12122886e-01, 7.82477993e-01],
       [1.61616162e+00, 7.90524133e-01, 7.61603914e-01],
       [1.71717172e+00, 9.92081466e-01, 9.14403113e-01],
       [1.81818182e+00, 9.58801762e-01, 6.58622782e-01],
       [1.91919192e+00, 7.91964135e-01, 5.68367582e-01],
       [2.02020202e+00, 2.85250960e-01, 2.01755692e-01],
       [2.12121212e+00, 6.24916705e-01, 6.98296376e-01],
       [2.22222222e+00, 4.78093796e-01, 9.52195410e-01],
       [2.32323232e+00, 1.95675179e-01, 8.89963287e-01],
       [2.42424242e+00, 3.82317452e-01, 9.93567363e-01],
       [2.52525253e+00, 5.38736851e-02, 8.18703510e-01],
       [2.62626263e+00, 4.51648408e-01, 5.45122166e-01],
       [2.72727273e+00, 9.82004742e-01, 4.51254055e-01],
       [2.82828283e+00, 1.23942700e-01, 8.90557188e-01],
       [2.92929293e+00, 1.19380898e-01, 9.73264791e-01],
       [3.03030303e+00, 7.38523056e-01, 5.93411330e-01],
       [3.13131313e+00, 5.87303633e-01, 3.66074498e-01],
       [3.23232323e+00, 4.71632534e-01, 3.23094693e-01],
       [3.33333333e+00, 1.07126817e-01, 8.71423255e-01],
       [3.43434343e+00, 2.29218565e-01, 2.15634063e-01],
       [3.53535354e+00, 8.99965195e-01, 7.34945189e-01],
       [3.63636364e+00, 4.16753538e-01, 3.65619087e-01],
       [3.73737374e+00, 5.35851663e-01, 8.01602599e-01],
       [3.83838384e+00, 6.20851659e-03, 7.82735592e-01],
       [3.93939394e+00, 3.00641706e-01, 7.01355379e-01],
       [4.04040404e+00, 4.36893172e-01, 6.22776587e-01],
       [4.14141414e+00, 6.12148997e-01, 4.93682646e-01],
       [4.24242424e+00, 9.18198075e-01, 8.40537700e-01],
       [4.34343434e+00, 6.25736670e-01, 7.12096987e-01],
       [4.44444444e+00, 7.05997565e-01, 4.43908981e-01],
       [4.54545455e+00, 1.49833716e-01, 3.10348611e-02],
       [4.64646465e+00, 7.46063409e-01, 3.63239760e-01],
       [4.74747475e+00, 8.31006992e-01, 7.30721791e-01],
       [4.84848485e+00, 6.33725769e-01, 4.75566573e-01],
       [4.94949495e+00, 4.38309881e-01, 3.44416970e-01],
       [5.05050505e+00, 1.52572775e-01, 6.40880435e-01],
       [5.15151515e+00, 5.68409615e-01, 1.26205322e-01],
       [5.25252525e+00, 5.28224278e-01, 1.71465261e-01],
       [5.35353535e+00, 9.51428764e-01, 7.37086494e-01],
       [5.45454545e+00, 4.80359179e-01, 1.27029394e-01],
       [5.55555556e+00, 5.02559563e-01, 3.69649875e-01],
       [5.65656566e+00, 5.36878193e-01, 6.04334005e-01],
       [5.75757576e+00, 8.19202067e-01, 1.03104439e-01],
       [5.85858586e+00, 5.71156381e-02, 8.02374182e-01],
       [5.95959596e+00, 6.69421743e-01, 9.45553236e-01],
       [6.06060606e+00, 7.67116628e-01, 9.79038820e-01],
       [6.16161616e+00, 7.08115362e-01, 8.81232246e-01],
       [6.26262626e+00, 7.96867184e-01, 6.27681921e-01],
       [6.36363636e+00, 5.57760828e-01, 9.30486533e-01],
       [6.46464646e+00, 9.65836532e-01, 7.24789953e-01],
       [6.56565657e+00, 1.47156900e-01, 7.16677886e-01],
       [6.66666667e+00, 2.96470005e-02, 4.10785666e-02],
       [6.76767677e+00, 5.93893493e-01, 4.39481775e-01],
       [6.86868687e+00, 1.14065699e-01, 2.82069783e-01],
       [6.96969697e+00, 9.50809850e-01, 3.34995969e-01],
       [7.07070707e+00, 3.25707414e-01, 8.35270070e-02],
       [7.17171717e+00, 1.93618690e-01, 7.60849147e-01],
       [7.27272727e+00, 4.57811649e-01, 5.09272447e-01],
       [7.37373737e+00, 9.20402571e-01, 6.61047418e-01],
       [7.47474747e+00, 8.79069162e-01, 6.30314442e-01],
       [7.57575758e+00, 2.52615755e-01, 3.70926827e-01],
       [7.67676768e+00, 3.48008793e-01, 4.46740152e-01],
       [7.77777778e+00, 1.82588732e-01, 4.15108220e-01],
       [7.87878788e+00, 9.01796051e-01, 4.80388508e-01],
       [7.97979798e+00, 7.06528163e-01, 9.83323573e-01],
       [8.08080808e+00, 7.26658462e-01, 3.73423707e-01],
       [8.18181818e+00, 9.00087837e-01, 1.24069817e-02],
       [8.28282828e+00, 7.79163801e-01, 9.21903338e-01],
       [8.38383838e+00, 5.99154781e-01, 8.73276070e-01],
       [8.48484848e+00, 2.91125245e-01, 3.51746822e-01],
       [8.58585859e+00, 1.51395264e-01, 6.30133113e-01],
       [8.68686869e+00, 3.35174659e-01, 3.57826959e-01],
       [8.78787879e+00, 6.57551777e-01, 2.12819938e-01],
       [8.88888889e+00, 7.33425436e-02, 2.23319223e-01],
       [8.98989899e+00, 5.50063954e-02, 4.19563792e-01],
       [9.09090909e+00, 3.23194814e-01, 7.29102211e-02],
       [9.19191919e+00, 5.90481804e-01, 6.50839070e-01],
       [9.29292929e+00, 8.53898567e-01, 7.55686149e-01],
       [9.39393939e+00, 2.87062425e-01, 9.32101226e-01],
       [9.49494949e+00, 1.73067227e-01, 3.76404160e-01],
       [9.59595960e+00, 1.34021206e-01, 2.96927283e-01],
       [9.69696970e+00, 9.94653829e-01, 3.71944312e-01],
       [9.79797980e+00, 1.79497869e-01, 8.27699359e-01],
       [9.89898990e+00, 3.17546823e-01, 9.01139535e-01],
       [1.00000000e+01, 5.68291405e-01, 4.27303785e-01]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_real</span><span class="p">)</span>
<span class="n">d_real</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 2.71828183,  2.75978151,  2.80191477,  2.84469127,  2.88812084,
        2.93221343,  2.97697919,  3.02242838,  3.06857143,  3.11541895,
        3.16298168,  3.21127054,  3.26029663,  3.31007119,  3.36060565,
        3.41191162,  3.46400087,  3.51688536,  3.57057723,  3.62508881,
        3.68043261,  3.73662134,  3.79366789,  3.85158537,  3.91038707,
        3.97008648,  4.03069732,  4.0922335 ,  4.15470914,  4.21813859,
        4.28253642,  4.34791739,  4.41429653,  4.48168907,  4.55011049,
        4.61957648,  4.69010301,  4.76170625,  4.83440266,  4.90820891,
        4.98314195,  5.05921899,  5.13645748,  5.21487517,  5.29449005,
        5.3753204 ,  5.45738478,  5.54070203,  5.62529127,  5.71117192,
        9.60828995,  9.85401304, 10.10602028, 10.36447236, 10.62953411,
       10.90137457, 11.1801671 , 11.46608949, 11.75932408, 12.06005787,
       12.36848265, 12.68479511, 13.00919696, 13.34189509, 13.68310166,
       14.03303428, 14.3919161 , 14.75997598, 15.13744866, 15.52457485,
       15.92160143, 16.3287816 , 16.74637502, 17.17464801, 17.61387368,
       18.06433214, 18.52631065, 19.00010384, 19.48601385, 19.98435055,
       20.49543176, 21.01958339, 21.55713971, 22.10844353, 22.67384644,
       23.25370901, 23.84840102, 24.45830172, 25.08380007, 25.72529496,
       26.38319548, 27.0579212 , 27.7499024 , 28.45958038, 29.18740772,
       29.93384856, 30.69937893, 31.48448704, 32.28967355, 33.11545196])
</pre></div></div>
</div>
</div>
<div class="section" id="Gráfica-de-la-función">
<h2>Gráfica de la función<a class="headerlink" href="#Gráfica-de-la-función" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_real</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_real</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_data</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_13_0.png" src="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_13_0.png" />
</div>
</div>
</div>
<div class="section" id="Partición-del-conjunto-de-datos">
<h2>Partición del conjunto de datos<a class="headerlink" href="#Partición-del-conjunto-de-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># selecciona aleatoriamente 15 elementos del conjunto de datos</span>
<span class="n">index_fit</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_data</span><span class="p">),</span> <span class="mi">15</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">index_fit</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0, 2, 3, 6, 7, 8, 10, 11, 13, 14, 15, 16, 17, 18, 19]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">index_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_data</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index_fit</span><span class="p">]</span>
<span class="n">index_test</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1, 4, 5, 9, 12]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># muestra usada para estimar los parámetros del modelo</span>
<span class="n">X_fit</span> <span class="o">=</span> <span class="n">X_data</span><span class="p">[</span><span class="n">index_fit</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">d_fit</span> <span class="o">=</span> <span class="n">d_data</span><span class="p">[</span><span class="n">index_fit</span><span class="p">]</span>

<span class="c1"># muestra usada para evaluar la generalización</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_data</span><span class="p">[</span><span class="n">index_test</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">d_test</span> <span class="o">=</span> <span class="n">d_data</span><span class="p">[</span><span class="n">index_test</span><span class="p">]</span>

<span class="c1"># grafica</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_real</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_real</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_data</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_test</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_17_0.png" src="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_17_0.png" />
</div>
</div>
</div>
<div class="section" id="Modelo-de-regresión">
<h2>Modelo de regresión<a class="headerlink" href="#Modelo-de-regresión" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="math notranslate nohighlight">
\[g(\mathbf{x}) = \exp(w_0 + w_1 x + w_2 y + w_3 z)\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">#</span>
<span class="c1"># g_(w) crea una función g_aux(x) que usa el parametro w</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">g_</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">g_aux</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">g</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">g_aux</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Ejemplo:</span>
<span class="c1">#</span>
<span class="c1">#  m(x) = exp(0.1 + 0.2 * x_0 + 0.2 * x_1 + 0.3 * x_2)</span>
<span class="c1">#</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">g_</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;function __main__.g_.&lt;locals&gt;.g_aux(x)&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># m([1, 2, 3]) = exp(0.1 + 0.2 * 1 + 0.3 * 2 + 0.4 * 3)</span>
<span class="c1">#</span>
<span class="n">m</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
8.166169912567652
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
8.166169912567652
</pre></div></div>
</div>
</div>
<div class="section" id="Función-de-pérdida-cuadrática-(suma-de-errores-al-cuadrado)">
<h2>Función de pérdida cuadrática (suma de errores al cuadrado)<a class="headerlink" href="#Función-de-pérdida-cuadrática-(suma-de-errores-al-cuadrado)" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="math notranslate nohighlight">
\[\text{SSE}(\mathbf{w}) = \sum_p [d_p - g(\mathbf{x}_p)]^2\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">SSE</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">g_</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_data</span><span class="p">)</span>

    <span class="n">y_fit</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">index_fit</span><span class="p">]</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">index_test</span><span class="p">]</span>

    <span class="n">sse_fit</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">d_fit</span> <span class="o">-</span> <span class="n">y_fit</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">sse_test</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">d_test</span> <span class="o">-</span> <span class="n">y_test</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sse_fit</span><span class="p">,</span> <span class="n">sse_test</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Gradiente-del-modelo-de-regresión">
<h2>Gradiente del modelo de regresión<a class="headerlink" href="#Gradiente-del-modelo-de-regresión" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Si</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{x}
= \left[
        \begin{matrix}
          x \\
          y \\
          z \\
        \end{matrix}
      \right]\end{split}\]</div>
<p>Entonces:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
\frac{\partial}{\partial \mathbf{w}} g(\mathbf{x})
&amp; = \frac{\partial}{\partial \mathbf{w}}
      \left[ \exp( w_0 + w_1 \cdot x + w_2 \cdot y + w_3 \cdot z ) \right] \\ \\
&amp; = \left[
        \begin{matrix}
          g(\mathbf{x}) \\
          x \cdot g(\mathbf{x}) \\
          y \cdot g(\mathbf{x}) \\
          z \cdot g(\mathbf{x}) \\
        \end{matrix}
      \right]
\end{split}\end{split}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">gg</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>

    <span class="n">gx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">g_</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_data</span><span class="p">)</span>

    <span class="n">grd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">grd</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">gx</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">grd</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_data</span><span class="p">[:,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">gx</span>

    <span class="k">return</span> <span class="n">grd</span><span class="p">[</span><span class="n">index_fit</span><span class="p">,</span> <span class="p">:]</span>


<span class="n">gg</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 1.15924587,  0.        ,  0.22201813,  0.42299257],
       [ 1.24038657,  1.30567007,  0.54295161,  0.09350188],
       [ 1.53052935,  2.41662529,  1.20201436,  0.56449597],
       [ 1.63271308,  5.15593605,  0.45138681,  0.64851784],
       [ 2.14988538,  7.92063036,  1.72393327,  1.69567941],
       [ 2.02938205,  8.54476654,  1.94443081,  0.64298154],
       [ 2.35989579, 12.42050415,  0.84441147,  2.05105007],
       [ 2.24790444, 13.01418358,  1.12618917,  0.98047617],
       [ 2.38662678, 16.32955164,  1.70095374,  0.34311775],
       [ 2.77922065, 20.47846797,  1.02900854,  1.95729664],
       [ 3.04374089, 24.02953332,  1.70813578,  2.14456294],
       [ 2.74110063, 23.08295264,  1.37900158,  0.59973118],
       [ 3.2379837 , 28.97143309,  0.04458202,  2.9947063 ],
       [ 3.43692086, 32.56030289,  2.65614394,  1.51960279],
       [ 4.26022947, 42.60229473,  3.76025401,  3.87389465]])
</pre></div></div>
</div>
</div>
<div class="section" id="Gradiente-de-la-función-de-pérdida">
<h2>Gradiente de la función de pérdida<a class="headerlink" href="#Gradiente-de-la-función-de-pérdida" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
\text{SSE}(\mathbf{w}) &amp; = \sum_p [d_p - g(\mathbf{x}_p)]^2 \\ \\
\frac{\partial}{\partial \mathbf{w}}\text{SSE}(\mathbf{w})
  &amp; = \frac{\partial}{\partial \mathbf{w}} \sum_p [d_p - g(\mathbf{x}_p)]^2
  \\ \\
  &amp; = \sum_p \frac{\partial}{\partial \mathbf{w}} [d_p - g(\mathbf{x}_p)]^2
  \\ \\
  &amp; = \sum_p 2 \cdot [d_p - g(\mathbf{x}_p)] \frac{\partial}{\partial \mathbf{w}} [d_p - g(\mathbf{x}_p)]
  \\ \\
  &amp; = \sum_p -2 \cdot [d_p - g(\mathbf{x}_p)] \frac{\partial}{\partial \mathbf{w}} g(\mathbf{x}_p)
  \\ \\
  &amp; = \sum_p -2 \cdot e_p \frac{\partial}{\partial \mathbf{w}} g(\mathbf{x}_p)
\end{split}\end{split}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">gSSE</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>

    <span class="n">gx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">g_</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_data</span><span class="p">)</span>

    <span class="n">y_fit</span> <span class="o">=</span> <span class="n">gx</span><span class="p">[</span><span class="n">index_fit</span><span class="p">]</span>
    <span class="n">d_fit</span> <span class="o">=</span> <span class="n">d_data</span><span class="p">[</span><span class="n">index_fit</span><span class="p">]</span>
    <span class="n">e_fit</span> <span class="o">=</span> <span class="n">d_fit</span> <span class="o">-</span> <span class="n">y_fit</span>
    <span class="n">e_fit</span> <span class="o">=</span> <span class="n">e_fit</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">index_fit</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">grd</span> <span class="o">=</span> <span class="n">gg</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">grd</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">e_fit</span> <span class="o">*</span> <span class="n">grd</span>
    <span class="n">grd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">grd</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">grd</span>


<span class="n">gSSE</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ -383.81489155, -3007.27954981,  -214.18328195,  -230.32518   ])
</pre></div></div>
</div>
</div>
<div class="section" id="Corrección-de-los-parámetros">
<h2>Corrección de los parámetros<a class="headerlink" href="#Corrección-de-los-parámetros" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="math notranslate nohighlight">
\[\mathbf{w}_k = \mathbf{w}_{k-1} - \mu \frac{\partial}{\partial \mathbf{w}} \text{SSE}(\mathbf{w}_{k-1})\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">mejora</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="n">grd</span> <span class="o">=</span> <span class="n">gSSE</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">grd</span>
    <span class="k">return</span> <span class="n">w</span>


<span class="n">mejora</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.03838149, 0.30072795, 0.02141833, 0.02303252])
</pre></div></div>
</div>
</div>
<div class="section" id="Proceso-iterativo-usando-gradiente-descendente">
<h2>Proceso iterativo usando gradiente descendente<a class="headerlink" href="#Proceso-iterativo-usando-gradiente-descendente" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>  <span class="c1"># coeficientes iniciales</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.00000005</span>

<span class="n">sse_fit</span><span class="p">,</span> <span class="n">sse_test</span> <span class="o">=</span> <span class="n">SSE</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="n">history_sse_fit</span> <span class="o">=</span> <span class="p">[</span><span class="n">sse_fit</span><span class="p">]</span>
<span class="n">history_sse_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">sse_test</span><span class="p">]</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">mejora</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
    <span class="n">sse_fit</span><span class="p">,</span> <span class="n">sse_test</span> <span class="o">=</span> <span class="n">SSE</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">history_sse_fit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sse_fit</span><span class="p">)</span>
    <span class="n">history_sse_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sse_test</span><span class="p">)</span>

<span class="n">y_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">g_</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_real</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history_sse_fit</span><span class="p">,</span> <span class="s2">&quot;--k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history_sse_test</span><span class="p">,</span> <span class="s2">&quot;--r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_37_0.png" src="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_37_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_real</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_real</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_data</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_test</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_real</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y_real</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SSE fit = </span><span class="si">{}</span><span class="s1">, SSE test = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">SSE</span><span class="p">(</span><span class="n">w</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">SSE</span><span class="p">(</span><span class="n">w</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_38_0.png" src="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_38_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">w</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.99490325, 0.23629751, 0.09373265, 0.09584495])
</pre></div></div>
</div>
</div>
<div class="section" id="Ridge-regression">
<h2>Ridge regression<a class="headerlink" href="#Ridge-regression" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="Función-de-pérdida-penalizada">
<h3>Función de pérdida penalizada<a class="headerlink" href="#Función-de-pérdida-penalizada" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="math notranslate nohighlight">
\[\text{P}(w) = \sum_p [d_p - g(\mathbf{x}_p)]^2 + \lambda \sum_m w_m^2\]</div>
</div>
<div class="section" id="id1">
<h3>Gradiente de la función de pérdida<a class="headerlink" href="#id1" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
 \frac{\partial}{\partial w}\text{P}(w)
   &amp; = \sum_p -2 \cdot e_p \frac{\partial}{\partial \mathbf{w}} g(\mathbf{x}_p) + \sum_m 2 \lambda w_m
\end{split}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">gPen</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">w</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">mejora_ridge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">lamb</span><span class="p">):</span>
    <span class="n">grd_SSE</span> <span class="o">=</span> <span class="n">gSSE</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">grd_pen</span> <span class="o">=</span> <span class="n">gPen</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="p">(</span><span class="n">grd_SSE</span> <span class="o">+</span> <span class="n">lamb</span> <span class="o">*</span> <span class="n">grd_pen</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>  <span class="c1"># coeficientes iniciales</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.00000001</span>
<span class="n">lamb</span> <span class="o">=</span> <span class="mi">2500</span>

<span class="n">sse_fit</span><span class="p">,</span> <span class="n">sse_test</span> <span class="o">=</span> <span class="n">SSE</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="n">history_sse_fit</span> <span class="o">=</span> <span class="p">[</span><span class="n">sse_fit</span><span class="p">]</span>
<span class="n">history_sse_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">sse_test</span><span class="p">]</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">mejora_ridge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">lamb</span><span class="p">)</span>
    <span class="n">sse_fit</span><span class="p">,</span> <span class="n">sse_test</span> <span class="o">=</span> <span class="n">SSE</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">history_sse_fit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sse_fit</span><span class="p">)</span>
    <span class="n">history_sse_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sse_test</span><span class="p">)</span>

<span class="n">y_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">g_</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_real</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history_sse_fit</span><span class="p">,</span> <span class="s2">&quot;--k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history_sse_test</span><span class="p">,</span> <span class="s2">&quot;--r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_47_0.png" src="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_47_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_real</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_real</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_data</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d_test</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_real</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y_real</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SSE fit = </span><span class="si">{}</span><span class="s1">, SSE test = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">SSE</span><span class="p">(</span><span class="n">w</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">SSE</span><span class="p">(</span><span class="n">w</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_48_0.png" src="../../../_images/notebooks_sklearn_fundamentals_3-16_Optimizacion_usando_ridge_regression_48_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">w</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.95071139, 0.23861271, 0.09416578, 0.09459402])
</pre></div></div>
</div>
<p><strong>Ejercicio.—</strong> Cómpute el valor óptimo de la penalización.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>