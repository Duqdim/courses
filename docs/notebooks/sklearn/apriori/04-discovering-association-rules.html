

<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Descubrimiento de reglas de asociación en tags de proyectos de software &mdash; documentación de --- Cursos --- - </title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../../_static/clipboard.min.js"></script>
        <script type="text/javascript" src="../../../_static/copybutton.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="Introducción a la clasificación de texto usando Naive Bayes" href="../bayes/01-clasificacion-de-texto-usando-bayes.html" />
    <link rel="prev" title="Apriori en Python" href="03-apyori.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Pregrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Posgrado</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-texto/index.html">Analítica de Texto</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../analitica-predictiva/index.html">Analítica Predictiva</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../analitica-predictiva/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../analitica-predictiva/course-info.html">Información del curso</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ciencia-de-los-datos/index.html">Ciencia de los Datos Aplicada</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../productos-de-datos/index.html">Productos de Datos</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/index.html">Analítica Predictiva</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/content.html">Sesiones</a> &raquo;</li>
        
      <li>Descubrimiento de reglas de asociación en tags de proyectos de software</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/notebooks/sklearn/apriori/04-discovering-association-rules.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Descubrimiento-de-reglas-de-asociación-en-tags-de-proyectos-de-software">
<h1>Descubrimiento de reglas de asociación en tags de proyectos de software<a class="headerlink" href="#Descubrimiento-de-reglas-de-asociación-en-tags-de-proyectos-de-software" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p><em>60 min</em> | Ultima modificación: Noviembre 26, 2020</p></li>
</ul>
<p>Este tutorial esta basado en <em>Mastering Data Mining with Python, Megan Squire, 2016. Packt Publishing</em>.</p>
<p>El archivo <code class="docutils literal notranslate"><span class="pre">project_tags.csv</span></code> contiene los tags asociados a diferentes proyectos de software por los desarrolladdores. La primera columna corresponde al ID del proyecto; la segunda al tag asignado. Se desean construir reglas que permiten sugerir un tag a partir de dos tags previamente seleccionados por el usuario.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sqlite3</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>wget https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/project_tags.csv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
--2020-11-29 04:47:25--  https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/project_tags.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 199.232.48.133
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|199.232.48.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5418355 (5.2M) [text/plain]
Saving to: ‘project_tags.csv.1’

project_tags.csv.1  100%[===================&gt;]   5.17M  4.52MB/s    in 1.1s

2020-11-29 04:47:27 (4.52 MB/s) - ‘project_tags.csv.1’ saved [5418355/5418355]

</pre></div></div>
</div>
<div class="section" id="Carga-de-los-datos">
<h2>Carga de los datos<a class="headerlink" href="#Carga-de-los-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">conn</span><span class="o">.</span><span class="n">executescript</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">DROP TABLE IF EXISTS project_tags;</span>

<span class="s2">CREATE TABLE project_tags</span>
<span class="s2">(</span>
<span class="s2">    project_id     INT NOT NULL DEFAULT &#39;0&#39;,</span>
<span class="s2">    tag_name    STRING NOT NULL DEFAULT &#39;0&#39;,</span>
<span class="s2">    PRIMARY KEY (project_id, tag_name)</span>
<span class="s2">);</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;project_tags.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="c1">## Elimina el &#39;\n&#39; al final de la línea</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

<span class="c1">## Separa los campos por comas</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

<span class="c1">## Convierte la fila en una tupla</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

<span class="c1">## Elimina valores duplicados</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">tuple</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]))</span>


<span class="c1">## Imprime los primeros 5 registros para verificar</span>
<span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;36762&#39;, &#39;Database Engines/Servers&#39;),
 (&#39;14882&#39;, &#39;Systems Administration&#39;),
 (&#39;53184&#39;, &#39;C&#39;),
 (&#39;41895&#39;, &#39;multimedia&#39;),
 (&#39;53266&#39;, &#39;Desktop Environment&#39;)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Carga a partir de la lista de tuplas</span>
<span class="c1">## contenidas en data</span>
<span class="c1">##</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="s1">&#39;INSERT INTO project_tags VALUES (?,?)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Verificación</span>
<span class="c1">##</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM project_tags LIMIT 5;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(36762, &#39;Database Engines/Servers&#39;),
 (14882, &#39;Systems Administration&#39;),
 (53184, &#39;C&#39;),
 (41895, &#39;multimedia&#39;),
 (53266, &#39;Desktop Environment&#39;)]
</pre></div></div>
</div>
</div>
<div class="section" id="Información-básica">
<h2>Información básica<a class="headerlink" href="#Información-básica" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Cantidad de registros</span>
<span class="c1">##</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM project_tags;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(353401,)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Cantidad de proyectos</span>
<span class="c1">##</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(DISTINCT project_id) FROM project_tags;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(46511,)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Cantidad de proyectos</span>
<span class="c1">## Se toma como baskets la cantidad de proyectos en la tabla</span>
<span class="c1">##</span>
<span class="n">baskets</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(DISTINCT project_id) FROM project_tags;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">baskets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
46511
</pre></div></div>
</div>
</div>
<div class="section" id="Número-de-proyectos-por-tag-y-soporte">
<h2>Número de proyectos por tag y soporte<a class="headerlink" href="#Número-de-proyectos-por-tag-y-soporte" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Número de proyectos por tag</span>
<span class="c1">##</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SELECT</span>
<span class="sd">        tag_name,</span>
<span class="sd">        COUNT(project_id),</span>
<span class="sd">        ROUND(</span>
<span class="sd">            COUNT(project_id) * 100.0 / (SELECT COUNT(DISTINCT project_id) FROM project_tags),</span>
<span class="sd">            2)</span>
<span class="sd">    FROM</span>
<span class="sd">        project_tags</span>
<span class="sd">    GROUP BY</span>
<span class="sd">        1</span>
<span class="sd">    ORDER BY</span>
<span class="sd">        2 DESC</span>
<span class="sd">    LIMIT</span>
<span class="sd">        35;</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Un 5% equivale aprox a 2335 proyectos</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:23s}</span><span class="s2">  </span><span class="si">{:6d}</span><span class="s2">   </span><span class="si">{:6.2f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pct</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
GPL                       21176    45.53%
POSIX                     16868    36.27%
Linux                     16284    35.01%
C                         10288    22.12%
OS Independent            10178    21.88%
Software Development       9614    20.67%
Internet                   8097    17.41%
Windows                    7572    16.28%
Java                       6390    13.74%
Web                        6264    13.47%
English                    5997    12.89%
C++                        5891    12.67%
Libraries                  5738    12.34%
PHP                        5448    11.71%
Unix                       5098    10.96%
Mac OS X                   4823    10.37%
multimedia                 4813    10.35%
Communications             4449     9.57%
Perl                       4242     9.12%
Python                     4190     9.01%
LGPL                       3524     7.58%
Utilities                  3297     7.09%
Dynamic Content            3199     6.88%
GPLv3                      2875     6.18%
Networking                 2819     6.06%
Scientific/Engineering     2678     5.76%
Games/Entertainment        2528     5.44%
BSD                        2494     5.36%
Desktop Environment        2335     5.02%
Graphics                   2268     4.88%
Database                   2200     4.73%
GPLv2                      2147     4.62%
Text Processing            2131     4.58%
Sound/Audio                2094     4.50%
Security                   1960     4.21%
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Soporte mínimo</span>
<span class="c1">#</span>
<span class="n">MIN_SUPPORT_PCT</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1">#</span>
<span class="c1"># Descarta el porcentaje especificado (MIN_SUPPORT_PCT) de tags menos frecuentes.</span>
<span class="c1"># Se require que el tag aparezca en 554 proyectos o mas (de 46511 proyectos existentes)</span>
<span class="c1">#</span>
<span class="n">minsupport</span> <span class="o">=</span> <span class="n">baskets</span> <span class="o">*</span> <span class="p">(</span><span class="n">MIN_SUPPORT_PCT</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Minimum support count: </span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}% o</span><span class="s2">f bastkets)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">minsupport</span><span class="p">,</span> <span class="n">MIN_SUPPORT_PCT</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Minimum support count: 2325.55 (5% of bastkets)
</pre></div></div>
</div>
</div>
<div class="section" id="Singletons">
<h2>Singletons<a class="headerlink" href="#Singletons" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Descarta los tags menos frecuentes. Singletons es una</span>
<span class="c1">## lista de tuplas de la siguiente forma:</span>
<span class="c1">##</span>
<span class="c1">##    [(&#39;Apache 2.0&#39;,),</span>
<span class="c1">##     (&#39;Application Frameworks&#39;,),</span>
<span class="c1">##     (&#39;Archiving&#39;,),</span>
<span class="c1">##     ...</span>
<span class="c1">##    ]</span>
<span class="c1">##</span>
<span class="n">singletons</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SELECT</span>
<span class="sd">        DISTINCT tag_name</span>
<span class="sd">    FROM</span>
<span class="sd">        project_tags</span>
<span class="sd">    GROUP BY</span>
<span class="sd">        1</span>
<span class="sd">    HAVING</span>
<span class="sd">        COUNT(project_id) &gt;= {}</span>
<span class="sd">    ORDER BY</span>
<span class="sd">        tag_name</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">minsupport</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1">##</span>
<span class="c1">## Esta variable contiene todos los tags que aparecen</span>
<span class="c1">## en, al menos, el 5% de los proyectos</span>
<span class="c1">##</span>
<span class="n">allSingletonTags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">singletons</span><span class="p">]</span>

<span class="n">allSingletonTags</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Apache 2.0&#39;, &#39;Application Frameworks&#39;, &#39;Archiving&#39;, &#39;Artistic&#39;, &#39;BSD&#39;]
</pre></div></div>
</div>
</div>
<div class="section" id="Doubletons">
<h2>Doubletons<a class="headerlink" href="#Doubletons" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## La siguiente tabla contiene la cantidad de proyectos</span>
<span class="c1">## que tienen tag1 y tag2 simultáneamente</span>
<span class="c1">##</span>
<span class="n">conn</span><span class="o">.</span><span class="n">executescript</span><span class="p">(</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DROP TABLE IF EXISTS project_tag_pairs;</span>

<span class="sd">    CREATE TABLE project_tag_pairs</span>
<span class="sd">    (</span>
<span class="sd">        tag1      STRING,</span>
<span class="sd">        tag2      STRING,</span>
<span class="sd">        num_projs INT</span>
<span class="sd">    );</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">)</span>

<span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>

<span class="c1">##</span>
<span class="c1">## Uso de itertools.combinations</span>
<span class="c1">##</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0, 1)
(0, 2)
(0, 3)
(1, 2)
(1, 3)
(2, 3)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Tags que aparecen unicamente en las</span>
<span class="c1">## combinaciones admisibles de dos tags</span>
<span class="c1">## diferentes</span>
<span class="c1">##</span>
<span class="n">allDoubletonTags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="c1">##</span>
<span class="c1">## Tuplas unicas formadas por (tag0, tag1)</span>
<span class="c1">##</span>
<span class="n">doubletonSet</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">findDoubletons</span><span class="p">():</span>

    <span class="c1">##</span>
    <span class="c1">## INNER JOIN retorna lo registros que aparecen</span>
    <span class="c1">## simultaneamente en las dos tablas (intersección)</span>
    <span class="c1">##</span>
    <span class="c1">## La siguiente consulta retorna cuantos proyectos usan</span>
    <span class="c1">## tag1 y tag2 simultaneamente.</span>
    <span class="c1">##</span>
    <span class="c1">## Si:</span>
    <span class="c1">##</span>
    <span class="c1">##    prj0, tag0</span>
    <span class="c1">##    prj0, tag1</span>
    <span class="c1">##    prj0, tag2</span>
    <span class="c1">##    prj1, tag0</span>
    <span class="c1">##    prj1, tag1</span>
    <span class="c1">##    prj1, tag3</span>
    <span class="c1">##    prj2, tag0</span>
    <span class="c1">##    prj2, tag3</span>
    <span class="c1">##    ...</span>
    <span class="c1">##</span>
    <span class="c1">## El inner join con tag0 y tag1 genera:</span>
    <span class="c1">##</span>
    <span class="c1">##    prj0, tag0, prj0, tag1</span>
    <span class="c1">##    prj1, tag0, prj1, tag1</span>
    <span class="c1">##    ...</span>
    <span class="c1">##</span>
    <span class="n">getDoubletonFrequencyQuery</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT</span>
<span class="s2">            count(t1.project_id)</span>
<span class="s2">        FROM</span>
<span class="s2">            project_tags t1</span>
<span class="s2">        INNER JOIN</span>
<span class="s2">            project_tags t2</span>
<span class="s2">        ON</span>
<span class="s2">            t1.project_id = t2.project_id</span>
<span class="s2">        WHERE</span>
<span class="s2">        (</span>
<span class="s2">            t1.tag_name = &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
<span class="s2">            AND t2.tag_name = &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
<span class="s2">        )</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">insertPairQuery</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        INSERT INTO</span>
<span class="s2">            project_tag_pairs (tag1, tag2, num_projs)</span>
<span class="s2">        VALUES</span>
<span class="s2">            (&#39;</span><span class="si">{}</span><span class="s2">&#39;,&#39;</span><span class="si">{}</span><span class="s2">&#39;,</span><span class="si">{}</span><span class="s2">)</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1">##</span>
    <span class="c1">## Genera todas las combinaciones de dos tags usando</span>
    <span class="c1">## los tags individuales que cumplen con una ocurrencia</span>
    <span class="c1">## minima</span>
    <span class="c1">##</span>
    <span class="n">doubletonCandidates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">allSingletonTags</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">candidate</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">doubletonCandidates</span><span class="p">):</span>

        <span class="n">tag1</span> <span class="o">=</span> <span class="n">candidate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">tag2</span> <span class="o">=</span> <span class="n">candidate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1">##</span>
        <span class="c1">## Cuenta la cantidad de proyectos que usan tag1 y tag2 simultaneamente</span>
        <span class="c1">##</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="n">getDoubletonFrequencyQuery</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag1</span><span class="p">,</span> <span class="n">tag2</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>


        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">minsupport</span><span class="p">:</span>

            <span class="c1">## Don&#39;t panic!: reporta que se esta ejecutando.</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>


            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insertPairQuery</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag1</span><span class="p">,</span> <span class="n">tag2</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>

            <span class="c1">##</span>
            <span class="c1">## Inserta la tupla (tag1, tag2) en la tabla</span>
            <span class="c1">##</span>
            <span class="n">doubletonSet</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>

            <span class="c1">##</span>
            <span class="c1">## Agrega los tags a la lista de tags usados</span>
            <span class="c1">##</span>
            <span class="n">allDoubletonTags</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tag1</span><span class="p">)</span>
            <span class="n">allDoubletonTags</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tag2</span><span class="p">)</span>


<span class="n">findDoubletons</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
....................................
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SELECT</span>
<span class="sd">        *</span>
<span class="sd">    FROM</span>
<span class="sd">        project_tag_pairs</span>
<span class="sd">    ORDER BY</span>
<span class="sd">        1 ASC,</span>
<span class="sd">        2 ASC;</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Un 5% equivale aprox a 2335 proyectos</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">tag1</span><span class="p">,</span> <span class="n">tag2</span><span class="p">,</span> <span class="n">num_projs</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:23s}</span><span class="s2">  </span><span class="si">{:23s}</span><span class="s2">   </span><span class="si">{:6d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag1</span><span class="p">,</span> <span class="n">tag2</span><span class="p">,</span> <span class="n">num_projs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
C                        GPL                         5539
C                        Linux                       5648
C                        POSIX                       6952
C++                      GPL                         2911
C++                      Linux                       3425
C++                      POSIX                       3501
Communications           GPL                         2578
Dynamic Content          Internet                    3171
Dynamic Content          Web                         3170
English                  Linux                       2660
GPL                      Internet                    4035
GPL                      Linux                       8036
GPL                      OS Independent              4403
GPL                      PHP                         2372
GPL                      POSIX                      10062
GPL                      Software Development        3318
GPL                      Web                         2899
GPL                      Windows                     2603
GPL                      multimedia                  2879
Internet                 OS Independent              3005
Internet                 POSIX                       2831
Internet                 Web                         5973
Java                     OS Independent              3433
Java                     Software Development        2356
Libraries                Software Development        5633
Linux                    Mac OS X                    2973
Linux                    POSIX                      11896
Linux                    Software Development        2335
Linux                    Unix                        2493
Linux                    Windows                     5279
Mac OS X                 Windows                     3131
OS Independent           Software Development        3564
OS Independent           Web                         2602
POSIX                    Software Development        3501
POSIX                    Windows                     4464
POSIX                    multimedia                  2538
</pre></div></div>
</div>
</div>
<div class="section" id="Tripletons">
<h2>Tripletons<a class="headerlink" href="#Tripletons" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## La siguiente tabla contiene la cantidad de proyectos</span>
<span class="c1">## que tienen tag1, tag2 y tag3 simultáneamente</span>
<span class="c1">##</span>
<span class="n">conn</span><span class="o">.</span><span class="n">executescript</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">DROP TABLE IF EXISTS project_tag_triples;</span>

<span class="s2">CREATE TABLE project_tag_triples</span>
<span class="s2">(</span>
<span class="s2">    tag1      STRING,</span>
<span class="s2">    tag2      STRING,</span>
<span class="s2">    tag3      STRING,</span>
<span class="s2">    num_projs INT</span>
<span class="s2">);</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">findTripletons</span><span class="p">():</span>

    <span class="c1">##</span>
    <span class="c1">## Sigue una lógica similar a la usada anteriormente</span>
    <span class="c1">##</span>
    <span class="n">getTripletonFrequencyQuery</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT</span>
<span class="s2">            count(t1.project_id)</span>
<span class="s2">        FROM</span>
<span class="s2">            project_tags t1</span>
<span class="s2">        INNER JOIN</span>
<span class="s2">                project_tags t2</span>
<span class="s2">            ON</span>
<span class="s2">                t1.project_id = t2.project_id</span>
<span class="s2">        INNER JOIN</span>
<span class="s2">                project_tags t3</span>
<span class="s2">            ON</span>
<span class="s2">                t2.project_id = t3.project_id</span>
<span class="s2">        WHERE</span>
<span class="s2">        (</span>
<span class="s2">            t1.tag_name = &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
<span class="s2">            AND t2.tag_name = &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
<span class="s2">            AND t3.tag_name = &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
<span class="s2">        )</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">insertTripletonQuery</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        INSERT INTO project_tag_triples(tag1, tag2, tag3, num_projs)</span>
<span class="s2">        VALUES (&#39;</span><span class="si">{}</span><span class="s2">&#39;,&#39;</span><span class="si">{}</span><span class="s2">&#39;,&#39;</span><span class="si">{}</span><span class="s2">&#39;,</span><span class="si">{}</span><span class="s2">)</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1">##</span>
    <span class="c1">##  Crea tripletas ordenadas con los tags que aparecen en dos proyectos y</span>
    <span class="c1">##  cumplen con el soporte minimo</span>
    <span class="c1">##</span>
    <span class="n">tripletonCandidates</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">sorted</span><span class="p">(</span><span class="n">tc</span><span class="p">)</span> <span class="k">for</span> <span class="n">tc</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">allDoubletonTags</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tripletonCandidates</span><span class="p">):</span>

        <span class="c1">##</span>
        <span class="c1">## La tripleta contiene, al menos, una tupla que esta en la</span>
        <span class="c1">## la lista de doubleTons</span>
        <span class="c1">##</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">tuple_</span> <span class="ow">in</span> <span class="n">doubletonSet</span>
                <span class="k">for</span> <span class="n">tuple_</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
            <span class="p">]</span>
        <span class="p">):</span>

            <span class="c1">##</span>
            <span class="c1">## Computa la frecuencia de la tripleta</span>
            <span class="c1">##</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="n">getTripletonFrequencyQuery</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">candidate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">candidate</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">candidate</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1">##</span>
            <span class="c1">## Inserta las tripletas que cumplen con la frecuencia mínima</span>
            <span class="c1">##</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">minsupport</span><span class="p">:</span>

                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

                <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                    <span class="n">insertTripletonQuery</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">candidate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">candidate</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">candidate</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">count</span>
                    <span class="p">),</span>
                <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>


<span class="n">findTripletons</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
.........*
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SELECT</span>
<span class="sd">        *</span>
<span class="sd">    FROM</span>
<span class="sd">        project_tag_triples</span>
<span class="sd">    ORDER BY</span>
<span class="sd">        1 ASC,</span>
<span class="sd">        2 ASC,</span>
<span class="sd">        3 ASC;</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">)</span>


<span class="k">for</span> <span class="n">tag1</span><span class="p">,</span> <span class="n">tag2</span><span class="p">,</span> <span class="n">tag3</span><span class="p">,</span> <span class="n">num_projs</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:23s}</span><span class="s2">  </span><span class="si">{:23s}</span><span class="s2">  </span><span class="si">{:23s}</span><span class="s2">  </span><span class="si">{:6d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag1</span><span class="p">,</span> <span class="n">tag2</span><span class="p">,</span> <span class="n">tag3</span><span class="p">,</span> <span class="n">num_projs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
C                        GPL                      Linux                      3295
C                        GPL                      POSIX                      4360
C                        Linux                    POSIX                      4625
C++                      Linux                    POSIX                      2621
Dynamic Content          Internet                 Web                        3163
GPL                      Internet                 Web                        2874
GPL                      Linux                    POSIX                      7379
Internet                 OS Independent           Web                        2516
Linux                    POSIX                    Windows                    3312
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">calcSCAV</span><span class="p">(</span><span class="n">tagA</span><span class="p">,</span> <span class="n">tagB</span><span class="p">,</span> <span class="n">tagC</span><span class="p">,</span> <span class="n">ruleSupport</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="c1">##</span>
    <span class="c1">## Support</span>
    <span class="c1">##</span>
    <span class="n">ruleSupportPct</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">ruleSupport</span> <span class="o">/</span> <span class="n">baskets</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1">##</span>
    <span class="c1">## Confidence</span>
    <span class="c1">##</span>
    <span class="n">queryConf</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT num_projs</span>
<span class="s2">        FROM project_tag_pairs</span>
<span class="s2">        WHERE</span>
<span class="s2">        (</span>
<span class="s2">            (tag1 = &#39;</span><span class="si">{}</span><span class="s2">&#39; AND tag2 = &#39;</span><span class="si">{}</span><span class="s2">&#39;)</span>
<span class="s2">            OR  (tag2 = &#39;</span><span class="si">{}</span><span class="s2">&#39; AND tag1 = &#39;</span><span class="si">{}</span><span class="s2">&#39;)</span>
<span class="s2">        )</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">pairSupport</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">queryConf</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tagA</span><span class="p">,</span> <span class="n">tagB</span><span class="p">,</span> <span class="n">tagA</span><span class="p">,</span> <span class="n">tagB</span><span class="p">))</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">confidence</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">ruleSupport</span> <span class="o">/</span> <span class="n">pairSupport</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1">##</span>
    <span class="c1">## Added Value</span>
    <span class="c1">##</span>
    <span class="n">queryAV</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT count(*)</span>
<span class="s2">        FROM project_tags</span>
<span class="s2">        WHERE tag_name= &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">supportTagC</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">queryAV</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tagC</span><span class="p">))</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">supportTagCPct</span> <span class="o">=</span> <span class="n">supportTagC</span> <span class="o">/</span> <span class="n">baskets</span>

    <span class="n">addedValue</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">confidence</span> <span class="o">-</span> <span class="n">supportTagCPct</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">  [S=</span><span class="si">{}</span><span class="s2">, C=</span><span class="si">{}</span><span class="s2">, AV=</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">tagA</span><span class="p">,</span> <span class="n">tagB</span><span class="p">,</span> <span class="n">tagC</span><span class="p">,</span> <span class="n">ruleSupportPct</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">addedValue</span>
        <span class="p">),</span>
        <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">generateRules</span><span class="p">():</span>

    <span class="c1">##</span>
    <span class="c1">## Consulta para obtiener las tripletas para obtener las reglas</span>
    <span class="c1">##</span>
    <span class="n">getFinalListQuery</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT tag1, tag2, tag3, num_projs FROM project_tag_triples</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1">##</span>
    <span class="c1">## Obtiene las tripletas</span>
    <span class="c1">##</span>
    <span class="n">triples</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">getFinalListQuery</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;report.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">triple</span> <span class="ow">in</span> <span class="n">triples</span><span class="p">:</span>

            <span class="n">tag1</span> <span class="o">=</span> <span class="n">triple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">tag2</span> <span class="o">=</span> <span class="n">triple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">tag3</span> <span class="o">=</span> <span class="n">triple</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">ruleSupport</span> <span class="o">=</span> <span class="n">triple</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

            <span class="n">calcSCAV</span><span class="p">(</span><span class="n">tag1</span><span class="p">,</span> <span class="n">tag2</span><span class="p">,</span> <span class="n">tag3</span><span class="p">,</span> <span class="n">ruleSupport</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="n">calcSCAV</span><span class="p">(</span><span class="n">tag1</span><span class="p">,</span> <span class="n">tag3</span><span class="p">,</span> <span class="n">tag2</span><span class="p">,</span> <span class="n">ruleSupport</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="n">calcSCAV</span><span class="p">(</span><span class="n">tag2</span><span class="p">,</span> <span class="n">tag3</span><span class="p">,</span> <span class="n">tag1</span><span class="p">,</span> <span class="n">ruleSupport</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>


<span class="n">generateRules</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>head -n <span class="m">48</span> report.txt
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dynamic Content, Internet -&gt; Web  [S=0.07, C=1.0, AV=0.87]
Dynamic Content, Web -&gt; Internet  [S=0.07, C=1.0, AV=0.83]
Internet, Web -&gt; Dynamic Content  [S=0.07, C=0.53, AV=0.46]
*
Internet, OS Independent -&gt; Web  [S=0.05, C=0.84, AV=0.71]
Internet, Web -&gt; OS Independent  [S=0.05, C=0.42, AV=0.2]
OS Independent, Web -&gt; Internet  [S=0.05, C=0.97, AV=0.8]
*
GPL, Internet -&gt; Web  [S=0.06, C=0.71, AV=0.58]
GPL, Web -&gt; Internet  [S=0.06, C=0.99, AV=0.82]
Internet, Web -&gt; GPL  [S=0.06, C=0.48, AV=0.02]
*
C, Linux -&gt; POSIX  [S=0.1, C=0.82, AV=0.46]
C, POSIX -&gt; Linux  [S=0.1, C=0.67, AV=0.32]
Linux, POSIX -&gt; C  [S=0.1, C=0.39, AV=0.17]
*
C, GPL -&gt; POSIX  [S=0.09, C=0.79, AV=0.43]
C, POSIX -&gt; GPL  [S=0.09, C=0.63, AV=0.17]
GPL, POSIX -&gt; C  [S=0.09, C=0.43, AV=0.21]
*
C, GPL -&gt; Linux  [S=0.07, C=0.59, AV=0.24]
C, Linux -&gt; GPL  [S=0.07, C=0.58, AV=0.12]
GPL, Linux -&gt; C  [S=0.07, C=0.41, AV=0.19]
*
Linux, POSIX -&gt; Windows  [S=0.07, C=0.28, AV=0.12]
Linux, Windows -&gt; POSIX  [S=0.07, C=0.63, AV=0.27]
POSIX, Windows -&gt; Linux  [S=0.07, C=0.74, AV=0.39]
*
C++, Linux -&gt; POSIX  [S=0.06, C=0.77, AV=0.41]
C++, POSIX -&gt; Linux  [S=0.06, C=0.75, AV=0.4]
Linux, POSIX -&gt; C++  [S=0.06, C=0.22, AV=0.09]
*
GPL, Linux -&gt; POSIX  [S=0.16, C=0.92, AV=0.56]
GPL, POSIX -&gt; Linux  [S=0.16, C=0.73, AV=0.38]
Linux, POSIX -&gt; GPL  [S=0.16, C=0.62, AV=0.16]
*
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Derechos de autor 2019, Juan D. Velasquez.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>