

<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Copyright 2018 The TensorFlow Authors. &mdash; documentación de --- Cursos --- - </title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../../_static/clipboard.min.js"></script>
        <script type="text/javascript" src="../../../_static/copybutton.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Copyright 2018 The TensorFlow Authors.</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/notebooks/tensorflow/guide/upgrade.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Copyright-2018-The-TensorFlow-Authors.">
<h1>Copyright 2018 The TensorFlow Authors.<a class="headerlink" href="#Copyright-2018-The-TensorFlow-Authors." title="Enlazar permanentemente con este título">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>#@title Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
</pre></div>
</div>
</div>
<div class="section" id="Automatically-upgrade-code-to-TensorFlow-2">
<h2>Automatically upgrade code to TensorFlow 2<a class="headerlink" href="#Automatically-upgrade-code-to-TensorFlow-2" title="Enlazar permanentemente con este título">¶</a></h2>
<table class="tfo-notebook-buttons" align="left">  <td>

|35343826c6e44dae9987cd77e77c3cce| View on TensorFlow.org</td>  <td>

|921f44df455b40fe97ece77db680dc8c| Run in Google Colab</td>  <td>

|4dbe1c41e39746fe9a37251ce1c542a5| View source on GitHub</td>  <td>

|9ac9d42e5eea47fd8c7329824c6d5482| Download notebook</td></table><p>TensorFlow 2.0 includes many API changes, such as reordering arguments, renaming symbols, and changing default values for parameters. Manually performing all of these modifications would be tedious and prone to error. To streamline the changes, and to make your transition to TF 2.0 as seamless as possible, the TensorFlow team has created the <code class="docutils literal notranslate"><span class="pre">tf_upgrade_v2</span></code> utility to help transition legacy code to the new API.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">tf_upgrade_v2</span></code> is installed automatically for TensorFlow 1.13 and later (including all TF 2.0 builds).</p>
<p>Typical usage is like this:</p>
<pre class="devsite-terminal devsite-click-to-copy prettyprint lang-bsh">
tf_upgrade_v2 \
  --intree my_project/ \
  --outtree my_project_v2/ \
  --reportfile report.txt
</pre><p>It will accelerate your upgrade process by converting existing TensorFlow 1.x Python scripts to TensorFlow 2.0.</p>
<p>The conversion script automates as much as possible, but there are still syntactical and stylistic changes that cannot be performed by the script.</p>
<div class="section" id="Compatibility-modules">
<h3>Compatibility modules<a class="headerlink" href="#Compatibility-modules" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Certain API symbols can not be upgraded simply by using a string replacement. To ensure your code is still supported in TensorFlow 2.0, the upgrade script includes a <code class="docutils literal notranslate"><span class="pre">compat.v1</span></code> module. This module replaces TF 1.x symbols like <code class="docutils literal notranslate"><span class="pre">tf.foo</span></code> with the equivalent <code class="docutils literal notranslate"><span class="pre">tf.compat.v1.foo</span></code> reference. While the compatibility module is nice, we recommend that you manually proofread replacements and migrate them to new APIs in the <code class="docutils literal notranslate"><span class="pre">tf.*</span></code> namespace instead of <code class="docutils literal notranslate"><span class="pre">tf.compat.v1</span></code> namespace as quickly as
possible.</p>
<p>Because of TensorFlow 2.x module deprecations (for example, <code class="docutils literal notranslate"><span class="pre">tf.flags</span></code> and <code class="docutils literal notranslate"><span class="pre">tf.contrib</span></code>), some changes can not be worked around by switching to <code class="docutils literal notranslate"><span class="pre">compat.v1</span></code>. Upgrading this code may require using an additional library (for example, <code class="docutils literal notranslate"><span class="pre">`absl.flags</span></code> &lt;<a class="reference external" href="https://github.com/abseil/abseil-py">https://github.com/abseil/abseil-py</a>&gt;`__) or switching to a package in <a class="reference external" href="http://www.github.com/tensorflow/addons">tensorflow/addons</a>.</p>
</div>
<div class="section" id="Recommended-upgrade-process">
<h3>Recommended upgrade process<a class="headerlink" href="#Recommended-upgrade-process" title="Enlazar permanentemente con este título">¶</a></h3>
<p>The rest of this guide demonstrates how to use the upgrade script. While the upgrade script is easy to use, it is strongly recomended that you use the script as part of the following process:</p>
<ol class="arabic simple">
<li><p><strong>Unit Test</strong>: Ensure that the code you’re upgrading has a unit test suite with reasonable coverage. This is Python code, so the language won’t protect you from many classes of mistakes. Also ensure that any dependency you have has already been upgraded to be compatible with TensorFlow 2.0.</p></li>
<li><p><strong>Install TensorFlow 1.14</strong>: Upgrade your TensorFlow to the latest TensorFlow 1.x version, at least 1.14. This includes the final TensorFlow 2.0 API in <code class="docutils literal notranslate"><span class="pre">tf.compat.v2</span></code>.</p></li>
<li><p><strong>Test With 1.14</strong>: Ensure your unit tests pass at this point. You’ll be running them repeatedly as you upgrade so starting from green is important.</p></li>
<li><p><strong>Run the upgrade script</strong>: Run <code class="docutils literal notranslate"><span class="pre">tf_upgrade_v2</span></code> on your entire source tree, tests included. This will upgrade your code to a format where it only uses symbols available in TensorFlow 2.0. Deprecated symbols will be accessed with <code class="docutils literal notranslate"><span class="pre">tf.compat.v1</span></code>. These will eventually require manual attention, but not immediately.</p></li>
<li><p><strong>Run the converted tests with TensorFlow 1.14</strong>: Your code should still run fine in TensorFlow 1.14. Run your unit tests again. Any error in your tests here means there’s a bug in the upgrade script. <a class="reference external" href="https://github.com/tensorflow/tensorflow/issues">Please let us know</a>.</p></li>
<li><p><strong>Check the upgrade report for warnings and errors</strong>: The script writes a report file that explains any conversions you should double-check, or any manual action you need to take. For example: Any remaining instances of contrib will require manual action to remove. Please consult <a class="reference external" href="https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md">the RFC for more instructions</a>.</p></li>
<li><p><strong>Install TensorFlow 2.0</strong>: At this point it should be safe to switch to TensorFlow 2.0</p></li>
<li><p><strong>Test with ``v1.disable_v2_behavior``</strong>: Re-running your tests with al <code class="docutils literal notranslate"><span class="pre">v1.disable_v2_behavior()</span></code> in the tests main function should give the same results as running under 1.14.</p></li>
<li><p><strong>Enable V2 Behavior</strong>: Now that your tests work using the v2 API, you can start looking into turning on v2 behavior. Depending on how your code is written this may require some changes. See the <a class="reference internal" href="migrate.html"><span class="doc">Migration guide</span></a> for details.</p></li>
</ol>
</div>
<div class="section" id="Using-the-upgrade-script">
<h3>Using the upgrade script<a class="headerlink" href="#Using-the-upgrade-script" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="section" id="Setup">
<h4>Setup<a class="headerlink" href="#Setup" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Before getting started ensure that TensorlFlow 2.0 is installed.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>import tensorflow as tf

print(tf.__version__)
</pre></div>
</div>
</div>
<p>Clone the <a class="reference external" href="https://github.com/tensorflow/models">tensorflow/models</a> git repository so you have some code to test on:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!git clone --branch r1.13.0 --depth 1 https://github.com/tensorflow/models
</pre></div>
</div>
</div>
</div>
<div class="section" id="Read-the-help">
<h4>Read the help<a class="headerlink" href="#Read-the-help" title="Enlazar permanentemente con este título">¶</a></h4>
<p>The script should be installed with TensorFlow. Here is the builtin help:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!tf_upgrade_v2 -h
</pre></div>
</div>
</div>
</div>
<div class="section" id="Example-TF1-code">
<h4>Example TF1 code<a class="headerlink" href="#Example-TF1-code" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Here is a simple TensorFlow 1.0 script:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!head -n 65 models/samples/cookbook/regression/custom_regression.py | tail -n 10
</pre></div>
</div>
</div>
<p>With TensorFlow 2.0 installed it does not run:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!(cd models/samples/cookbook/regression &amp;&amp; python custom_regression.py)
</pre></div>
</div>
</div>
</div>
<div class="section" id="Single-file">
<h4>Single file<a class="headerlink" href="#Single-file" title="Enlazar permanentemente con este título">¶</a></h4>
<p>The upgrade script can be run on a single Python file:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!tf_upgrade_v2 \
  --infile models/samples/cookbook/regression/custom_regression.py \
  --outfile /tmp/custom_regression_v2.py
</pre></div>
</div>
</div>
<p>The script will print errors if it can not find a fix for the code.</p>
</div>
<div class="section" id="Directory-tree">
<h4>Directory tree<a class="headerlink" href="#Directory-tree" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Typical projects, including this simple example, will use much more than one file. Typically want to upgrade an entire package, so the script can also be run on a directory tree:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span># upgrade the .py files and copy all the other files to the outtree
!tf_upgrade_v2 \
    --intree models/samples/cookbook/regression/ \
    --outtree regression_v2/ \
    --reportfile tree_report.txt
</pre></div>
</div>
</div>
<p>Note the one warning about the <code class="docutils literal notranslate"><span class="pre">dataset.make_one_shot_iterator</span></code> function.</p>
<p>Now the script works in with TensorFlow 2.0:</p>
<p>Note that because the <code class="docutils literal notranslate"><span class="pre">tf.compat.v1</span></code> module, the converted script will also run in TensorFlow 1.14.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!(cd regression_v2 &amp;&amp; python custom_regression.py 2&gt;&amp;1) | tail
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Detailed-report">
<h3>Detailed report<a class="headerlink" href="#Detailed-report" title="Enlazar permanentemente con este título">¶</a></h3>
<p>The script also reports a list of detailed changes. In this example it found one possibly unsafe transformation and included a warning at the top of the file:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!head -n 20 tree_report.txt
</pre></div>
</div>
</div>
<p>Note again the one warning about the <code class="docutils literal notranslate"><span class="pre">Dataset.make_one_shot_iterator</span> <span class="pre">function</span></code>.</p>
<p>In other cases the output will explain the reasoning for non-trivial changes:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>%%writefile dropout.py
import tensorflow as tf

d = tf.nn.dropout(tf.range(10), 0.2)
z = tf.zeros_like(d, optimize=False)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!tf_upgrade_v2 \
  --infile dropout.py \
  --outfile dropout_v2.py \
  --reportfile dropout_report.txt &gt; /dev/null
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!cat dropout_report.txt
</pre></div>
</div>
</div>
<p>Here is the modified file contents, note how the script adds argument names to deal with moved and renamed arguments:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!cat dropout_v2.py
</pre></div>
</div>
</div>
<p>A larger project might contain a few errors. For example convert the deeplab model:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!tf_upgrade_v2 \
    --intree models/research/deeplab \
    --outtree deeplab_v2 \
    --reportfile deeplab_report.txt &gt; /dev/null
</pre></div>
</div>
</div>
<p>It produced the output files:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!ls deeplab_v2
</pre></div>
</div>
</div>
<p>But there were errors. The report will help you pin-point what you need to fix before this will run. Here are the first three errors:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!cat deeplab_report.txt | grep -i models/research/deeplab | grep -i error | head -n 3
</pre></div>
</div>
</div>
</div>
<div class="section" id="“Safety”-mode">
<h3>“Safety” mode<a class="headerlink" href="#“Safety”-mode" title="Enlazar permanentemente con este título">¶</a></h3>
<p>The conversion script also has a less invasive <code class="docutils literal notranslate"><span class="pre">SAFETY</span></code> mode that simply changes the imports to use the <code class="docutils literal notranslate"><span class="pre">tensorflow.compat.v1</span></code> module:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!cat dropout.py
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!tf_upgrade_v2 --mode SAFETY --infile dropout.py --outfile dropout_v2_safe.py &gt; /dev/null
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>!cat dropout_v2_safe.py
</pre></div>
</div>
</div>
<p>As you can see this doesn’t upgrade your code, but does allow TensorFlow 1 code to run in TensorFlow 2</p>
</div>
<div class="section" id="Caveats">
<h3>Caveats<a class="headerlink" href="#Caveats" title="Enlazar permanentemente con este título">¶</a></h3>
<ul class="simple">
<li><p>Do not update parts of your code manually before running this script. In particular, functions that have had reordered arguments like <code class="docutils literal notranslate"><span class="pre">tf.argmax</span></code> or <code class="docutils literal notranslate"><span class="pre">tf.batch_to_space</span></code> cause the script to incorrectly add keyword arguments that mismap your existing code.</p></li>
<li><p>The script assumes that <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> is imported using <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">tensorflow</span> <span class="pre">as</span> <span class="pre">tf</span></code>.</p></li>
<li><p>This script does not reorder arguments. Instead, the script adds keyword arguments to functions that have their arguments reordered.</p></li>
<li><p>Check out <a class="reference external" href="http://tf2up.ml">tf2up.ml</a> for a convenient tool to upgrade Jupyter notebooks and Python files in a GitHub repository.</p></li>
</ul>
<p>To report upgrade script bugs or make feature requests, please file an issue on <a class="reference external" href="https://github.com/tensorflow/tensorflow/issues">GitHub</a>. And if you’re testing TensorFlow 2.0, we want to hear about it! Join the <a class="reference external" href="https://groups.google.com/a/tensorflow.org/forum/#!forum/testing">TF 2.0 Testing community</a> and send questions and discussion to <a class="reference external" href="mailto:testing&#37;&#52;&#48;tensorflow&#46;org">testing<span>&#64;</span>tensorflow<span>&#46;</span>org</a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Derechos de autor 2019, Juan D. Velasquez.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>