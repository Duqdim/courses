

<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Unicode strings &mdash; documentación de --- Cursos --- - </title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../../../_static/clipboard.min.js"></script>
        <script type="text/javascript" src="../../../../_static/copybutton.js"></script>
        <script type="text/javascript" src="../../../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Índice" href="../../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../../search.html" />
    <link rel="next" title="TF.Text" href="1-07_TF.Text.html" />
    <link rel="prev" title="Load text" href="1-05_text.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Pregrado</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html">Redes Neuronales Artificiales y Algoritmos Bioinspirados</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-01">Sesión 01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-02">Sesión 02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-03">Sesión 03</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-04">Sesión 04</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-05">Sesión 05</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-06">Sesión 06</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-07">Sesión 07</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-08">Sesión 08</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-09">Sesión 09</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-10">Sesión 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-11">Sesión 11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-12">Sesión 12</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-13">Sesión 13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-14">Sesión 14</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-15">Sesión 15</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-16">Sesión 16</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Posgrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../analitica-de-grandes-datos/index.html">Analítica de Grandes Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ciencia-de-los-datos/index.html">Ciencia de los Datos Aplicada</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../productos-de-datos/index.html">Productos de Datos</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../redes_neuronales_y_algoritmos_bioinspirados/index.html">Redes Neuronales Artificiales y Algoritmos Bioinspirados</a> &raquo;</li>
        
      <li>Unicode strings</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/notebooks/tensorflow/tutorials/Load_and_process_data/1-06_unicode.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Unicode-strings">
<h1>Unicode strings<a class="headerlink" href="#Unicode-strings" title="Enlazar permanentemente con este título">¶</a></h1>
<table class="tfo-notebook-buttons" align="left"><td><p><a href="#id1"><span class="problematic" id="id2">|</span></a>c1befd2023704f1099294c72de113cb0|View on TensorFlow.org</p>
</td><td><p><a href="#id3"><span class="problematic" id="id4">|</span></a>968f89d0ed164c418d416ab79f0baf78|Run in Google Colab</p>
</td><td><p><a href="#id5"><span class="problematic" id="id6">|</span></a>87f114ea3f514b4fb68af83218088630|View source on GitHub</p>
</td><td><p><a href="#id7"><span class="problematic" id="id8">|</span></a>749b2d3c11ee420d963e9d8a216ccf11|Download notebook</p>
</td></table><div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Models that process natural language often handle different languages with different character sets. <em>Unicode</em> is a standard encoding system that is used to represent character from almost all languages. Each character is encoded using a unique integer <a class="reference external" href="https://en.wikipedia.org/wiki/Code_point">code point</a> between <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">0x10FFFF</span></code>. A <em>Unicode string</em> is a sequence of zero or more code points.</p>
<p>This tutorial shows how to represent Unicode strings in TensorFlow and manipulate them using Unicode equivalents of standard string ops. It separates Unicode strings into tokens based on script detection.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="The-tf.string-data-type">
<h2>The <code class="docutils literal notranslate"><span class="pre">tf.string</span></code> data type<a class="headerlink" href="#The-tf.string-data-type" title="Enlazar permanentemente con este título">¶</a></h2>
<p>The basic TensorFlow <code class="docutils literal notranslate"><span class="pre">tf.string</span></code> <code class="docutils literal notranslate"><span class="pre">dtype</span></code> allows you to build tensors of byte strings. Unicode strings are utf-8 encoded by default.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Thanks 😊&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">tf.string</span></code> tensor can hold byte strings of varying lengths because the byte strings are treated as atomic units. The string length is not included in the tensor dimensions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="sa">u</span><span class="s2">&quot;You&#39;re&quot;</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;welcome!&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<p>Note: When using python to construct strings, the handling of unicode differs betweeen v2 and v3. In v2, unicode strings are indicated by the “u” prefix, as above. In v3, strings are unicode-encoded by default.</p>
</div>
<div class="section" id="Representing-Unicode">
<h2>Representing Unicode<a class="headerlink" href="#Representing-Unicode" title="Enlazar permanentemente con este título">¶</a></h2>
<p>There are two standard ways to represent a Unicode string in TensorFlow:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">string</span></code> scalar — where the sequence of code points is encoded using a known <a class="reference external" href="https://en.wikipedia.org/wiki/Character_encoding">character encoding</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int32</span></code> vector — where each position contains a single code point.</p></li>
</ul>
<p>For example, the following three values all represent the Unicode string <code class="docutils literal notranslate"><span class="pre">&quot;语言处理&quot;</span></code> (which means “language processing” in Chinese):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Unicode string, represented as a UTF-8 encoded string scalar.</span>
<span class="n">text_utf8</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;语言处理&quot;</span><span class="p">)</span>
<span class="n">text_utf8</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Unicode string, represented as a UTF-16-BE encoded string scalar.</span>
<span class="n">text_utf16be</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;语言处理&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;UTF-16-BE&quot;</span><span class="p">))</span>
<span class="n">text_utf16be</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Unicode string, represented as a vector of Unicode code points.</span>
<span class="n">text_chars</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="sa">u</span><span class="s2">&quot;语言处理&quot;</span><span class="p">])</span>
<span class="n">text_chars</span>
</pre></div>
</div>
</div>
<div class="section" id="Converting-between-representations">
<h3>Converting between representations<a class="headerlink" href="#Converting-between-representations" title="Enlazar permanentemente con este título">¶</a></h3>
<p>TensorFlow provides operations to convert between these different representations:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tf.strings.unicode_decode</span></code>: Converts an encoded string scalar to a vector of code points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tf.strings.unicode_encode</span></code>: Converts a vector of code points to an encoded string scalar.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tf.strings.unicode_transcode</span></code>: Converts an encoded string scalar to a different encoding.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_decode</span><span class="p">(</span><span class="n">text_utf8</span><span class="p">,</span>
                          <span class="n">input_encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_encode</span><span class="p">(</span><span class="n">text_chars</span><span class="p">,</span>
                          <span class="n">output_encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_transcode</span><span class="p">(</span><span class="n">text_utf8</span><span class="p">,</span>
                             <span class="n">input_encoding</span><span class="o">=</span><span class="s1">&#39;UTF8&#39;</span><span class="p">,</span>
                             <span class="n">output_encoding</span><span class="o">=</span><span class="s1">&#39;UTF-16-BE&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Batch-dimensions">
<h3>Batch dimensions<a class="headerlink" href="#Batch-dimensions" title="Enlazar permanentemente con este título">¶</a></h3>
<p>When decoding multiple strings, the number of characters in each string may not be equal. The return result is a <code class="docutils literal notranslate"><span class="pre">`tf.RaggedTensor</span></code> &lt;../../guide/ragged_tensor.ipynb&gt;`__, where the length of the innermost dimension varies depending on the number of characters in each string:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># A batch of Unicode strings, each represented as a UTF8-encoded string.</span>
<span class="n">batch_utf8</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span>
              <span class="p">[</span><span class="sa">u</span><span class="s1">&#39;hÃllo&#39;</span><span class="p">,</span>  <span class="sa">u</span><span class="s1">&#39;What is the weather tomorrow&#39;</span><span class="p">,</span>  <span class="sa">u</span><span class="s1">&#39;Göödnight&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;😊&#39;</span><span class="p">]]</span>
<span class="n">batch_chars_ragged</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_decode</span><span class="p">(</span><span class="n">batch_utf8</span><span class="p">,</span>
                                               <span class="n">input_encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sentence_chars</span> <span class="ow">in</span> <span class="n">batch_chars_ragged</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">sentence_chars</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can use this <code class="docutils literal notranslate"><span class="pre">tf.RaggedTensor</span></code> directly, or convert it to a dense <code class="docutils literal notranslate"><span class="pre">tf.Tensor</span></code> with padding or a <code class="docutils literal notranslate"><span class="pre">tf.SparseTensor</span></code> using the methods <code class="docutils literal notranslate"><span class="pre">tf.RaggedTensor.to_tensor</span></code> and <code class="docutils literal notranslate"><span class="pre">tf.RaggedTensor.to_sparse</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">batch_chars_padded</span> <span class="o">=</span> <span class="n">batch_chars_ragged</span><span class="o">.</span><span class="n">to_tensor</span><span class="p">(</span><span class="n">default_value</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">batch_chars_padded</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">batch_chars_sparse</span> <span class="o">=</span> <span class="n">batch_chars_ragged</span><span class="o">.</span><span class="n">to_sparse</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>When encoding multiple strings with the same lengths, a <code class="docutils literal notranslate"><span class="pre">tf.Tensor</span></code> may be used as input:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_encode</span><span class="p">([[</span><span class="mi">99</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">116</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">103</span><span class="p">],</span> <span class="p">[</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">119</span><span class="p">]],</span>
                          <span class="n">output_encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>When encoding multiple strings with varying length, a <code class="docutils literal notranslate"><span class="pre">tf.RaggedTensor</span></code> should be used as input:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_encode</span><span class="p">(</span><span class="n">batch_chars_ragged</span><span class="p">,</span> <span class="n">output_encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If you have a tensor with multiple strings in padded or sparse format, then convert it to a <code class="docutils literal notranslate"><span class="pre">tf.RaggedTensor</span></code> before calling <code class="docutils literal notranslate"><span class="pre">unicode_encode</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_encode</span><span class="p">(</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">RaggedTensor</span><span class="o">.</span><span class="n">from_sparse</span><span class="p">(</span><span class="n">batch_chars_sparse</span><span class="p">),</span>
    <span class="n">output_encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_encode</span><span class="p">(</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">RaggedTensor</span><span class="o">.</span><span class="n">from_tensor</span><span class="p">(</span><span class="n">batch_chars_padded</span><span class="p">,</span> <span class="n">padding</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">output_encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Unicode-operations">
<h2>Unicode operations<a class="headerlink" href="#Unicode-operations" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="Character-length">
<h3>Character length<a class="headerlink" href="#Character-length" title="Enlazar permanentemente con este título">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tf.strings.length</span></code> operation has a parameter <code class="docutils literal notranslate"><span class="pre">unit</span></code>, which indicates how lengths should be computed. <code class="docutils literal notranslate"><span class="pre">unit</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">&quot;BYTE&quot;</span></code>, but it can be set to other values, such as <code class="docutils literal notranslate"><span class="pre">&quot;UTF8_CHAR&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;UTF16_CHAR&quot;</span></code>, to determine the number of Unicode codepoints in each encoded <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Note that the final character takes up 4 bytes in UTF8.</span>
<span class="n">thanks</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;Thanks 😊&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
<span class="n">num_bytes</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">length</span><span class="p">(</span><span class="n">thanks</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">num_chars</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">length</span><span class="p">(</span><span class="n">thanks</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;UTF8_CHAR&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> bytes; </span><span class="si">{}</span><span class="s1"> UTF-8 characters&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_bytes</span><span class="p">,</span> <span class="n">num_chars</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Character-substrings">
<h3>Character substrings<a class="headerlink" href="#Character-substrings" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Similarly, the <code class="docutils literal notranslate"><span class="pre">tf.strings.substr</span></code> operation accepts the “<code class="docutils literal notranslate"><span class="pre">unit</span></code>” parameter, and uses it to determine what kind of offsets the “<code class="docutils literal notranslate"><span class="pre">pos</span></code>” and “<code class="docutils literal notranslate"><span class="pre">len</span></code>” paremeters contain.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># default: unit=&#39;BYTE&#39;. With len=1, we return a single byte.</span>
<span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">substr</span><span class="p">(</span><span class="n">thanks</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specifying unit=&#39;UTF8_CHAR&#39;, we return a single character, which in this case</span>
<span class="c1"># is 4 bytes.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">substr</span><span class="p">(</span><span class="n">thanks</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;UTF8_CHAR&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Split-Unicode-strings">
<h3>Split Unicode strings<a class="headerlink" href="#Split-Unicode-strings" title="Enlazar permanentemente con este título">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tf.strings.unicode_split</span></code> operation splits unicode strings into substrings of individual characters:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_split</span><span class="p">(</span><span class="n">thanks</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Byte-offsets-for-characters">
<h3>Byte offsets for characters<a class="headerlink" href="#Byte-offsets-for-characters" title="Enlazar permanentemente con este título">¶</a></h3>
<p>To align the character tensor generated by <code class="docutils literal notranslate"><span class="pre">tf.strings.unicode_decode</span></code> with the original string, it’s useful to know the offset for where each character begins. The method <code class="docutils literal notranslate"><span class="pre">tf.strings.unicode_decode_with_offsets</span></code> is similar to <code class="docutils literal notranslate"><span class="pre">unicode_decode</span></code>, except that it returns a second tensor containing the start offset of each character.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">codepoints</span><span class="p">,</span> <span class="n">offsets</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_decode_with_offsets</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;🎈🎉🎊&quot;</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">codepoint</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">codepoints</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">offsets</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;At byte offset </span><span class="si">{}</span><span class="s2">: codepoint </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">codepoint</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Unicode-scripts">
<h2>Unicode scripts<a class="headerlink" href="#Unicode-scripts" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Each Unicode code point belongs to a single collection of codepoints known as a <a class="reference external" href="https://en.wikipedia.org/wiki/Script_%28Unicode%29">script</a> . A character’s script is helpful in determining which language the character might be in. For example, knowing that ‘Б’ is in Cyrillic script indicates that modern text containing that character is likely from a Slavic language such as Russian or Ukrainian.</p>
<p>TensorFlow provides the <code class="docutils literal notranslate"><span class="pre">tf.strings.unicode_script</span></code> operation to determine which script a given codepoint uses. The script codes are <code class="docutils literal notranslate"><span class="pre">int32</span></code> values corresponding to <a class="reference external" href="http://site.icu-project.org/home">International Components for Unicode</a> (ICU) <code class="docutils literal notranslate"><span class="pre">`UScriptCode</span></code> &lt;<a class="reference external" href="http://icu-project.org/apiref/icu4c/uscript_8h.html">http://icu-project.org/apiref/icu4c/uscript_8h.html</a>&gt;`__ values.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">uscript</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_script</span><span class="p">([</span><span class="mi">33464</span><span class="p">,</span> <span class="mi">1041</span><span class="p">])</span>  <span class="c1"># [&#39;芸&#39;, &#39;Б&#39;]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">uscript</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>  <span class="c1"># [17, 8] == [USCRIPT_HAN, USCRIPT_CYRILLIC]</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tf.strings.unicode_script</span></code> operation can also be applied to multidimensional <code class="docutils literal notranslate"><span class="pre">tf.Tensor</span></code>s or <code class="docutils literal notranslate"><span class="pre">tf.RaggedTensor</span></code>s of codepoints:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_script</span><span class="p">(</span><span class="n">batch_chars_ragged</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Example:-Simple-segmentation">
<h2>Example: Simple segmentation<a class="headerlink" href="#Example:-Simple-segmentation" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Segmentation is the task of splitting text into word-like units. This is often easy when space characters are used to separate words, but some languages (like Chinese and Japanese) do not use spaces, and some languages (like German) contain long compounds that must be split in order to analyze their meaning. In web text, different languages and scripts are frequently mixed together, as in “NY株価” (New York Stock Exchange).</p>
<p>We can perform very rough segmentation (without implementing any ML models) by using changes in script to approximate word boundaries. This will work for strings like the “NY株価” example above. It will also work for most languages that use spaces, as the space characters of various scripts are all classified as USCRIPT_COMMON, a special script code that differs from that of any actual text.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># dtype: string; shape: [num_sentences]</span>
<span class="c1">#</span>
<span class="c1"># The sentences to process.  Edit this line to try out different inputs!</span>
<span class="n">sentence_texts</span> <span class="o">=</span> <span class="p">[</span><span class="sa">u</span><span class="s1">&#39;Hello, world.&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;世界こんにちは&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>First, we decode the sentences into character codepoints, and find the script identifeir for each character.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># dtype: int32; shape: [num_sentences, (num_chars_per_sentence)]</span>
<span class="c1">#</span>
<span class="c1"># sentence_char_codepoint[i, j] is the codepoint for the j&#39;th character in</span>
<span class="c1"># the i&#39;th sentence.</span>
<span class="n">sentence_char_codepoint</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_decode</span><span class="p">(</span><span class="n">sentence_texts</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sentence_char_codepoint</span><span class="p">)</span>

<span class="c1"># dtype: int32; shape: [num_sentences, (num_chars_per_sentence)]</span>
<span class="c1">#</span>
<span class="c1"># sentence_char_scripts[i, j] is the unicode script of the j&#39;th character in</span>
<span class="c1"># the i&#39;th sentence.</span>
<span class="n">sentence_char_script</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_script</span><span class="p">(</span><span class="n">sentence_char_codepoint</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sentence_char_script</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, we use those script identifiers to determine where word boundaries should be added. We add a word boundary at the beginning of each sentence, and for each character whose script differs from the previous character:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># dtype: bool; shape: [num_sentences, (num_chars_per_sentence)]</span>
<span class="c1">#</span>
<span class="c1"># sentence_char_starts_word[i, j] is True if the j&#39;th character in the i&#39;th</span>
<span class="c1"># sentence is the start of a word.</span>
<span class="n">sentence_char_starts_word</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">sentence_char_script</span><span class="o">.</span><span class="n">nrows</span><span class="p">(),</span> <span class="mi">1</span><span class="p">],</span> <span class="kc">True</span><span class="p">),</span>
     <span class="n">tf</span><span class="o">.</span><span class="n">not_equal</span><span class="p">(</span><span class="n">sentence_char_script</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">sentence_char_script</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># dtype: int64; shape: [num_words]</span>
<span class="c1">#</span>
<span class="c1"># word_starts[i] is the index of the character that starts the i&#39;th word (in</span>
<span class="c1"># the flattened list of characters from all sentences).</span>
<span class="n">word_starts</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sentence_char_starts_word</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">word_starts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can then use those start offsets to build a <code class="docutils literal notranslate"><span class="pre">RaggedTensor</span></code> containing the list of words from all batches:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># dtype: int32; shape: [num_words, (num_chars_per_word)]</span>
<span class="c1">#</span>
<span class="c1"># word_char_codepoint[i, j] is the codepoint for the j&#39;th character in the</span>
<span class="c1"># i&#39;th word.</span>
<span class="n">word_char_codepoint</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">RaggedTensor</span><span class="o">.</span><span class="n">from_row_starts</span><span class="p">(</span>
    <span class="n">values</span><span class="o">=</span><span class="n">sentence_char_codepoint</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">row_starts</span><span class="o">=</span><span class="n">word_starts</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">word_char_codepoint</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And finally, we can segment the word codepoints <code class="docutils literal notranslate"><span class="pre">RaggedTensor</span></code> back into sentences:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># dtype: int64; shape: [num_sentences]</span>
<span class="c1">#</span>
<span class="c1"># sentence_num_words[i] is the number of words in the i&#39;th sentence.</span>
<span class="n">sentence_num_words</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">sentence_char_starts_word</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># dtype: int32; shape: [num_sentences, (num_words_per_sentence), (num_chars_per_word)]</span>
<span class="c1">#</span>
<span class="c1"># sentence_word_char_codepoint[i, j, k] is the codepoint for the k&#39;th character</span>
<span class="c1"># in the j&#39;th word in the i&#39;th sentence.</span>
<span class="n">sentence_word_char_codepoint</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">RaggedTensor</span><span class="o">.</span><span class="n">from_row_lengths</span><span class="p">(</span>
    <span class="n">values</span><span class="o">=</span><span class="n">word_char_codepoint</span><span class="p">,</span>
    <span class="n">row_lengths</span><span class="o">=</span><span class="n">sentence_num_words</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sentence_word_char_codepoint</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To make the final result easier to read, we can encode it back into UTF-8 strings:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_encode</span><span class="p">(</span><span class="n">sentence_word_char_codepoint</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Derechos de autor 2019, Juan D. Velasquez.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>