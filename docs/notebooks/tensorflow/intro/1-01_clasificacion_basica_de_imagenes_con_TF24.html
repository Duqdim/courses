

<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Clasificación básica de imágenes con TensorFlow 2.4 &mdash; documentación de --- Cursos --- - </title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../../_static/clipboard.min.js"></script>
        <script type="text/javascript" src="../../../_static/copybutton.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="Predicción de la eficiencia de combustible usando regresión con Early Stopping" href="1-02_regression.html" />
    <link rel="prev" title="NO - Predicción de la calidad de vinos usando Árboles de Regresión" href="../../sklearn/trees/-1-05-prediccion-de-la-calidad-del-vino.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/course-info.html">Información del curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/programming-labs.html">Laboratorios de programación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/complement.html">Material Complementario</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a> &raquo;</li>
        
          <li><a href="../../../redes-neuronales-con-tensorflow/content.html">Sesiones</a> &raquo;</li>
        
      <li>Clasificación básica de imágenes con TensorFlow 2.4</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/notebooks/tensorflow/intro/1-01_clasificacion_basica_de_imagenes_con_TF24.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Clasificación-básica-de-imágenes-con-TensorFlow-2.4">
<h1>Clasificación básica de imágenes con TensorFlow 2.4<a class="headerlink" href="#Clasificación-básica-de-imágenes-con-TensorFlow-2.4" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p>30:00 min | Última modificación: Mayo 3, 2021 | [YouTube]</p></li>
</ul>
<p>Adaptado de en:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.tensorflow.org/tutorials/quickstart/beginner">https://www.tensorflow.org/tutorials/quickstart/beginner</a></p></li>
<li><p><a class="reference external" href="https://www.tensorflow.org/tutorials/keras/classification">https://www.tensorflow.org/tutorials/keras/classification</a></p></li>
</ul>
<p><img alt="assets/fashion-mnist-sprite.png" src="notebooks/tensorflow/intro/../../assets/fashion-mnist-sprite.png" /></p>
<div class="section" id="Importación-de-librerías">
<h2>Importación de librerías<a class="headerlink" href="#Importación-de-librerías" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.4.1
</pre></div></div>
</div>
</div>
<div class="section" id="Carga-y-configuración-del-dataset-FASHION-MNIST">
<h2>Carga y configuración del dataset FASHION MNIST<a class="headerlink" href="#Carga-y-configuración-del-dataset-FASHION-MNIST" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Descarga de los datos</span>
<span class="c1">#</span>
<span class="p">(</span>
    <span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">),</span>
    <span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">),</span>
<span class="p">)</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fashion_mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="c1">#</span>
<span class="c1">#  Nombres de las clases</span>
<span class="c1">#</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;T-shirt/top&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Trouser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Pullover&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Dress&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Coat&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sandal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Shirt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sneaker&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bag&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Ankle boot&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valor</span><span class="se">\t</span><span class="s2">Nombre&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">class_names</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Valor   Nombre
----------------------------------------
0       T-shirt/top
1       Trouser
2       Pullover
3       Dress
4       Coat
5       Sandal
6       Shirt
7       Sneaker
8       Bag
9       Ankle boot
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Cantidad de patrones de entrenamiento y prueba</span>
<span class="c1">#</span>
<span class="n">train_images</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_labels</span><span class="p">),</span> <span class="n">test_images</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((60000, 28, 28), 60000, (10000, 28, 28), 10000)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Ejemplos de las figuras que contiene el dataset</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">plot_mnist_examples</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>

    <span class="c1"># images, labels = images.copy(), labels.copy()</span>

    <span class="c1">#</span>
    <span class="c1"># Las figuras son de 28x28 pixels, y el</span>
    <span class="c1"># color va enntre 0 y 255. Se realiza la</span>
    <span class="c1"># normalización del color al rango [0, 1]</span>
    <span class="c1">#</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">images</span> <span class="o">/</span> <span class="mf">255.0</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">img</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">class_names</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[(</span><span class="n">img</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span>  <span class="k">for</span> <span class="n">img</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">lbl</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>


<span class="n">plot_mnist_examples</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_0.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_1.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_2.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_3.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_4.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_5.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_6.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_7.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_8.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_8.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_9.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_9_9.png" />
</div>
</div>
</div>
<div class="section" id="Especificación-del-modelo-usando-el-API-funcional">
<h2>Especificación del modelo usando el API funcional<a class="headerlink" href="#Especificación-del-modelo-usando-el-API-funcional" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">create_model</span><span class="p">():</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>

    <span class="c1">#</span>
    <span class="c1"># Esta capa reduce una dimension de la matriz de entrada.</span>
    <span class="c1"># El conjunto de entrada es una lista de matrices de 28x28.</span>
    <span class="c1"># Flatten genera una lista de vectores de dimensión 28x28</span>
    <span class="c1">#</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()(</span><span class="n">inputs</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Preprocesamiento de la entrada [0, 255] --&gt; [0, 1]</span>
    <span class="c1">#</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">Rescaling</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Esta es una capa que conecta todas las neuronas de la</span>
    <span class="c1"># capa anterior con todas las neuronas de la capa actual.</span>
    <span class="c1">#</span>
    <span class="c1"># Las funciones de activación disponibles son:</span>
    <span class="c1">#</span>
    <span class="c1">#  - relu (rectified linear unit):  relu(x) = max(0, x)</span>
    <span class="c1">#</span>
    <span class="c1">#  - elu (exponential linear unit): elu(x) = x if x &gt;= 0 else exp(x) - 1</span>
    <span class="c1">#</span>
    <span class="c1">#  - exponential: exp(x)</span>
    <span class="c1">#</span>
    <span class="c1">#  - gelu (gaussian error linear unit): gelu(x) = x * P(X &lt;= x)  con  P(X) ~ N(0,1)</span>
    <span class="c1">#</span>
    <span class="c1">#  - hard_sigmoid:  hard_sigmoid(x) = max(0, min(1, 0.2 * x + 0.5))</span>
    <span class="c1">#</span>
    <span class="c1">#  - linear: linear(x) = x</span>
    <span class="c1">#</span>
    <span class="c1">#  - selu (scaled exponential linear unit): selu(x) = scale * alpha *(exp(x) - 1)</span>
    <span class="c1">#</span>
    <span class="c1">#  - sigmoid: sigmoid(x) = 1 / [1 + exp(-x)]</span>
    <span class="c1">#</span>
    <span class="c1">#  - softmax: softmax(z) = exp(z_i) / sum_j (exp(z_j))</span>
    <span class="c1">#</span>
    <span class="c1">#  - softplus: softplus(x) = log(exp(x) + 1)</span>
    <span class="c1">#</span>
    <span class="c1">#  - softsign: softsign(x) = x / (abs(x) + 1)</span>
    <span class="c1">#</span>
    <span class="c1">#  - swish: swish(x) = x * sigmoid(x)</span>
    <span class="c1">#</span>
    <span class="c1">#  - tanh</span>
    <span class="c1">#</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
        <span class="mi">128</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">,</span>
    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Capa densa con un numero de neuronas igual a la cantidad</span>
    <span class="c1"># de clases en el dataset</span>
    <span class="c1">#</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
        <span class="mi">10</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">,</span>
    <span class="p">)(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Crea el modelo y lo retorna</span>
    <span class="c1">#</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
        <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span>
        <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>


<span class="c1">#</span>
<span class="c1"># Creación del modelo</span>
<span class="c1">#</span>
<span class="n">base_model</span> <span class="o">=</span> <span class="n">create_model</span><span class="p">()</span>

<span class="c1">#</span>
<span class="c1"># Resumen del modelo creado</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;model&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         [(None, 28, 28)]          0
_________________________________________________________________
flatten (Flatten)            (None, 784)               0
_________________________________________________________________
rescaling (Rescaling)        (None, 784)               0
_________________________________________________________________
dense (Dense)                (None, 128)               100480
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1290
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
</div>
<div class="section" id="Propagación-de-la-señal">
<h2>Propagación de la señal<a class="headerlink" href="#Propagación-de-la-señal" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La salida del modelo son probabilidades para</span>
<span class="c1"># cada una de las clases. Aunque el modelo no</span>
<span class="c1"># esta entrenado si tiene pesos aleatorios.</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.04693179, 0.06426818, 0.12469718, 0.053248  , 0.10878702,
        0.0812891 , 0.03222162, 0.08387821, 0.2693331 , 0.13534577]],
      dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La suma del vector de salida es ~ 1.0</span>
<span class="c1">#</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.999999962747097
</pre></div></div>
</div>
</div>
<div class="section" id="Construcción-del-modelo-usando-Sequential">
<h2>Construcción del modelo usando Sequential<a class="headerlink" href="#Construcción-del-modelo-usando-Sequential" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Resulta más práctico especificar el modelo</span>
<span class="c1"># como una secuencia de capas</span>
<span class="c1">#</span>
<span class="n">base_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">Rescaling</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># base_model.built()</span>

<span class="c1">#</span>
<span class="c1"># Características del modelo creado</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
flatten_1 (Flatten)          (None, 784)               0
_________________________________________________________________
rescaling_1 (Rescaling)      (None, 784)               0
_________________________________________________________________
dense_2 (Dense)              (None, 128)               100480
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1290
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La salida del modelo son probabilidades para</span>
<span class="c1"># cada una de las clases. Aunque el modelo no</span>
<span class="c1"># esta entrenado si tiene pesos aleatorios.</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.05431718, 0.19397609, 0.17209741, 0.11078599, 0.10221046,
        0.01139911, 0.05305582, 0.05408902, 0.08404779, 0.16402107]],
      dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">sum</span><span class="p">(</span><span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9999999515712261
</pre></div></div>
</div>
</div>
<div class="section" id="Función-de-costo-para-entrenamiento-del-modelo">
<h2>Función de costo para entrenamiento del modelo<a class="headerlink" href="#Función-de-costo-para-entrenamiento-del-modelo" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En esta lección se usará la función de entropía cruzada. Esta es una medida del desempeño del clasificador que entrega probabilidad como salida. Esta medida incrementa cuando la probabilidad pronosticada diverge de la clase actual. En clasificación binaria <span class="math notranslate nohighlight">\(y \in \{0,1\}\)</span>, la entropía se calcula como:</p>
<div class="math notranslate nohighlight">
\[- y \cdot \log(p) - (1 - y) \log (1-p)\]</div>
<p>donde <span class="math notranslate nohighlight">\(p\)</span> es la probabilidad de que el pronóstico sea igual a <span class="math notranslate nohighlight">\(y\)</span></p>
<p>Si <span class="math notranslate nohighlight">\(y=1\)</span>, la función es <span class="math notranslate nohighlight">\(-\log(p)\)</span>; si <span class="math notranslate nohighlight">\(y=0\)</span>, la función es <span class="math notranslate nohighlight">\(-\log (1-p))\)</span>. La forma de curva de pérdida para cada caso es:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">plot_entropy</span><span class="p">():</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.9999</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Probabilidad pronosticada (p) con y=1&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$-\log(p)$&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Probabilidad pronosticada (p) con y=0&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$-\log(p)$&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plot_entropy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_22_0.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_22_0.png" />
</div>
</div>
<p>Para más de dos clases se generaliza a:</p>
<div class="math notranslate nohighlight">
\[- \sum d_c \cdot \log (p_c)\]</div>
<p>donde <span class="math notranslate nohighlight">\(d_c\)</span> indica que el punto pertenece a la clase <span class="math notranslate nohighlight">\(c\)</span> y <span class="math notranslate nohighlight">\(p_c\)</span> es su probabilidad de pertenencia (resultado del clasificador)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">loss_fn</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span>
    <span class="c1">#</span>
    <span class="c1"># Este parametro indica que las salidas son</span>
    <span class="c1"># probabilidades</span>
    <span class="c1">#</span>
    <span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Evaluación de la función de pérdida para la</span>
<span class="c1"># primera imagen del conjunto de prueba</span>
<span class="c1">#</span>
<span class="n">loss_fn</span><span class="p">(</span>
    <span class="n">train_labels</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span>
<span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.2402089
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Salida para el primer ejemplo de entrenamiento</span>
<span class="c1">#</span>
<span class="p">(</span>
    <span class="n">train_labels</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()),</span>
    <span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">base_model</span><span class="p">(</span><span class="n">train_images</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">())],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([9], dtype=uint8), 1, 0.19397609)
</pre></div></div>
</div>
</div>
<div class="section" id="Entrenamiento">
<h2>Entrenamiento<a class="headerlink" href="#Entrenamiento" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Compilación del modelo. En esta función se especifica:</span>
<span class="c1">#</span>
<span class="c1"># - El optimizador.</span>
<span class="c1"># - La función de pérdida.</span>
<span class="c1"># - Las metricas a monitorear.</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>

    <span class="c1">#</span>
    <span class="c1"># Especifica el algoritmo usado:</span>
    <span class="c1">#</span>
    <span class="c1">#   * &#39;adadelta&#39; : tf.keras.optimizers.Adadelta</span>
    <span class="c1">#   * &#39;adagrad&#39; : tf.keras.optimizers.Adagrad</span>
    <span class="c1">#   * &#39;adam&#39; : tf.keras.optimizers.Adam</span>
    <span class="c1">#   * &#39;adamax&#39; : tf.keras.optimizers.Adamax</span>
    <span class="c1">#   * &#39;ftrl&#39; : tf.keras.optimizers.Ftrl</span>
    <span class="c1">#   * &#39;nadam&#39; : tf.keras.optimizers.Nadam</span>
    <span class="c1">#   * &#39;rmsprop&#39; : tf.keras.optimizers.RMSprop</span>
    <span class="c1">#   * &#39;sgd&#39; : tf.keras.optimizers.SGD</span>
    <span class="c1">#</span>
    <span class="c1"># Puede usarse:</span>
    <span class="c1">#</span>
    <span class="c1">#   optimizer=&#39;adam&#39;</span>
    <span class="c1">#</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>

    <span class="c1">#</span>
    <span class="c1"># Función de costo</span>
    <span class="c1">#</span>
    <span class="c1">#   * tf.keras.losses.BinaryCrossentropy</span>
    <span class="c1">#   * tf.keras.losses.CategoricalCrossentropy</span>
    <span class="c1">#   * tf.keras.losses.CategoricalHinge</span>
    <span class="c1">#   * tf.keras.losses.CosineSimilarity</span>
    <span class="c1">#   * tf.keras.losses.Hinge</span>
    <span class="c1">#   * tf.keras.losses.Huber</span>
    <span class="c1">#   * tf.keras.losses.KLDivergence</span>
    <span class="c1">#   * tf.keras.losses.LogCosh</span>
    <span class="c1">#   * tf.keras.losses.MeanAbsoluteError</span>
    <span class="c1">#   * tf.keras.losses.MeanAbsolutePercentageError</span>
    <span class="c1">#   * tf.keras.losses.MeanSquaredError</span>
    <span class="c1">#   * tf.keras.losses.MeanSquaredLogarithmicError</span>
    <span class="c1">#   * tf.keras.losses.Poisson</span>
    <span class="c1">#   * tf.keras.losses.SparseCategoricalCrossentropy</span>
    <span class="c1">#   * tf.keras.losses.SquaredHinge</span>
    <span class="c1">#</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">,</span>

    <span class="c1">#</span>
    <span class="c1"># Define las metricas a monitorear</span>
    <span class="c1">#</span>
    <span class="c1">#   * &#39;accuracy&#39; : tf.keras.metrics.Accuracy</span>
    <span class="c1">#   * &#39;binary_accuracy&#39; : tf.keras.metrics.BinaryAccuracy</span>
    <span class="c1">#   * &#39;binary_crossentropy&#39; : tf.keras.metrics.BinaryCrossentropy</span>
    <span class="c1">#   * &#39;categorical_accuracy&#39; : tf.keras.metrics.CategoricalAccuracy</span>
    <span class="c1">#   * &#39;categorical_crossentropy&#39; : tf.keras.metrics.CategoricalCrossentropy</span>
    <span class="c1">#   * &#39;categorical_hinge&#39; : tf.keras.metrics.CategoricalHinge</span>
    <span class="c1">#   * &#39;cosine_similarity&#39; : tf.keras.metrics.CosineSimilarity</span>
    <span class="c1">#   * &#39;hinge&#39; : tf.keras.metrics.Hinge</span>
    <span class="c1">#   * &#39;kullback_leibler_divergence&#39; : tf.keras.metrics.KLDivergence</span>
    <span class="c1">#   * &#39;logcosh&#39; : tf.keras.metrics.LogCoshError</span>
    <span class="c1">#   * &#39;mean&#39; : tf.keras.metrics.Mean</span>
    <span class="c1">#   * &#39;mean_absolute_error&#39;: tf.keras.metrics.MeanAbsoluteError</span>
    <span class="c1">#   * &#39;mean_absolute_percentage_error&#39; : tf.keras.metrics.MeanAbsolutePercentageError</span>
    <span class="c1">#   * &#39;mean_squared_error&#39; : tf.keras.metrics.MeanSquaredError</span>
    <span class="c1">#   * &#39;mean_squared_logarithmic_error&#39; : tf.keras.metrics.MeanSquaredLogarithmicError</span>
    <span class="c1">#   * &#39;root_mean_squared_error&#39;: tf.keras.metrics.RootMeanSquaredError</span>
    <span class="c1">#   * &#39;squared_hinge&#39; : tf.keras.metrics.SquaredHinge</span>
    <span class="c1">#   ...</span>
    <span class="c1">#</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Entrenamiento del modelo</span>
<span class="c1">#</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>       <span class="c1"># Número de veces que se recorre el conjunto de entrenamiento</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>       <span class="c1"># 0 = silent, 1 = progress bar, 2 = one line per epoch</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>   <span class="c1"># Número de muestras para la actualización del gradiente</span>
<span class="p">)</span>

<span class="c1"># Note que 60.000 / 32 = 1875 batches</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.7358 - accuracy: 0.7412
Epoch 2/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.6234 - accuracy: 0.8403
Epoch 3/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.6116 - accuracy: 0.8511
Epoch 4/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.6016 - accuracy: 0.8610
Epoch 5/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5955 - accuracy: 0.8667
Epoch 6/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5901 - accuracy: 0.8725
Epoch 7/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5871 - accuracy: 0.8752
Epoch 8/10
1875/1875 [==============================] - 3s 2ms/step - loss: 1.5814 - accuracy: 0.8800
Epoch 9/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5778 - accuracy: 0.8844
Epoch 10/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5788 - accuracy: 0.8829
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La componente history es un diccionario con la</span>
<span class="c1"># perdida para cada iteración y las metricas</span>
<span class="c1"># monitoreadas.</span>
<span class="c1">#</span>
<span class="n">history</span><span class="o">.</span><span class="n">history</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;loss&#39;: [1.6708227396011353,
  1.620427131652832,
  1.6078561544418335,
  1.5998992919921875,
  1.594343900680542,
  1.5886402130126953,
  1.5871775150299072,
  1.5821540355682373,
  1.5779517889022827,
  1.5763660669326782],
 &#39;accuracy&#39;: [0.7998499870300293,
  0.8428000211715698,
  0.8545666933059692,
  0.8628000020980835,
  0.8673833608627319,
  0.8736833333969116,
  0.8748999834060669,
  0.8793833255767822,
  0.8838333487510681,
  0.8854833245277405]}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La componente epoch indica la iteración</span>
<span class="c1">#</span>
<span class="n">history</span><span class="o">.</span><span class="n">epoch</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</pre></div></div>
</div>
</div>
<div class="section" id="Uso-de-un-conjunto-de-validación-durante-el-entrenamiento">
<h2>Uso de un conjunto de validación durante el entrenamiento<a class="headerlink" href="#Uso-de-un-conjunto-de-validación-durante-el-entrenamiento" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">history</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>

<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5733 - accuracy: 0.8887
Epoch 2/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5734 - accuracy: 0.8880: 0s - loss: 1.5741 - ac
Epoch 3/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5713 - accuracy: 0.8904
Epoch 4/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5681 - accuracy: 0.8933
Epoch 5/10
1875/1875 [==============================] - 3s 2ms/step - loss: 1.5665 - accuracy: 0.8949
Epoch 6/10
1875/1875 [==============================] - 3s 2ms/step - loss: 1.5678 - accuracy: 0.8937
Epoch 7/10
1875/1875 [==============================] - 3s 2ms/step - loss: 1.5644 - accuracy: 0.8967
Epoch 8/10
1875/1875 [==============================] - 3s 2ms/step - loss: 1.5640 - accuracy: 0.8976
Epoch 9/10
1875/1875 [==============================] - 4s 2ms/step - loss: 1.5631 - accuracy: 0.8982
Epoch 10/10
1875/1875 [==============================] - 5s 3ms/step - loss: 1.5613 - accuracy: 0.9002
</pre></div></div>
</div>
</div>
<div class="section" id="Evaluación-y-pronóstico-para-nuevos-datos">
<h2>Evaluación y pronóstico para nuevos datos<a class="headerlink" href="#Evaluación-y-pronóstico-para-nuevos-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Evaluación para el conjunto de entrenamiento</span>
<span class="c1">#</span>
<span class="n">train_loss</span><span class="p">,</span> <span class="n">train_acc</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">train_loss</span><span class="p">,</span> <span class="n">train_acc</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1875/1875 - 3s - loss: 1.5560 - accuracy: 0.9057
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1.5559605360031128, 0.9056666493415833)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Evaluación para el conjunto de prueba</span>
<span class="c1">#</span>
<span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span>  <span class="n">test_labels</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,)</span>

<span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
313/313 - 1s - loss: 1.5871 - accuracy: 0.8731
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1.5871065855026245, 0.8730999827384949)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Predicción para el conjunto de test</span>
<span class="c1">#</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_images</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1">#  Valores asignados a cada una de las clases</span>
<span class="c1">#  para el primer ejemplo</span>
<span class="c1">#</span>
<span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([6.7609408e-12, 9.7272086e-21, 3.2448283e-18, 1.8043516e-19,
       5.7758680e-25, 2.3754108e-04, 1.0767559e-15, 1.4585090e-02,
       1.9329138e-14, 9.8517740e-01], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Suma de los valores asignados a cada clase para el primer</span>
<span class="c1">#  ejemplo. Puede asimilarse a probabilidad.</span>
<span class="c1">#</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0000000286886062
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Label para el que se produce el valor más alto para el primer ejemplo</span>
<span class="c1">#</span>
<span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
9
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Graficos de predicciones</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">plot_prediction</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">):</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">48</span><span class="p">):</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">test_images</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">thisplot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="n">thisplot</span><span class="p">[</span><span class="n">test_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">class_names</span><span class="p">[</span><span class="n">test_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:2.0f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">class_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>


<span class="n">plot_prediction</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_38_0.png" src="../../../_images/notebooks_tensorflow_intro_1-01_clasificacion_basica_de_imagenes_con_TF24_38_0.png" />
</div>
</div>
</div>
<div class="section" id="Uso-del-modelo-entrenado">
<h2>Uso del modelo entrenado<a class="headerlink" href="#Uso-del-modelo-entrenado" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Imagen a ser pronosticada</span>
<span class="c1">#</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">test_images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">img</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># tamaño</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(28, 28)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Keras está optimizado para generar pronósticos</span>
<span class="c1"># sobre colecciones, por lo que debe crearse una</span>
<span class="c1"># colección de una sola figura</span>
<span class="c1">#</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">img</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 28, 28)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictions_single</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">predictions_single</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions_single</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[6.7609147e-12 9.7272450e-21 3.2448159e-18 1.8043447e-19 5.7758680e-25
  2.3754132e-04 1.0767518e-15 1.4585055e-02 1.9329138e-14 9.8517740e-01]]

 9
</pre></div></div>
</div>
</div>
<div class="section" id="Guardar-y-restaurar-el-modelo-en-formato-SavedModel">
<h2>Guardar y restaurar el modelo en formato SavedModel<a class="headerlink" href="#Guardar-y-restaurar-el-modelo-en-formato-SavedModel" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># En este formato el modelo se debe salvar a</span>
<span class="c1"># una carpeta</span>
<span class="c1">#</span>
<span class="o">!</span>mkdir -p saved_model
<span class="n">base_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;saved_model/my_model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO:tensorflow:Assets written to: saved_model/my_model/assets
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>ls saved_model/my_model
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
assets  saved_model.pb  variables
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Carga el modelo a una nueva variable</span>
<span class="c1">#</span>
<span class="n">new_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;saved_model/my_model&#39;</span><span class="p">)</span>
<span class="n">new_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
flatten_1 (Flatten)          (None, 784)               0
_________________________________________________________________
rescaling_1 (Rescaling)      (None, 784)               0
_________________________________________________________________
dense_2 (Dense)              (None, 128)               100480
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1290
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
</div>
<div class="section" id="Guardar-y-restarurar-del-modelo-en-formato-HDF5">
<h2>Guardar y restarurar del modelo en formato HDF5<a class="headerlink" href="#Guardar-y-restarurar-del-modelo-en-formato-HDF5" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># En este formato, todo el modelo queda guardado</span>
<span class="c1"># en un archivo</span>
<span class="c1">#</span>
<span class="n">base_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;my_model.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;my_model.h5&#39;</span><span class="p">)</span>
<span class="n">new_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
flatten_1 (Flatten)          (None, 784)               0
_________________________________________________________________
rescaling_1 (Rescaling)      (None, 784)               0
_________________________________________________________________
dense_2 (Dense)              (None, 128)               100480
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1290
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<p><strong>Ejercicio.—</strong> ¿Cómo varía la precisión del modelo con la cantidad de neuronas de la capa oculta?</p>
</div>
<div class="section" id="Notas">
<h2>Notas<a class="headerlink" href="#Notas" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">elu</span></code>: Exponential Linear Unit</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\text{elu}(x) =
\begin{cases}
x &amp; x \ge 0 \\
\exp(x) - 1 &amp; x \lt 0
\end{cases}\end{split}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">exponential</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\exp (x)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GELU</span></code>: Gaussian Error Linear Unit</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{GELU}(x) = x \cdot \text{P}(X \le x) \text{    con    } \text{P}(X) \sim \text{N}(0, 1)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hard_sigmoid</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\text{hard_sigmoid}(x) =
\begin{cases}
    0 &amp; x \lt -2.5 \\
    0.2 \cdot x + 0.5 &amp; -2.5 \le x \le 2.5 \\
    1 &amp; x \gt 2.5
\end{cases}\end{split}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{linear}(x) = x\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">relu</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{relu}(x) = \max(0, x)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">selu</span></code>: scaled exponential lineal</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{selu}(x) = \text{scale} \cdot \text{alpha} \cdot (\exp(x) - 1)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sigmoid</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{sigmoid}(x) = \frac{1}{1+\exp(-x)}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">softmax</span></code>: recibe un vector de valores <span class="math notranslate nohighlight">\(z_j\)</span> en el rango [0, 1]. Retorna un vector de igual tamaño con:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{\exp(z_j)}{\sum_i \exp(z_i)}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">softplus</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{softplus}(x) = \log(\exp(x) + 1)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">softsign</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{softsign}=\frac{x}{\text{abs}(x) + 1}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">swish</span></code>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{swish}=x \cdot \text{sigmoid}(x)\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tanh</span></code>: tangente hiperbólica</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Nombre y dimensiones de salida de la capas</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">base_model</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>  <span class="n">layer</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
flatten_1 (None, 784)
rescaling_1 (None, 784)
dense_2 (None, 128)
dense_3 (None, 10)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Parametros entrenables</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">base_model</span><span class="o">.</span><span class="n">trainable_weights</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[-0.10421571 -0.06240859  0.1952838  ... -0.16547199 -0.05001107
   0.02305574]
 [-0.20627789 -0.37578118 -0.38790503 ... -0.23133028  0.08004921
   0.006285  ]
 [ 0.34566772 -0.0633857   0.25301737 ...  0.30142316 -0.05512619
  -0.00506764]
 ...
 [-0.0876745   0.3446312   0.03313578 ...  0.05519462 -0.0577137
  -0.01112463]
 [ 0.1877002   0.33102342 -0.4901831  ... -0.0799901   0.01418441
   0.05539627]
 [ 0.2548247  -0.18743555 -0.37670818 ...  0.00569417  0.02134142
   0.02781577]]

[-1.6911887e-01 -3.4918064e-01  1.9558465e-01 -4.5544493e-01
  4.7486904e-01 -3.3227214e-01  2.1488710e-01 -5.8749840e-02
  1.2460944e-01  5.0036383e-01  1.5367343e-01  6.5077972e-01
 -2.4798784e-01  1.4433086e-02 -1.3159281e+00 -1.3720943e-02
 -1.0442466e-01 -6.1730362e-02  1.8927428e-01  4.1903576e-01
  2.9571904e-02 -2.4619712e-01 -1.3925085e-02 -5.9977227e-01
  1.3483679e-01  1.0517288e+00  7.8891911e-02 -4.1477486e-01
  3.0769923e-01  3.3382255e-01  4.5528087e-01 -1.8634582e-01
  3.1998938e-01 -5.0834382e-01  4.1803372e-01  8.2532668e-01
  8.7870079e-01 -1.1429504e+00 -1.8462010e-02  8.5367560e-01
  2.0756134e-01  1.6368373e-01 -4.6707502e-01 -3.7239072e-01
 -2.8211114e-01 -5.5612826e-01 -2.3886025e-02  5.1450598e-01
 -2.7210164e-01  2.1932077e-02  4.2665595e-01 -2.8750202e-01
 -2.0327836e-03 -7.6834607e-01  5.1970661e-01 -6.1653536e-02
 -8.0510950e-01 -6.2364161e-01  4.1388053e-01  2.0623486e-01
  3.1912440e-01 -1.9214762e-02  6.2937617e-01  8.4914082e-01
 -2.0189976e-02 -3.2738793e-01  3.1955665e-01  1.1185212e+00
 -3.1479022e-01 -8.3813317e-02 -3.0032894e-01 -3.6098793e-01
 -7.1653664e-02 -2.2241031e-01  7.3396748e-01  1.6272402e-01
 -1.2015642e+00 -2.2134010e-02 -1.1466295e-02  1.4347316e-01
 -1.7702129e-02 -1.8359210e-02 -4.5918614e-01  1.3752577e-01
 -2.4327911e-01 -1.7188646e-01 -1.1675137e-01  4.4381696e-01
  1.0399188e+00 -4.3765780e-02  8.3557022e-01 -2.2464299e-01
  6.5464711e-01 -7.1860421e-01  3.1611377e-01 -3.1073039e-02
  2.5930515e-01 -2.8395638e-01  3.2504788e-01  1.6914999e-01
 -2.6739544e-01 -6.0218424e-01  3.6746770e-01  1.1226840e+00
  1.7656893e-01  4.7021908e-01 -1.6000222e-02 -3.0497193e-02
 -6.6122228e-01  5.2563494e-01  9.0029490e-01  6.7673796e-01
  2.2700654e-01  1.3380671e-01 -1.3274834e+00  4.1836599e-01
 -4.8098662e-01  6.2206380e-02 -1.1017120e+00 -2.1523687e-01
 -2.5742593e-01 -6.4671983e-04  7.8876400e-01 -8.5538626e-02
 -4.3609399e-02  1.8885627e-01 -3.1031001e-02 -2.3948159e-02]

[[ 0.40634754  0.237382   -1.6494951  ... -0.6509423  -0.8389466
  -0.79550797]
 [-0.39555705 -0.9017762  -0.12748379 ...  0.14857675 -0.54642624
   0.29147837]
 [ 0.20847468 -0.8011649  -0.13038036 ...  0.09063356  0.28145838
  -0.38188866]
 ...
 [-0.02344229 -0.33688042 -0.5074646  ... -0.34723854 -0.7737513
   0.2418588 ]
 [-0.40663987  0.19812837 -0.06140856 ... -0.899044   -0.24643438
   0.32605115]
 [-0.15592235  0.07972852 -0.07222243 ... -0.13903831 -0.06680357
  -0.15477449]]

[ 0.05740546 -0.58758414  0.38351485  0.48760998 -0.9588584   0.38009804
  0.6053499   0.4120957  -0.43066877 -0.81629384]

</pre></div></div>
</div>
</div>
<div class="section" id="layers.Flatten">
<h2>layers.Flatten<a class="headerlink" href="#layers.Flatten" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La capa Flatten reduce en una dimensión</span>
<span class="c1"># la matriz de entrada</span>
<span class="c1">#</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tf.Tensor(
[[[ 0.81309074  0.4719786  -0.05699781  0.6445682 ]
  [-0.42046568  1.2513175   1.0960948  -0.70431095]
  [ 0.9418766  -0.9085891  -0.96785855  0.02143146]]

 [[ 1.3957748   0.8238924   0.6955087   0.05466564]
  [-2.3491719  -1.8497964   0.08860824  0.03129346]
  [ 1.8257233  -0.07355884 -0.41313082  0.55454075]]], shape=(2, 3, 4), dtype=float32)

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;tf.Tensor: shape=(2, 12), dtype=float32, numpy=
array([[ 0.81309074,  0.4719786 , -0.05699781,  0.6445682 , -0.42046568,
         1.2513175 ,  1.0960948 , -0.70431095,  0.9418766 , -0.9085891 ,
        -0.96785855,  0.02143146],
       [ 1.3957748 ,  0.8238924 ,  0.6955087 ,  0.05466564, -2.3491719 ,
        -1.8497964 ,  0.08860824,  0.03129346,  1.8257233 , -0.07355884,
        -0.41313082,  0.55454075]], dtype=float32)&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Dimensiones de la salida de una capa Flatten</span>
<span class="c1">#</span>
<span class="n">demo_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">output_shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(None, 6)
</pre></div></div>
</div>
</div>
<div class="section" id="layers.Dense">
<h2>layers.Dense<a class="headerlink" href="#layers.Dense" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Dense: es una capa que conecta todas las entradas</span>
<span class="c1"># a todas las neuronas de la capa</span>
<span class="c1">#</span>
<span class="n">demo_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
    <span class="n">units</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># Si es None se usa Linear(x) = x</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,)),</span>
<span class="p">)</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">output_shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(None, 3)
</pre></div></div>
</div>
</div>
<div class="section" id="Activation">
<h2>Activation<a class="headerlink" href="#Activation" title="Enlazar permanentemente con este título">¶</a></h2>
</div>
<div class="section" id="Ejemplo-de-propagación-de-una-señal">
<h2>Ejemplo de propagación de una señal<a class="headerlink" href="#Ejemplo-de-propagación-de-una-señal" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Propagación de la señal</span>
<span class="c1">#</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;tf.Tensor: shape=(4, 2), dtype=float32, numpy=
array([[-0.36650416, -0.7611957 ],
       [ 0.15290274, -0.9245515 ],
       [-0.8443028 , -1.1464666 ],
       [-1.5482028 , -0.37995768]], dtype=float32)&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">demo_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential_2&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
dense_4 (Dense)              (None, 3)                 9
=================================================================
Total params: 9
Trainable params: 9
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Capa de entrada --&gt; capa salida</span>
<span class="c1">#</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[-0.21179003,  0.8058411 ,  0.2548344 ],
       [-0.9830012 , -0.63725245, -0.47209847]], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Bias capa de salida</span>
<span class="c1">#</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0., 0., 0.], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">demo_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.8258782 ,  0.18972972,  0.26596147],
       [ 0.8764519 ,  0.71238804,  0.4754442 ],
       [ 1.3057929 ,  0.05021483,  0.32608777],
       [ 0.70139277, -1.0054765 , -0.2151579 ]], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Primer patron de entrada a la primera neurona oculta</span>
<span class="c1">#</span>
<span class="c1">#       x1 *         w1 +         x2 *        w2 + w0</span>
<span class="mf">0.34032142</span> <span class="o">*</span> <span class="mf">0.98092103</span> <span class="o">+</span> <span class="o">-</span><span class="mf">0.2889726</span> <span class="o">*</span> <span class="mf">0.3135172</span> <span class="o">+</span> <span class="mf">0.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.24323055740874255
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Primer patrón de entrada a la segunda neurona oculta</span>
<span class="c1">#</span>
<span class="c1">#       x1 *         w1 +         x2 *         w2 + w0</span>
<span class="mf">0.34032142</span> <span class="o">*</span> <span class="mf">0.86922000</span> <span class="o">+</span> <span class="o">-</span><span class="mf">0.2889726</span> <span class="o">*</span> <span class="mf">0.57068133</span> <span class="o">+</span> <span class="mf">0.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.130902916990842
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Nombre y dimensiones de salida de la capas</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">base_model</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>  <span class="n">layer</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
flatten_1 (None, 784)
rescaling_1 (None, 784)
dense_2 (None, 128)
dense_3 (None, 10)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Parametros entrenables</span>
<span class="c1">#</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">base_model</span><span class="o">.</span><span class="n">trainable_weights</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[-0.10421571 -0.06240859  0.1952838  ... -0.16547199 -0.05001107
   0.02305574]
 [-0.20627789 -0.37578118 -0.38790503 ... -0.23133028  0.08004921
   0.006285  ]
 [ 0.34566772 -0.0633857   0.25301737 ...  0.30142316 -0.05512619
  -0.00506764]
 ...
 [-0.0876745   0.3446312   0.03313578 ...  0.05519462 -0.0577137
  -0.01112463]
 [ 0.1877002   0.33102342 -0.4901831  ... -0.0799901   0.01418441
   0.05539627]
 [ 0.2548247  -0.18743555 -0.37670818 ...  0.00569417  0.02134142
   0.02781577]]

[-1.6911887e-01 -3.4918064e-01  1.9558465e-01 -4.5544493e-01
  4.7486904e-01 -3.3227214e-01  2.1488710e-01 -5.8749840e-02
  1.2460944e-01  5.0036383e-01  1.5367343e-01  6.5077972e-01
 -2.4798784e-01  1.4433086e-02 -1.3159281e+00 -1.3720943e-02
 -1.0442466e-01 -6.1730362e-02  1.8927428e-01  4.1903576e-01
  2.9571904e-02 -2.4619712e-01 -1.3925085e-02 -5.9977227e-01
  1.3483679e-01  1.0517288e+00  7.8891911e-02 -4.1477486e-01
  3.0769923e-01  3.3382255e-01  4.5528087e-01 -1.8634582e-01
  3.1998938e-01 -5.0834382e-01  4.1803372e-01  8.2532668e-01
  8.7870079e-01 -1.1429504e+00 -1.8462010e-02  8.5367560e-01
  2.0756134e-01  1.6368373e-01 -4.6707502e-01 -3.7239072e-01
 -2.8211114e-01 -5.5612826e-01 -2.3886025e-02  5.1450598e-01
 -2.7210164e-01  2.1932077e-02  4.2665595e-01 -2.8750202e-01
 -2.0327836e-03 -7.6834607e-01  5.1970661e-01 -6.1653536e-02
 -8.0510950e-01 -6.2364161e-01  4.1388053e-01  2.0623486e-01
  3.1912440e-01 -1.9214762e-02  6.2937617e-01  8.4914082e-01
 -2.0189976e-02 -3.2738793e-01  3.1955665e-01  1.1185212e+00
 -3.1479022e-01 -8.3813317e-02 -3.0032894e-01 -3.6098793e-01
 -7.1653664e-02 -2.2241031e-01  7.3396748e-01  1.6272402e-01
 -1.2015642e+00 -2.2134010e-02 -1.1466295e-02  1.4347316e-01
 -1.7702129e-02 -1.8359210e-02 -4.5918614e-01  1.3752577e-01
 -2.4327911e-01 -1.7188646e-01 -1.1675137e-01  4.4381696e-01
  1.0399188e+00 -4.3765780e-02  8.3557022e-01 -2.2464299e-01
  6.5464711e-01 -7.1860421e-01  3.1611377e-01 -3.1073039e-02
  2.5930515e-01 -2.8395638e-01  3.2504788e-01  1.6914999e-01
 -2.6739544e-01 -6.0218424e-01  3.6746770e-01  1.1226840e+00
  1.7656893e-01  4.7021908e-01 -1.6000222e-02 -3.0497193e-02
 -6.6122228e-01  5.2563494e-01  9.0029490e-01  6.7673796e-01
  2.2700654e-01  1.3380671e-01 -1.3274834e+00  4.1836599e-01
 -4.8098662e-01  6.2206380e-02 -1.1017120e+00 -2.1523687e-01
 -2.5742593e-01 -6.4671983e-04  7.8876400e-01 -8.5538626e-02
 -4.3609399e-02  1.8885627e-01 -3.1031001e-02 -2.3948159e-02]

[[ 0.40634754  0.237382   -1.6494951  ... -0.6509423  -0.8389466
  -0.79550797]
 [-0.39555705 -0.9017762  -0.12748379 ...  0.14857675 -0.54642624
   0.29147837]
 [ 0.20847468 -0.8011649  -0.13038036 ...  0.09063356  0.28145838
  -0.38188866]
 ...
 [-0.02344229 -0.33688042 -0.5074646  ... -0.34723854 -0.7737513
   0.2418588 ]
 [-0.40663987  0.19812837 -0.06140856 ... -0.899044   -0.24643438
   0.32605115]
 [-0.15592235  0.07972852 -0.07222243 ... -0.13903831 -0.06680357
  -0.15477449]]

[ 0.05740546 -0.58758414  0.38351485  0.48760998 -0.9588584   0.38009804
  0.6053499   0.4120957  -0.43066877 -0.81629384]

</pre></div></div>
</div>
</div>
<div class="section" id="id1">
<h2>layers.Flatten<a class="headerlink" href="#id1" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La capa Flatten reduce en una dimensión</span>
<span class="c1"># la matriz de entrada</span>
<span class="c1">#</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tf.Tensor(
[[[-0.4270496   0.8546165  -0.915294    0.18522698]
  [ 0.48010978 -0.9742474   2.1991127  -1.73109   ]
  [-0.9760065  -0.44511214 -0.10575983 -0.16348962]]

 [[-2.7204921   0.17539988  0.34260908 -0.03656885]
  [-0.4669986   0.4891883   0.99962205 -0.17711908]
  [ 0.5307809  -1.6345141  -0.07257386  0.16114573]]], shape=(2, 3, 4), dtype=float32)

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;tf.Tensor: shape=(2, 12), dtype=float32, numpy=
array([[-0.4270496 ,  0.8546165 , -0.915294  ,  0.18522698,  0.48010978,
        -0.9742474 ,  2.1991127 , -1.73109   , -0.9760065 , -0.44511214,
        -0.10575983, -0.16348962],
       [-2.7204921 ,  0.17539988,  0.34260908, -0.03656885, -0.4669986 ,
         0.4891883 ,  0.99962205, -0.17711908,  0.5307809 , -1.6345141 ,
        -0.07257386,  0.16114573]], dtype=float32)&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Dimensiones de la salida de una capa Flatten</span>
<span class="c1">#</span>
<span class="n">demo_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">output_shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(None, 6)
</pre></div></div>
</div>
</div>
<div class="section" id="id2">
<h2>layers.Dense<a class="headerlink" href="#id2" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Dense: es una capa que conecta todas las entradas</span>
<span class="c1"># a todas las neuronas de la capa</span>
<span class="c1">#</span>
<span class="n">demo_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
    <span class="n">units</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># Si es None se usa Linear(x) = x</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,)),</span>
<span class="p">)</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">output_shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(None, 3)
</pre></div></div>
</div>
</div>
<div class="section" id="id3">
<h2>Activation<a class="headerlink" href="#id3" title="Enlazar permanentemente con este título">¶</a></h2>
</div>
<div class="section" id="id4">
<h2>Ejemplo de propagación de una señal<a class="headerlink" href="#id4" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Propagación de la señal</span>
<span class="c1">#</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;tf.Tensor: shape=(4, 2), dtype=float32, numpy=
array([[ 0.969842  , -0.19406092],
       [ 0.19163257, -1.3428361 ],
       [ 0.9864094 , -0.3945195 ],
       [ 0.7133747 ,  0.16916767]], dtype=float32)&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">demo_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential_4&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
dense_5 (Dense)              (None, 3)                 9
=================================================================
Total params: 9
Trainable params: 9
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Capa de entrada --&gt; capa salida</span>
<span class="c1">#</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[-0.13449496, -0.98086685, -0.27002883],
       [ 0.17411089, -1.0416323 ,  0.21957982]], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Bias capa de salida</span>
<span class="c1">#</span>
<span class="n">demo_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0., 0., 0.], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">demo_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[-0.16422698, -0.74914575, -0.30449718],
       [-0.25957602,  1.2107755 , -0.34660602],
       [-0.20135725, -0.5565921 , -0.3529875 ],
       [-0.06649137, -0.8759361 , -0.15548591]], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Primer patron de entrada a la primera neurona oculta</span>
<span class="c1">#</span>
<span class="c1">#       x1 *         w1 +         x2 *        w2 + w0</span>
<span class="mf">0.34032142</span> <span class="o">*</span> <span class="mf">0.98092103</span> <span class="o">+</span> <span class="o">-</span><span class="mf">0.2889726</span> <span class="o">*</span> <span class="mf">0.3135172</span> <span class="o">+</span> <span class="mf">0.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.24323055740874255
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Primer patrón de entrada a la segunda neurona oculta</span>
<span class="c1">#</span>
<span class="c1">#       x1 *         w1 +         x2 *         w2 + w0</span>
<span class="mf">0.34032142</span> <span class="o">*</span> <span class="mf">0.86922000</span> <span class="o">+</span> <span class="o">-</span><span class="mf">0.2889726</span> <span class="o">*</span> <span class="mf">0.57068133</span> <span class="o">+</span> <span class="mf">0.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.130902916990842
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Derechos de autor 2019, Juan D. Velasquez.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>