

<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Módelos AR - MA - ARMA -ARIMA &mdash; documentación de --- Cursos --- - </title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="prev" title="Modelos ARIMA" href="2-10-arima.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Pregrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html">Redes Neuronales Artificiales y Algoritmos Bioinspirados</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Posgrado</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../analitica-de-grandes-datos/index.html">Analítica de Grandes Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ciencia-de-los-datos/index.html">Ciencia de los Datos Aplicada</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../analitica_avanzada/index.html">Analítica Avanzada</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-1">Semana 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-2">Semana 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-3">Semana 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-4">Semana 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-5">Semana 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-6">Semana 6</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-7">Semana 7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-8">Semana 8</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../analitica_avanzada/index.html">Analítica Avanzada</a> &raquo;</li>
        
      <li>Módelos AR - MA - ARMA -ARIMA</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/notebooks/timeseries/2-10-modelos-arima.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Módelos-AR---MA---ARMA--ARIMA">
<h1>Módelos AR - MA - ARMA -ARIMA<a class="headerlink" href="#Módelos-AR---MA---ARMA--ARIMA" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Notas de clase sobre los metodos ARMA en series de tiempo usando R</p>
<div class="line-block">
<div class="line"><strong>Juan David Velásquez Henao</strong></div>
<div class="line"><a class="reference external" href="mailto:jdvelasq&#37;&#52;&#48;unal&#46;edu&#46;co">jdvelasq<span>&#64;</span>unal<span>&#46;</span>edu<span>&#46;</span>co</a></div>
<div class="line">Universidad Nacional de Colombia, Sede Medellín</div>
<div class="line">Facultad de Minas</div>
<div class="line">Medellín, Colombia</div>
</div>
<p>[Licencia]</p>
<p>[Readme]</p>
<p><strong>Software utilizado</strong>.</p>
<blockquote>
<div><p>Este es un documento interactivo escrito como un notebook de <a class="reference external" href="http://jupyter.org">Jupyter</a>, en el cual se presenta un tutorial sobre la metodología Box-Jenkins en series de tiempo usando <strong>R</strong> en el contexto de la analítica. Los notebooks de Jupyter permiten incoporar simultáneamente código, texto, gráficos y ecuaciones. El código presentado en este notebook puede ejecutarse en los sistemas operativos Linux y OS X.</p>
</div></blockquote>
<blockquote>
<div><p>Haga click <a class="reference external" href="https://github.com/jdvelasq/guias-de-instalacion">aquí</a> para obtener instrucciones detalladas sobre como instalar Jupyter en Windows y Mac OS X.</p>
<p>Haga clic [aquí] para ver la última versión de este documento en nbviewer.</p>
</div></blockquote>
<blockquote>
<div><p>Descargue la última versión de este documento a su disco duro; luego, carguelo y ejecutelo en línea en <a class="reference external" href="https://try.jupyter.org">Try Jupyter!</a></p>
</div></blockquote>
<div class="section" id="Contenido">
<h2>Contenido<a class="headerlink" href="#Contenido" title="Enlazar permanentemente con este título">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="#Procesos-Autorregresivos-AR">Procesos Autorregresivos AR</a></p></li>
<li><p><a class="reference external" href="#Proceso-Autoregresivo-de-Orden-1">Proceso Autoregresivo de Orden 1</a></p></li>
<li><p><a class="reference external" href="#Simulacion-AR">Simulacion AR</a></p></li>
<li><p><a class="reference external" href="#Pronostico-con-proceso-AR">Pronostico con proceso AR</a></p></li>
<li><p><a class="reference external" href="#Serie-filtrada-AR">Serie filtrada AR</a></p></li>
<li><p><a class="reference external" href="#Estimación-proceso-AR">Estimación proceso AR</a></p></li>
<li><p><a class="reference external" href="#Calculo-de-los-residuales-del-modelo-AR">Calculo de los residuales del modelo AR</a></p></li>
<li><p><a class="reference external" href="#Diagnostico-de-los-residuales">Diagnostico de los residuales</a></p></li>
<li><p><a class="reference external" href="#Procesos-de-medias-moviles-MA">Procesos de medias moviles MA</a></p></li>
<li><p><a class="reference external" href="#Simulación-MA">Simulación MA</a></p></li>
<li><p><a class="reference external" href="#Pronostico-con-proceso-MA">Pronostico con proceso MA</a></p></li>
<li><p><a class="reference external" href="#Serie-filtrada-MA">Serie filtrada MA</a></p></li>
<li><p><a class="reference external" href="#Estimación-proceso-MA">Estimación proceso MA</a></p></li>
<li><p><a class="reference external" href="#Calculo-de-los-residuales-del-modelo-MA">Calculo de los residuales del modelo MA</a></p></li>
<li><p><a class="reference external" href="#Diagnostico-de-los-residuales-MA">Diagnostico de los residuales</a></p></li>
<li><p><a class="reference external" href="#Procesos-autorregresivos-de-media-movil-ARMA">Procesos autorregresivos de media movil ARMA</a></p></li>
<li><p><a class="reference external" href="#Simulación-de-un-proceso-ARMA">Simulación de un proceso ARMA</a></p></li>
<li><p><a class="reference external" href="#Estimacion-del-modelo-ARMA">Estimacion del modelo ARMA</a></p></li>
<li><p><a class="reference external" href="#Pronostico-del-modelo-ARMA">Pronostico del modelo ARMA</a></p></li>
<li><p><a class="reference external" href="#Prueba-de-Raiz-Unitaria-Dickey-Fuller">Prueba de Raiz Unitaria-Dickey-Fuller</a></p></li>
<li><p><a class="reference external" href="#Diferenciación-de-la-serie-de-tiempo">Diferenciación de la serie de tiempo</a></p></li>
<li><p><a class="reference external" href="#Proceso-autorregresivo-integrado-de-media-móvil-ARIMA">Proceso autorregresivo integrado de media móvil ARIMA</a></p></li>
<li><p><a class="reference external" href="#Simulación-proceso-ARIMA">Simulación proceso ARIMA</a></p></li>
<li><p><a class="reference external" href="#Estimacion-modelo-ARIMA">Estimacion modelo ARIMA</a></p></li>
<li><p><a class="reference external" href="#Pronostico-modelo-ARIMA">Pronostico modelo ARIMA</a></p></li>
</ul>
</div></blockquote>
<p><strong>Bibliografía</strong>.</p>
<blockquote>
<div><p><a class="reference external" href="Vinculo%20aquí">Bibliografia aquí</a></p>
</div></blockquote>
<hr class="docutils" />
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Cargue la siguiente librería</span>
<span class="n">library</span><span class="p">(</span><span class="n">forecast</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">tseries</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Loading required package: zoo

Attaching package: &#39;zoo&#39;

The following objects are masked from &#39;package:base&#39;:

    as.Date, as.Date.numeric

Loading required package: timeDate
This is forecast 7.1

</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Procesos-Autorregresivos-AR">
<h1>Procesos Autorregresivos AR<a class="headerlink" href="#Procesos-Autorregresivos-AR" title="Enlazar permanentemente con este título">¶</a></h1>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<p>Un proceso autorregresivo es un ejemplo de un paseo aleatorio, en este tipo de procesos los datos futuros dependen linealmente de los datos historicos. El modelo se define como:</p>
<div class="math notranslate nohighlight">
\[Y_t = C + \sum_{i=1}^p \phi_1 Y_{t-i} + \epsilon_t\]</div>
<p>Donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C\)</span>: Es una constante</p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_1,...,\phi_p\)</span>: Son los parametros del modelo.</p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon_t\)</span>: Es ruido blanco.</p></li>
</ul>
<p>Note que la ecuación del modelo autorregresivo es un modelo de regresión lineal entre la serie <span class="math notranslate nohighlight">\(Y_t\)</span> y sus valores pasados o rezagados. Por lo cual recibe el nombre de autorregresivo.</p>
<p>Una notación utiliza es el operador rezago <span class="math notranslate nohighlight">\(B^j\)</span> es el cual al aplicarse a la serie de tiempo <span class="math notranslate nohighlight">\(Y_t\)</span> produce una serie de tiempo de valores rezagados o también llamados retardos <span class="math notranslate nohighlight">\(j\)</span> unidades en el tiempo. Se puede expresar como:</p>
<div class="math notranslate nohighlight">
\[B^j Y_t=Y_{t-j}\]</div>
<p>Donde un polimnomio de rezagos <span class="math notranslate nohighlight">\(j\)</span> es el que corresponde a la siguiente expresión:</p>
<div class="math notranslate nohighlight">
\[\phi_j(B) = 1 + \phi_1B + \phi_2B^2 + ... + \phi_jB^j\]</div>
<p>Al aplicar <span class="math notranslate nohighlight">\(\phi_j(B)\)</span> sobre la serie <span class="math notranslate nohighlight">\(Y_t\)</span> se obtiene:</p>
<div class="math notranslate nohighlight">
\[\phi_j(B) Y_t = Y_t + \phi_1Y_{t-1} + \phi_2Y_{t-2}+...+ \phi_jY_{t-j}\]</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Simulación de un proceso AR(1)</span>

<span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="n">rep</span><span class="p">(</span><span class="n">NA</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span>                 <span class="c1"># Vector donde se almacenan los datos</span>

<span class="n">inicio</span> <span class="o">&lt;-</span> <span class="mi">5</span>                        <span class="c1"># Valor de inicio del proceso</span>
<span class="n">phi</span><span class="o">&lt;-</span><span class="mf">0.8</span>                           <span class="c1"># Parametro phi de la ecuación</span>
<span class="n">et</span> <span class="o">&lt;-</span> <span class="n">rnorm</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                <span class="c1"># Error asociado al proceso</span>
<span class="n">sigma</span><span class="o">&lt;-</span> <span class="mf">1.5</span>                        <span class="c1"># Valor sigma para error</span>
<span class="n">yt</span><span class="o">&lt;-</span><span class="n">et</span><span class="o">*</span><span class="n">sigma</span>                       <span class="c1"># Actualización de error</span>

<span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">inicio</span>                     <span class="c1"># Asignación valor incial de la serie</span>


<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">2</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">{</span>           <span class="c1"># Inicia en 2 porque necesita valor anterior</span>

  <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">phi</span> <span class="o">+</span> <span class="n">yt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>        <span class="c1"># Formula del proceso</span>

<span class="p">}</span>

<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">ts</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">ts</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>            <span class="c1"># Datos de la serie de tiempo</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>     <span class="c1"># tipo de gráfico: o - overplotted</span>
        <span class="n">pch</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>       <span class="c1"># tipo de marcador de los puntos)</span>

<span class="n">grid</span><span class="p">()</span>                <span class="c1"># Agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_13_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_13_0.png" />
</div>
</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<p>En este proceso de orden 1, la variable <span class="math notranslate nohighlight">\(Y_t\)</span> depende del valor rezagado <span class="math notranslate nohighlight">\(Y_{t-1}\)</span>.</p>
<div class="math notranslate nohighlight">
\[Y_t= \phi Y_{t-1} + \epsilon_t\]</div>
<p>Un proceso estocastico es estacionario si su media y varianza son constantes en el tiempo, estos modelos autorregresivos deben ser estacionarios.</p>
<p>Para verificar que el proceso <span class="math notranslate nohighlight">\(AR(1)\)</span> es estacionario se debe satisfacer lo siguiente:</p>
<ul class="simple">
<li><ol class="loweralpha simple">
<li><p><strong>Estacionario en media</strong></p></li>
</ol>
</li>
</ul>
<div class="math notranslate nohighlight">
\[E(Y_t) = E( Y_t = \phi Y_{t-1} + \epsilon_t ) = \phi E(Y_{t-1})\]</div>
<p>Para que el proceso sea estacionario la media debe ser constante en el tiempo, por tanto:</p>
<p><div class="math notranslate nohighlight">
\[E(Y_t) =  \phi E(Y_{t-1})\]</div>
</p><p><div class="math notranslate nohighlight">
\[(1-\phi) E(Y_t) = 0\]</div>
</p><p><div class="math notranslate nohighlight">
\[E(Y_t) =  \frac {0} {1-\phi}\]</div>
</p><p>De esta manera, para que el proceso sea estacionario <span class="math notranslate nohighlight">\(\phi \neq 0\)</span></p>
<ul class="simple">
<li><ol class="loweralpha simple" start="2">
<li><p><strong>Estacionario en covarianza</strong></p></li>
</ol>
</li>
</ul>
<p>Para que el proceso <span class="math notranslate nohighlight">\(AR(1)\)</span> sea estacionario, la varianza debe ser constante en el tiempo, por tanto:</p>
<div class="math notranslate nohighlight">
\[\gamma_0 = E( Y_t - E(Y_{t-1}))^2 = E(\phi Y_{t-1} + \epsilon_t - 0)^2 = \phi^2 V(Y_{t-1}) + \sigma^2\]</div>
<p>Dada la autocorrelación del proceso:</p>
<div class="math notranslate nohighlight">
\[E(Y_{t-1} \epsilon_t ) = E[(Y_{t-1}-0)(\epsilon_t - 0)] = cov(Y_{t-1} \epsilon_t) = 0\]</div>
<p>Teniendo en cuenta que el proceso es estacionario:</p>
<div class="math notranslate nohighlight">
\[E(Y_{t-1})^2 = V(Y_{t-1}) = V(Y_t)= \gamma_0\]</div>
<p>Luego se tiene que:</p>
<p>$ <span class="math">\gamma</span>_0 = <span class="math">\phi `:nbsphinx-math:</span>gamma`_0 + :nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>sigma`^2 $</p>
<p>Entonces:</p>
<div class="math notranslate nohighlight">
\[\gamma_0 = \frac {\sigma^2}{1-\phi^2}\]</div>
<p>Para que el proceso sea estacionario con varianza constante en el tiempo, resulta necesario que <span class="math notranslate nohighlight">\(|\phi| &lt; 1\)</span></p>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<p>Sea la serie de tiempo <span class="math notranslate nohighlight">\(Y_t\)</span> en un tiempo <span class="math notranslate nohighlight">\(t\)</span></p>
<div class="math notranslate nohighlight">
\[Y_t = \phi_0 + \phi_1 Y_{t-1} + \epsilon_t\]</div>
<p></p>
<div class="math notranslate nohighlight">
\[\epsilon_t \sim N(0,\sigma^2)\]</div>
<p>Entonces:</p>
<p><span class="math notranslate nohighlight">\(Y_t \sim N(\mu = \phi_0 + \phi_1 Y_{t-1} ,\sigma^2)\)</span></p>
<p>Para realizar el pronóstico <span class="math notranslate nohighlight">\(Y_{t+1}\)</span> se puede escribir como:</p>
<div class="math notranslate nohighlight">
\[Y_{t+1} = \phi_0 + \phi_1 Y_t + \epsilon_{t+1}\]</div>
<p></p>
<div class="math notranslate nohighlight">
\[\epsilon_{t+1} \sim N(0,\sigma^2)\]</div>
<p>Donde $Y_t = <span class="math">\phi</span>_0 + <span class="math">\phi</span><em>1 Y</em>{t-1} + <span class="math">\epsilon</span>_t $, entonces:</p>
<div class="math notranslate nohighlight">
\[Y_{t+1} = \phi_0 + \phi_1 [\phi_0 + \phi_1 Y_{t-1} + \epsilon_t] + \epsilon_{t+1}\]</div>
<p>Teniendo en cuenta que:</p>
<p><p><span class="math notranslate nohighlight">\(Y_t \sim N(\mu = \phi_0 + \phi_1 Y_{t-1} \sigma^2)\)</span></p>
</p><p><p><span class="math notranslate nohighlight">\(\epsilon_{t+1} \sim N(0,\sigma^2)\)</span></p>
</p><p>El valor <span class="math notranslate nohighlight">\(Y_{t+1}\)</span> es una suma de Normales <span class="math notranslate nohighlight">\(N(\mu_1, \sigma_1^2)\)</span> y <span class="math notranslate nohighlight">\(N(\mu_2, \sigma_2^2)\)</span>. Por lo cual:</p>
<div class="math notranslate nohighlight">
\[Y_{t+1} \sim N(\mu_1+ \mu_2,\sigma_1^2 + \sigma_2^2)\]</div>
<p><img alt="dddaba75015a4fad9caf3aceed968c6c" class="no-scaled-link" src="notebooks/timeseries/images/pron-ar.PNG" style="width: 600px;" /></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Pronóstico de la serie</span>
<span class="c1">## Un periodo adelante</span>
<span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">099</span><span class="p">)</span>

<span class="n">et</span><span class="o">.</span><span class="k">for</span> <span class="o">&lt;-</span> <span class="n">rnorm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                    <span class="c1"># Error asociado a E(t+1)</span>
<span class="n">x</span><span class="o">.</span><span class="k">for</span> <span class="o">&lt;-</span> <span class="n">x</span><span class="p">[</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">*</span><span class="n">phi</span> <span class="o">+</span> <span class="n">et</span><span class="o">.</span><span class="k">for</span>    <span class="c1"># Ultimo dato de la serie * Parametro Phi</span>

<span class="n">x</span><span class="o">.</span><span class="k">for</span>


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
0.45806044588985</div>
</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<p>El filtrado de la serie se expresa como</p>
<div class="math notranslate nohighlight">
\[Y_t - \phi Y_{t-1} =  \epsilon_t\]</div>
<p>Donde la serie filtrada resulta ser el error del proceso.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Filtrado de la serie</span>

<span class="n">xf</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="n">rep</span><span class="p">(</span><span class="n">NA</span><span class="p">,</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>    <span class="c1"># Vector donde se almacenan serie filtrada</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">2</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">{</span>

  <span class="n">xf</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">phi</span>

<span class="p">}</span>

<span class="n">xf</span> <span class="o">&lt;-</span> <span class="n">ts</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span>
         <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">ts</span><span class="p">(</span><span class="n">xf</span><span class="p">)</span>         <span class="c1"># Gráfica del serie filtarada</span>

<span class="n">grid</span><span class="p">()</span>              <span class="c1"># Agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_25_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_25_0.png" />
</div>
</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`ar.ols</span> <span class="pre">{stats}</span></code> &lt;<a class="reference external" href="https://stat.ethz.ch/R-manual/R-patched/library/stats/html/ar.ols.html">https://stat.ethz.ch/R-manual/R-patched/library/stats/html/ar.ols.html</a>&gt;`__</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">ar.ols</span></code> estima un modelo autorregresivo por el metodo de minimos cuadrados ordinarios (<em>ols</em> por sus siglas en ingles)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Estimacion ar.ols</span>

<span class="n">ar</span> <span class="o">&lt;-</span> <span class="n">ar</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>            <span class="c1"># Datos a modelar</span>
           <span class="n">aic</span> <span class="o">=</span> <span class="n">T</span><span class="p">,</span>        <span class="c1"># Criterio AIC</span>
           <span class="n">order</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Proceso maximo AR(1)</span>
           <span class="n">intercept</span> <span class="o">=</span> <span class="n">F</span><span class="p">,</span>  <span class="c1"># Intercepto falso</span>
           <span class="n">demean</span> <span class="o">=</span> <span class="n">F</span><span class="p">)</span>     <span class="c1"># Omite un valor medio que automaticamente calcula ar.ols</span>
<span class="n">ar</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Call:
ar.ols(x = x, aic = T, order.max = 1, demean = F, intercept = F)

Coefficients:
     1
0.8175

Order selected 1  sigma^2 estimated as  1.915
</pre></div></div>
</div>
<p>La estimación del parametro <span class="math notranslate nohighlight">\(\phi\)</span> del proceso <span class="math notranslate nohighlight">\(AR(1)\)</span> por medio de la función <code class="docutils literal notranslate"><span class="pre">ar-ols</span></code> fue de <span class="math notranslate nohighlight">\(\phi = 0.8175\)</span> y el parametro <span class="math notranslate nohighlight">\(\phi\)</span> real con el que se simulo la serie fue de <span class="math notranslate nohighlight">\(\phi= 0.8\)</span>.</p>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Convierta el siguiente conjunto de datos en un objeto <code class="docutils literal notranslate"><span class="pre">ts</span></code> y ajuste un modelo AR(p) para los primeros 48 datos de la serie. Deje 2 para pronóstico.</p>
x <- c ( 0.74,  -0.67, -0.65,  1.16,
        0.60,   2.68,  1.26,  0.00,
        0.13,   0.47,  0.72,  0.41,
        -1.44, -2.25, -1.84,  0.23,
        1.51,   0.62, -1.22, -1.03,
        -1.05,  0.44, -0.37, -0.73,
        0.92,  -0.39, -1.35, -0.19,
        0.65,  -0.68, -1.14,  0.34,
        2.00,   1.90,  0.98,  0.69,
        -0.64, -2.03, -2.88, -2.17,
        0.41,   2.15,  1.38,  1.03,
        0.97,   0.90,  0.50,  0.27,
        -0.64, -0.89)<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p><strong>Ejercicio.–</strong> Presente cuales son los coeficientes estimados.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p><strong>Ejercicio.–</strong> Escriba la ecuación general del proceso AR(p) que ajustó con los coeficiente estimados</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<p>Para calcular los valores ajustados del modelo autorregresivo que se obtuvo anteriormente, se puede realizar de manera manual o por medio de la función <code class="docutils literal notranslate"><span class="pre">fitted</span></code> como se presenta a continuación:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`fitted{forecast}</span></code> &lt;<a class="reference external" href="https://cran.r-project.org/web/packages/forecast/forecast.pdf">https://cran.r-project.org/web/packages/forecast/forecast.pdf</a>&gt;`__</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>## Valores ajustados del modelo - manual

x.fit &lt;- rep(NA,50)               # Vector valores ajustados
x.fit[1] &lt;- x[1]                  # Primer valor ajustado

for (i in 2:length(x.fit)) {

  x.fit[i] = ar$ar * x[i-1]       # Dato * Parametro phi estimado

}
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Tambien puede calcular los valores</span>
<span class="c1">## ajustados del modelo así:</span>

<span class="n">x</span><span class="o">.</span><span class="n">fit2</span> <span class="o">&lt;-</span> <span class="n">fitted</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span>   <span class="c1"># Fitted extrae los valores ajustados</span>

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Gráfica valores ajustados vs reales</span>

<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>                                                   <span class="c1"># Datos serie real</span>
     <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>                                            <span class="c1"># tipo de gráfico: o - overplotted</span>
     <span class="n">lwd</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>                                               <span class="c1"># Grosor de linea</span>
     <span class="n">col</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>                                         <span class="c1"># Color de linea</span>
     <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>                                        <span class="c1"># Limites eje y</span>

<span class="n">lines</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>


<span class="n">legend</span><span class="p">(</span> <span class="s2">&quot;topright&quot;</span><span class="p">,</span>                                        <span class="c1"># posicion</span>
        <span class="n">c</span><span class="p">(</span><span class="s2">&quot;Serie Real&quot;</span><span class="p">,</span> <span class="s2">&quot;Valores Ajust. MA&quot;</span><span class="p">),</span>              <span class="c1"># texto</span>
        <span class="n">lwd</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>                                   <span class="c1"># grosor lineas</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">),</span>                           <span class="c1"># color lineas</span>
        <span class="n">bty</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span><span class="p">)</span>                                         <span class="c1"># caja alrededor de la leyenda</span>



<span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_45_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_45_0.png" />
</div>
</div>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Realice la gráfica de ajuste vs datos reales</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p><strong>Ejercicio.–</strong> Realice el pronóstico del modelo para 2 periodos hacia adelante utilizando la ecuación de pronóstico del proceso autorregresivo utilizando el <span class="math notranslate nohighlight">\(\phi\)</span> que le dio la estimación.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Metodo 1. Manual</span>
<span class="n">r1</span> <span class="o">&lt;-</span> <span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">fit</span>
</pre></div>
</div>
</div>
<p>El modelo ajustado por medio de la función <code class="docutils literal notranslate"><span class="pre">ar.ols</span></code> y asignado a la variable “ar” tienen varios parametros internos. Para poder ver cual es la estructura interna y su composición utilice <code class="docutils literal notranslate"><span class="pre">str(</span> <span class="pre">)</span></code>. Los residuales del modelo ya estan calculados internamente y se calculan:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>## Metodo 2. Automatico
r2 &lt;- ar$resid                # El modelo ajusto contiene los residuales
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Comparación</span>

<span class="n">head</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
<span class="n">head</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ol class=list-inline>
    <li>0</li>
    <li>-0.432817590796809</li>
    <li>2.27406709140315</li>
    <li>0.0136261750593425</li>
    <li>0.118370541483725</li>
    <li>2.50875283633833</li>
</ol></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ol class=list-inline>
    <li>NA</li>
    <li>-0.432817590796808</li>
    <li>2.27406709140315</li>
    <li>0.0136261750593416</li>
    <li>0.118370541483725</li>
    <li>2.50875283633833</li>
</ol></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Gráfica de los residuales</span>
<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span>                                                <span class="c1"># Datos residuales 1</span>
     <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>                                          <span class="c1"># tipo de gráfico: o - overplotted</span>
     <span class="n">lwd</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>                                             <span class="c1"># Grosor de linea</span>
     <span class="n">col</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>                                        <span class="c1"># Color de linea</span>
     <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>                                      <span class="c1"># Limites eje y</span>

<span class="n">lines</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>


<span class="n">legend</span><span class="p">(</span> <span class="s2">&quot;topleft&quot;</span><span class="p">,</span>                                       <span class="c1"># posicion</span>
        <span class="n">c</span><span class="p">(</span><span class="s2">&quot;Residulaes r1&quot;</span><span class="p">,</span> <span class="s2">&quot;Residuales r2&quot;</span><span class="p">),</span>             <span class="c1"># texto</span>
        <span class="n">lwd</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>                                   <span class="c1"># grosor lineas</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">),</span>                          <span class="c1"># color lineas</span>
        <span class="n">bty</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span><span class="p">)</span>                                       <span class="c1"># caja alrededor de la leyenda</span>

<span class="n">abline</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>                                  <span class="c1"># Linea en 0</span>

<span class="n">grid</span><span class="p">()</span>                                                   <span class="c1"># Agrega malla.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_57_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_57_0.png" />
</div>
</div>
<p>Los residuales calculados por cada metodo <code class="docutils literal notranslate"><span class="pre">r1</span></code> y <code class="docutils literal notranslate"><span class="pre">r2</span></code> son exactamente los mismos. Se realizó por ambos metodos con el fin de explicar la metodología que se utiliza. En adelante para el diagnostico, se trabajará con r1.</p>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Densidad</span>

<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">density</span><span class="p">(</span><span class="n">r1</span><span class="p">),</span>                   <span class="c1"># Densidad residuales</span>
     <span class="n">main</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>                       <span class="c1"># Sin titulo</span>
     <span class="n">xlab</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>                       <span class="c1"># Sin nombre eje x</span>
     <span class="n">lwd</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>                         <span class="c1"># Grosor de linea</span>
<span class="n">grid</span><span class="p">()</span>                              <span class="c1"># agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_61_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_61_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Prueba ACF</span>
<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">acf</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span>
    <span class="n">na</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">na</span><span class="o">.</span><span class="k">pass</span><span class="p">,</span>    <span class="c1"># Funcion para valores faltantes</span>
    <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>           <span class="c1"># Limites eje y</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_62_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_62_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Prueba PACF</span>
<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">pacf1</span> <span class="o">&lt;-</span> <span class="n">pacf</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span>
             <span class="n">na</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">na</span><span class="o">.</span><span class="k">pass</span><span class="p">,</span>   <span class="c1"># Funcion para valores faltantes</span>
             <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>          <span class="c1"># Limites eje y</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_63_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_63_0.png" />
</div>
</div>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Realice el diagnostico para los residuales del modelo que ajusto para la serie x.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</div>
<div class="section" id="Procesos-de-medias-moviles-MA">
<h1>Procesos de medias moviles MA<a class="headerlink" href="#Procesos-de-medias-moviles-MA" title="Enlazar permanentemente con este título">¶</a></h1>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<p>El modelo de medias moviles se define como:</p>
<div class="math notranslate nohighlight">
\[Y_t = \theta_0 + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} +...+ \theta_1 \epsilon_{t-q} - \epsilon_t\]</div>
<p>Donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\theta_0\)</span>: Es una constante</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta_1,...,\theta_q\)</span>: Son los parametros del modelo.</p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon_t\)</span>: Es ruido blanco.</p></li>
</ul>
<ol class="loweralpha simple">
<li><p>Estacionario en media</p></li>
</ol>
<p><div class="math notranslate nohighlight">
\[E(Y_t) = E(\epsilon_t + \theta \epsilon_{t-q})\]</div>
</p><p><div class="math notranslate nohighlight">
\[E(Y_t) = E(\epsilon_t)+ \theta E(\epsilon_{t-q})\]</div>
</p><p><div class="math notranslate nohighlight">
\[E(Y_t) = 0\]</div>
</p><p>Es estacionario en media para todo valor del parametro <span class="math notranslate nohighlight">\(\theta\)</span></p>
<ol class="loweralpha simple" start="2">
<li><p>Estacionario en covarianza</p></li>
</ol>
<p><div class="math notranslate nohighlight">
\[\gamma_0 = E(Y_t - E(Y_t))^2 = E(Y_t)^2 = E(\epsilon_t - \theta \epsilon_{t-1})^2\]</div>
</p><p><div class="math notranslate nohighlight">
\[\gamma_0 = E(\epsilon_t)^2 + \theta^2 (\epsilon_{t-1})^2 - 2\theta  E(\epsilon_t  \epsilon_{t-1})= \sigma^2 + \theta^2 \sigma^2 - 0\]</div>
</p><p><div class="math notranslate nohighlight">
\[\gamma_0 = (1+\theta^2) \sigma^2 &lt; \infty\]</div>
</p><p><a class="reference external" href="#Contenido">Contenido</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Simulacion de un proceso MA</span>
<span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>

<span class="n">y</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="n">rep</span><span class="p">(</span><span class="n">NA</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span>                          <span class="c1"># Vector donde se almacenan los datos</span>


<span class="n">et</span> <span class="o">&lt;-</span> <span class="n">rnorm</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                         <span class="c1"># Error asociado al proceso</span>
<span class="n">sigma</span> <span class="o">&lt;-</span> <span class="mf">1.5</span>                                <span class="c1"># Valor sigma para error</span>
<span class="n">et</span> <span class="o">&lt;-</span> <span class="n">et</span><span class="o">*</span><span class="n">sigma</span>                              <span class="c1"># Actualizacion error</span>
<span class="n">theta</span> <span class="o">&lt;-</span> <span class="mf">0.9</span>                                <span class="c1"># Valor Theta</span>
<span class="n">const</span> <span class="o">&lt;-</span> <span class="mi">0</span>                                  <span class="c1"># Constante</span>

<span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">et</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                               <span class="c1"># Asignacion valor inicial de la serie</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">2</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="p">{</span>

  <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">const</span><span class="o">+</span><span class="n">et</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">theta</span> <span class="o">+</span> <span class="n">et</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>       <span class="c1"># Formula del proceso</span>

<span class="p">}</span>

<span class="n">y</span> <span class="o">&lt;-</span> <span class="n">ts</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">ts</span><span class="p">(</span><span class="n">y</span><span class="p">,</span>
       <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>     <span class="c1"># tipo de gráfico: o - overplotted</span>
       <span class="n">pch</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>       <span class="c1"># tipo de marcador de los puntos</span>

<span class="n">grid</span><span class="p">()</span>               <span class="c1"># Agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_74_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_74_0.png" />
</div>
</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<div class="math notranslate nohighlight">
\[Y_t = \phi_0 + \phi_1 e_{t-1} + e_t\]</div>
<p></p>
<div class="math notranslate nohighlight">
\[e_t \sim \sigma \epsilon_t\]</div>
<div class="math notranslate nohighlight">
\[\epsilon_t \sim N(0,1)\]</div>
<p>.</p>
<p>Donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y_t\)</span> = Ultimo valor conocido de la serie</p></li>
<li><p>$e_t $ = Último valor de ruido conocido.</p></li>
</ul>
<p>Suponga <span class="math notranslate nohighlight">\(\phi_0 = 0\)</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y_0\)</span> = <span class="math notranslate nohighlight">\(e_t\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(Y_1\)</span> = <span class="math notranslate nohighlight">\(\phi_1 e_0 + e_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(Y_2\)</span> = <span class="math notranslate nohighlight">\(\phi_1 e_1 + e_2\)</span></p></li>
</ul>
<p>Ahora que será <span class="math notranslate nohighlight">\(Y_{t+1}\)</span></p>
<div class="math notranslate nohighlight">
\[Y_{t+1}= \phi_0 + \phi_1 e_t + e_{t+1}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y_{t+2}\)</span>=<span class="math notranslate nohighlight">\(\phi_0 + \phi_1 e_{t+1} + e_{t+2}\)</span> , pero <span class="math notranslate nohighlight">\(e_{t+1}=0\)</span> , entonces <span class="math notranslate nohighlight">\(Y_{t+2}\)</span> queda:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Y_{t+2} = \phi_0 + e_{t+2}\]</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Serie filtrada</span>

<span class="n">yf</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="n">rep</span><span class="p">(</span><span class="n">NA</span><span class="p">,</span><span class="n">length</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>    <span class="c1"># Vector donde se almacenan serie filtrada</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">2</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="p">{</span>

  <span class="n">yf</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">et</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="p">}</span>

<span class="n">yf</span> <span class="o">&lt;-</span> <span class="n">ts</span><span class="p">(</span><span class="n">yf</span><span class="p">,</span><span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Grafica</span>
<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">ts</span><span class="p">(</span><span class="n">yf</span><span class="p">)</span>         <span class="c1"># Gráfica del proceso</span>
<span class="n">grid</span><span class="p">()</span>              <span class="c1"># Agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_81_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_81_0.png" />
</div>
</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`arima{stats}</span></code> &lt;<a class="reference external" href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/arima.html">https://stat.ethz.ch/R-manual/R-devel/library/stats/html/arima.html</a>&gt;`__</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ma</span> <span class="o">&lt;-</span> <span class="n">arima</span><span class="p">(</span><span class="n">y</span><span class="p">,</span>
          <span class="n">order</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>   <span class="c1"># (0,0,1) es un proceso MA(1)</span>
          <span class="n">include</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">F</span><span class="p">)</span>
<span class="n">ma</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Call:
arima(x = y, order = c(0, 0, 1), include.mean = F)

Coefficients:
         ma1
      0.7792
s.e.  0.1682

sigma^2 estimated as 1.392:  log likelihood = -79.69,  aic = 163.38
</pre></div></div>
</div>
<p>En la presentación de los resultados de la estimación del modelo, el termino <code class="docutils literal notranslate"><span class="pre">s.e</span></code> significa error estandar y se refiere a una estimación de la desviación estandar.</p>
<div class="math notranslate nohighlight">
\[SE_{\bar x} = \frac{s} {\sqrt n}\]</div>
<p>Donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s\)</span> = Desviación estandar de la media</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> = Número de observaciones</p></li>
</ul>
<p>El termino <code class="docutils literal notranslate"><span class="pre">aic</span></code> es el criterio de informacion de Akaike el cual es una medida para seleccionar el mejor modelo estadistico:</p>
<div class="math notranslate nohighlight">
\[AIC = 2k - 2ln(L)\]</div>
<p>Donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k\)</span>: Número de parametrós del modelo</p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span>: Valor máximo de la función de máxima verisimilitud para el modelo estimado.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Convierta el siguiente conjunto de datos en un objeto <code class="docutils literal notranslate"><span class="pre">ts</span></code> y ajuste un modelo MA(2) para la serie para los primeros 48 datos. Deje 2 para pronóstico.</p>
x <- c(  1.77,  -1.08, -2.46,  0.31,
        1.08,   1.40,  2.37,  1.97,
        -1.06, -1.53,  0.43, -0.91,
        0.12,   0.54, -2.13, -0.06,
        2.39,   1.10, -0.16, -1.68,
        -1.39,  0.51,  0.50, -1.49,
        0.50,   1.45, -0.23, -0.31,
        0.29,   1.84,  1.26, -1.12,
        -1.08, -1.62, -2.32, -0.45,
        -1.08, -2.42,  0.04,  0.54,
        -3.20, -2.52,  1.41,  0.67,
        -1.88, -0.27, -0.89, -3.05,
        -0.83,  1.01)<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p><strong>Ejercicio.–</strong> Presente cuales son los coeficientes estimados.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<p>Para calcular los valores ajustados del modelo de medias móviles se utilizará la función <code class="docutils literal notranslate"><span class="pre">fitted</span></code> como se presenta a continuación:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Valores ajustados del modelo</span>

<span class="n">y</span><span class="o">.</span><span class="n">fit</span> <span class="o">&lt;-</span> <span class="n">fitted</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Gráfica valores ajustados vs reales</span>

<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span>                                                   <span class="c1"># Datos serie real</span>
     <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>                                            <span class="c1"># tipo de gráfico: o - overplotted</span>
     <span class="n">lwd</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>                                               <span class="c1"># Grosor de linea</span>
     <span class="n">col</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>                                         <span class="c1"># Color de linea</span>
     <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>                                        <span class="c1"># Limites eje y</span>

<span class="n">lines</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>


<span class="n">legend</span><span class="p">(</span> <span class="s2">&quot;topright&quot;</span><span class="p">,</span>                                        <span class="c1"># posicion</span>
        <span class="n">c</span><span class="p">(</span><span class="s2">&quot;Serie Real&quot;</span><span class="p">,</span> <span class="s2">&quot;Valores Ajust. MA&quot;</span><span class="p">),</span>              <span class="c1"># texto</span>
        <span class="n">lwd</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>                                   <span class="c1"># grosor lineas</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">),</span>                           <span class="c1"># color lineas</span>
        <span class="n">bty</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span><span class="p">)</span>                                         <span class="c1"># caja alrededor de la leyenda</span>

<span class="n">grid</span><span class="p">()</span>                                                     <span class="c1"># Agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_96_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_96_0.png" />
</div>
</div>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Realice la gráfica de ajuste vs datos reales</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p><strong>Ejercicio.–</strong> Realice el pronóstico del modelo para 2 periodos hacia adelante utilizando la ecuación de pronóstico del proceso de medias moviles utilizando los <span class="math notranslate nohighlight">\(\theta\)</span> que le dio la estimacion.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<p>El modelo ajustado por medio de la función <code class="docutils literal notranslate"><span class="pre">arima</span></code> y asignado a la variable “ma” tienen varios parametros internos. Para poder ver cual es la estructura interna y su composición utilice <code class="docutils literal notranslate"><span class="pre">str(</span> <span class="pre">)</span></code>. Los residuales del modelo ya estan calculados internamente y se calculan:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>### Calculo residuales
r &lt;- ma$residuals
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Gráficas de los residuales</span>

<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span>                     <span class="c1"># Datos residuales</span>
     <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>              <span class="c1"># Tipo de gráfico: o - overplotted</span>
     <span class="n">lwd</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>               <span class="c1"># Grosor de linea</span>


<span class="n">abline</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>         <span class="c1"># Linea en 0</span>

<span class="n">grid</span><span class="p">()</span>                      <span class="c1"># Agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_107_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_107_0.png" />
</div>
</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Densidad</span>
<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">density</span><span class="p">(</span><span class="n">r</span><span class="p">),</span>       <span class="c1"># Densidad residuales</span>
     <span class="n">main</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>          <span class="c1"># Sin titulo</span>
     <span class="n">xlab</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>          <span class="c1"># Sin nombre eje x</span>
     <span class="n">lwd</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>            <span class="c1"># grosor de linea</span>
<span class="n">grid</span><span class="p">()</span>                 <span class="c1"># Agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_110_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_110_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Prueba ACF</span>
<span class="n">acf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span>
    <span class="n">na</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">na</span><span class="o">.</span><span class="k">pass</span><span class="p">,</span>    <span class="c1"># Funcion para valores faltantes</span>
    <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>           <span class="c1"># Limite eje y</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_111_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_111_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Prueba PACF</span>
<span class="n">pacf1</span> <span class="o">&lt;-</span> <span class="n">pacf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span>
             <span class="n">na</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">na</span><span class="o">.</span><span class="k">pass</span><span class="p">,</span>  <span class="c1"># Funcion para valores faltantes</span>
             <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>         <span class="c1"># Limite eje y</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_112_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_112_0.png" />
</div>
</div>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Realice el diagnostico para los residuales del modelo que ajusto para la serie x.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</div>
<div class="section" id="Procesos-autorregresivos-de-media-movil-ARMA">
<h1>Procesos autorregresivos de media movil ARMA<a class="headerlink" href="#Procesos-autorregresivos-de-media-movil-ARMA" title="Enlazar permanentemente con este título">¶</a></h1>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<p>Los modelos ARMA son modelos autorregresivos de media movil se componen de una parte AR y la otra MA, siguen la siguiente ecuación:</p>
<div class="math notranslate nohighlight">
\[Y_t= c + \phi_1 Y_{t-1} +...+  \phi_p Y_{t-p}+ \epsilon_t + \theta_1 \epsilon_{t-1} + ... + \theta_m \epsilon_{t-m}\]</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`arima.sim</span></code> &lt;<a class="reference external" href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/arima.sim.html">https://stat.ethz.ch/R-manual/R-devel/library/stats/html/arima.sim.html</a>&gt;`__</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Simulacion ARMA(1,1)</span>
<span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>                                        <span class="c1"># Valor Semilla para resultados</span>

<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">arima</span><span class="o">.</span><span class="n">sim</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>                               <span class="c1"># Numero de datos</span>
             <span class="nb">list</span><span class="p">(</span><span class="n">ar</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mf">0.82</span><span class="p">,</span><span class="o">-</span><span class="mf">0.4</span><span class="p">),</span>                 <span class="c1"># Parametro phi del proceso AR</span>
                  <span class="n">ma</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.24</span><span class="p">)),</span>                <span class="c1"># Parametro theta del proceso MA</span>
             <span class="n">innov</span><span class="o">=</span><span class="n">rnorm</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>                    <span class="c1"># Error asociado</span>

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Gráfica proceso ARMA</span>

<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">ts</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>                                  <span class="c1"># tipo de gráfico: o - overplotted</span>
        <span class="n">pch</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>                                    <span class="c1"># tipo de marcador de los puntos)</span>

<span class="n">grid</span><span class="p">()</span>                                             <span class="c1"># Agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_124_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_124_0.png" />
</div>
</div>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Simule un proceso ARMA (1,1) de 50 observaciones utilizando un proceso iterativo como se realizo al comienzo del libro. Utilce:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\phi\)</span> (AR) : 0.8926</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta\)</span> (MA) : -0.2152</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p><strong>Ejercicio.–</strong> Convierta el proceso ARMA generado en un objeto <code class="docutils literal notranslate"><span class="pre">ts</span></code> en R con <code class="docutils literal notranslate"><span class="pre">freq=1</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`arima{stats}</span></code> &lt;<a class="reference external" href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/arima.html">https://stat.ethz.ch/R-manual/R-devel/library/stats/html/arima.html</a>&gt;`__</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="o">.</span><span class="n">fit</span> <span class="o">&lt;-</span> <span class="n">arima</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">order</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>   <span class="c1"># (2,0,2) es un proceso ARMA(2,2)</span>
          <span class="n">include</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">F</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">fit</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Call:
arima(x = x, order = c(2, 0, 2), include.mean = F)

Coefficients:
         ar1      ar2     ma1     ma2
      0.2063  -0.5052  0.4428  1.0000
s.e.  0.1334   0.1305  0.0588  0.1458

sigma^2 estimated as 0.651:  log likelihood = -63.17,  aic = 136.35
</pre></div></div>
</div>
<p>En la presentación de los resultados de la estimación del modelo, el termino <code class="docutils literal notranslate"><span class="pre">s.e</span></code> significa error estandar y se refiere a una estimación de la desviación estandar.</p>
<div class="math notranslate nohighlight">
\[SE_{\bar x} = \frac{s} {\sqrt n}\]</div>
<p>Donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s\)</span> = Desviación estandar de la media</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> = Número de observaciones</p></li>
</ul>
<p>El termino <code class="docutils literal notranslate"><span class="pre">aic</span></code> es el criterio de informacion de Akaike el cual es una medida para seleccionar el mejor modelo estadistico:</p>
<div class="math notranslate nohighlight">
\[AIC = 2k - 2ln(L)\]</div>
<p>Donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k\)</span>: Número de parametrós del modelo</p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span>: Valor máximo de la función de máxima verisimilitud para el modelo estimado.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Grafica de los valores ajustados</span>
<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>


<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>                                                    <span class="c1"># Serie real</span>
     <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;l&quot;</span><span class="p">,</span>                                             <span class="c1"># Tipo de linea</span>
     <span class="n">lwd</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>                                              <span class="c1"># Grosor linea</span>
     <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">lines</span><span class="p">(</span><span class="n">fitted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">fit</span><span class="p">),</span>                                       <span class="c1"># Valores ajustados ARMA</span>
      <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>                                            <span class="c1"># Tipo linea</span>
      <span class="n">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>                                           <span class="c1"># Color linea</span>


<span class="n">legend</span><span class="p">(</span> <span class="s2">&quot;topright&quot;</span><span class="p">,</span>                                        <span class="c1"># posicion</span>
        <span class="n">c</span><span class="p">(</span><span class="s2">&quot;Serie Real&quot;</span><span class="p">,</span> <span class="s2">&quot;Valores Ajust. ARMA(2,2)&quot;</span><span class="p">),</span>       <span class="c1"># texto</span>
        <span class="n">lwd</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>                                   <span class="c1"># grosor lineas</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">),</span>                           <span class="c1"># color lineas</span>
        <span class="n">bty</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span><span class="p">)</span>                                         <span class="c1"># sin caja alrededor de la leyenda</span>

<span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_136_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_136_0.png" />
</div>
</div>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Utilice la serie que generó anteriormente para realizar un ajuste de un modelo ARMA(1,1) para los primeros 48 datos y grafique el ajuste. Deje 2 observaciones para el pronostico.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="o">.</span><span class="k">for</span> <span class="o">&lt;-</span> <span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span><span class="n">n</span><span class="o">.</span><span class="n">ahead</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="k">for</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
$pred
Time Series:
Start = 51
End = 52
Frequency = 1
[1] -0.07960160  0.07689116

$se
Time Series:
Start = 51
End = 52
Frequency = 1
[1] 0.8219568 0.9763276

</pre></div></div>
</div>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Utilice el modelo que ajusto para realizar el pronostico de las 2 observaciones hacia adelante de manera manual y utilizando <code class="docutils literal notranslate"><span class="pre">predict</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</div>
<div class="section" id="Prueba-de-Raiz-Unitaria-Dickey-Fuller">
<h1>Prueba de Raiz Unitaria-Dickey-Fuller<a class="headerlink" href="#Prueba-de-Raiz-Unitaria-Dickey-Fuller" title="Enlazar permanentemente con este título">¶</a></h1>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`adf.test</span></code> &lt;<a class="reference external" href="https://cran.r-project.org/web/packages/tseries/tseries.pdf">https://cran.r-project.org/web/packages/tseries/tseries.pdf</a>&gt;`__</p>
</div></blockquote>
<p>La prueba de Dickey-Fuller es una prueba de hipótesis donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H_o\)</span>: El parametro del proceso autorregresivo <span class="math notranslate nohighlight">\(\phi=1\)</span>, es decir, existe una raiz unitaria.</p></li>
<li><p><span class="math notranslate nohighlight">\(H_a\)</span>: El parametro del proceso autorregresivo <span class="math notranslate nohighlight">\(\phi \neq 1\)</span>.</p></li>
</ul>
<p>Si el parametro de la parte autorregresiva <span class="math notranslate nohighlight">\(\phi=1\)</span> entonces es un proceso No-Estacionario, lo cual impide utilizar los modelos estudiados.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Considere la serie</span>

<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span>  <span class="mf">0.24</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.45</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.67</span><span class="p">,</span>
        <span class="mf">0.67</span><span class="p">,</span>   <span class="mf">1.41</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40</span><span class="p">,</span>  <span class="mf">0.46</span><span class="p">,</span>
        <span class="mf">0.30</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.70</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.48</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.93</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.54</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.63</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.22</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.61</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.53</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.05</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.33</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.23</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.36</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">2.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.82</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.54</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">0.33</span><span class="p">,</span>  <span class="mf">0.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.87</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.62</span><span class="p">,</span>  <span class="mf">0.18</span><span class="p">,</span>  <span class="mf">0.61</span><span class="p">,</span>
        <span class="mf">1.59</span><span class="p">,</span>   <span class="mf">0.65</span>  <span class="p">)</span>

<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">ts</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Prueba de raiz unitaria (Dickey-Fuller)</span>

<span class="n">adf</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

        Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -1.194, Lag order = 3, p-value = 0.8976
alternative hypothesis: stationary

</pre></div></div>
</div>
<p>El valor <span class="math notranslate nohighlight">\(p\)</span> = 0.8976 lo cual indica que la probabilidad de equivocarse dado que se rechace la hipótesis nula es el 89%, por tanto se acepta la hipótesis nula y se confirma que el parametro de la parte autorregresiva <span class="math notranslate nohighlight">\(\phi=1\)</span> y la serie es no-estacionaria.</p>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`diff</span> <span class="pre">{base}</span></code> &lt;<a class="reference external" href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/diff.html">https://stat.ethz.ch/R-manual/R-devel/library/base/html/diff.html</a>&gt;`__</p>
</div></blockquote>
<p>Para utilizar esta metodología para el modelamiento y posterior pronóstico de series de tiempo se debe verificar la estacionaridad de la serie. Esta se puede diagnosticar mediante el test de dickey-fuller que se realizó anteriormente, si la serie resulta no estacionaria se debe diferenciar la serie hasta alcanzar la estacionariedad.</p>
<p>Sea <span class="math notranslate nohighlight">\(Y_t\)</span> una serie de tiempo, su diferenciación simple esta dada por:</p>
<div class="math notranslate nohighlight">
\[Y_t - Y_{t-1}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Ejemplo de diferenciación simple</span>

<span class="n">x</span><span class="o">.</span><span class="n">d</span> <span class="o">&lt;-</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Serie X con presencia de raiz Unit.</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Prueba de raiz unitaria-Dickey-Fuller</span>

<span class="n">adf</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Warning message:
In adf.test(x.d): p-value smaller than printed p-value
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

        Augmented Dickey-Fuller Test

data:  x.d
Dickey-Fuller = -5.3973, Lag order = 3, p-value = 0.01
alternative hypothesis: stationary

</pre></div></div>
</div>
<p>El valor <span class="math notranslate nohighlight">\(p\)</span> es menor a 0.01 lo cual indica que la probabilidad de equivocarse dado que rechace la hipótesis nula es es menor a 1%, por tanto se rechaza la hipótesis nula y se confirma la serie diferenciada es estacionaria ya que no existe presencia de raíz unitaria.</p>
</div>
<div class="section" id="Proceso-autorregresivo-integrado-de-media-móvil-ARIMA">
<h1>Proceso autorregresivo integrado de media móvil ARIMA<a class="headerlink" href="#Proceso-autorregresivo-integrado-de-media-móvil-ARIMA" title="Enlazar permanentemente con este título">¶</a></h1>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<p>El modelo autorregresivo integrado de media movil utilizacion diferenciación de la serie y regresiones para modelar la serie de tiempo, se considera que es un modelo dinamico ya que los datos de predicciones dependen de comportamientos pasados y no de variables externas a la serie.</p>
<p>El proceso <span class="math notranslate nohighlight">\(ARIMA(p,d,q)\)</span>, donde <span class="math notranslate nohighlight">\(p\)</span>,<span class="math notranslate nohighlight">\(d\)</span> y <span class="math notranslate nohighlight">\(q\)</span> son numeros enteros no negativos, se puede representar matematicamente como:</p>
<div class="math notranslate nohighlight">
\[Y_t = -(\Delta^dY_t - Y_t) + \phi_0 + \sum_{i=1}^p \phi_i \Delta^dY_{t-i} - \sum_{i=1}^q  \theta_i \epsilon_{t-i} + \epsilon_t\]</div>
<p>Donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\phi_0\)</span>: Es una constante</p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span>: Corresponde a las <span class="math notranslate nohighlight">\(d\)</span> diferencias que sean necesarias para convertir la serie en estacionaria</p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_1,...,\phi_p\)</span>: Son los parametros asociados a la parte autorregresiva del modelo.</p></li>
<li><p>$:nbsphinx-math:<cite>theta</cite>_1,…,:nbsphinx-math:<cite>theta</cite>_q $: Son los parametros asociados a la parte de medias moviles del modelos</p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon_t\)</span>: Es el termino de error.</p></li>
</ul>
<p>Hay que tener en cuenta que:</p>
<div class="math notranslate nohighlight">
\[\Delta Y_t = Y_t - Y_{t-1}\]</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`arima.sim</span></code> &lt;<a class="reference external" href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/arima.sim.html">https://stat.ethz.ch/R-manual/R-devel/library/stats/html/arima.sim.html</a>&gt;`__</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Simulación</span>
<span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">15221243</span><span class="p">)</span>                                 <span class="c1">#Semilla</span>

<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">arima</span><span class="o">.</span><span class="n">sim</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">order</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>              <span class="c1"># ARIMA(1,1,1) AR(1), Dif(1), MA(1)</span>
                         <span class="n">ar</span> <span class="o">=</span> <span class="mf">0.812</span><span class="p">,</span>               <span class="c1"># Phi-AR</span>
                         <span class="n">ma</span><span class="o">=</span><span class="mf">0.214</span><span class="p">),</span>                <span class="c1"># Theta-MA</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>                        <span class="c1"># Observaciones</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Gráfica proceso ARMA</span>

<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">ts</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>                                  <span class="c1"># tipo de gráfico: o - overplotted</span>
        <span class="n">pch</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>                                    <span class="c1"># tipo de marcador de los puntos)</span>

<span class="n">grid</span><span class="p">()</span>                                             <span class="c1"># Agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_169_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_169_0.png" />
</div>
</div>
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`arima{stats}</span></code> &lt;<a class="reference external" href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/arima.html">https://stat.ethz.ch/R-manual/R-devel/library/stats/html/arima.html</a>&gt;`__</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="o">.</span><span class="n">fit</span> <span class="o">&lt;-</span> <span class="n">arima</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>                    <span class="c1"># Datos de la serie</span>
               <span class="n">order</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>     <span class="c1"># Proceso tipo ARIMA(1,1,1) ar(1), diff(1),ma(1)</span>
          <span class="n">include</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">T</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">fit</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Call:
arima(x = x, order = c(1, 1, 1), include.mean = T)

Coefficients:
         ar1     ma1
      0.7917  0.2077
s.e.  0.0933  0.1392

sigma^2 estimated as 1.523:  log likelihood = -82.12,  aic = 170.25
</pre></div></div>
</div>
<p>En la presentación de los resultados de la estimación del modelo, el termino <code class="docutils literal notranslate"><span class="pre">s.e</span></code> significa error estandar y se refiere a una estimación de la desviación estandar.</p>
<div class="math notranslate nohighlight">
\[SE_{\bar x} = \frac{s} {\sqrt n}\]</div>
<p>Donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s\)</span> = Desviación estandar de la media</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> = Número de observaciones</p></li>
</ul>
<p>El termino <code class="docutils literal notranslate"><span class="pre">aic</span></code> es el criterio de informacion de Akaike el cual es una medida para seleccionar el mejor modelo estadistico:</p>
<div class="math notranslate nohighlight">
\[AIC = 2k - 2ln(L)\]</div>
<p>Donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k\)</span>: Número de parametrós del modelo</p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span>: Valor máximo de la función de máxima verisimilitud para el modelo estimado.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Gráfica valores ajustados vs reales proceso ARIMA</span>

<span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>


<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>                                                   <span class="c1"># Datos serie real</span>
     <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;l&quot;</span><span class="p">,</span>                                            <span class="c1"># Tipo linea</span>
     <span class="n">lwd</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>                                             <span class="c1"># Grosor linea</span>
     <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">70</span><span class="p">))</span>                                        <span class="c1"># Limite eje y</span>

<span class="n">lines</span><span class="p">(</span><span class="n">fitted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">fit</span><span class="p">),</span>                                      <span class="c1"># Valores ajustado ARIMA</span>
      <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>                                           <span class="c1"># Tipo de grafico</span>
      <span class="n">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>                                          <span class="c1"># Color linea</span>

<span class="n">legend</span><span class="p">(</span> <span class="s2">&quot;topright&quot;</span><span class="p">,</span>                                        <span class="c1"># posicion</span>
        <span class="n">c</span><span class="p">(</span><span class="s2">&quot;Serie Real&quot;</span><span class="p">,</span> <span class="s2">&quot;Valores Ajust. ARIMA&quot;</span><span class="p">),</span>           <span class="c1"># texto</span>
        <span class="n">lwd</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>                                   <span class="c1"># grosor lineas</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">),</span>                           <span class="c1"># color lineas</span>
        <span class="n">bty</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span><span class="p">)</span>                                         <span class="c1"># caja alrededor de la leyenda</span>

<span class="n">grid</span><span class="p">()</span>                                                     <span class="c1"># agrega malla</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-10-modelos-arima_175_0.png" src="../../_images/notebooks_timeseries_2-10-modelos-arima_175_0.png" />
</div>
</div>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Convierta el siguiente conjunto de datos en un objeto <code class="docutils literal notranslate"><span class="pre">ts</span></code> de R de frecuencia 1.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span>  <span class="mf">0.00</span><span class="p">,</span>    <span class="mf">0.38</span><span class="p">,</span>   <span class="mf">0.84</span><span class="p">,</span>   <span class="mf">3.64</span><span class="p">,</span>
        <span class="mf">6.01</span><span class="p">,</span>    <span class="mf">7.62</span><span class="p">,</span>   <span class="mf">10.14</span><span class="p">,</span>  <span class="mf">10.69</span><span class="p">,</span>
        <span class="mf">12.27</span><span class="p">,</span>   <span class="mf">12.28</span><span class="p">,</span>  <span class="mf">12.32</span><span class="p">,</span>  <span class="mf">11.58</span><span class="p">,</span>
        <span class="mf">11.44</span><span class="p">,</span>   <span class="mf">10.24</span><span class="p">,</span>  <span class="mf">9.85</span><span class="p">,</span>   <span class="mf">8.15</span><span class="p">,</span>
        <span class="mf">7.01</span><span class="p">,</span>    <span class="mf">5.59</span><span class="p">,</span>   <span class="mf">4.41</span><span class="p">,</span>   <span class="mf">1.46</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.21</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.52</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.68</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.39</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.47</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.70</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.23</span><span class="p">,</span>  <span class="o">-</span><span class="mf">11.27</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">13.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.28</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.69</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.19</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">19.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.64</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.71</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">28.60</span><span class="p">,</span> <span class="o">-</span><span class="mf">31.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.93</span><span class="p">,</span> <span class="o">-</span><span class="mf">36.68</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">39.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">41.40</span><span class="p">,</span> <span class="o">-</span><span class="mf">43.41</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.34</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">46.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">47.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">48.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.10</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">50.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.31</span>       <span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p><strong>Ejercicio.–</strong> Ajuste un modelo ARIMA(1,1,1) para las primeras 48 observaciones serie y deje 2 para el pronóstico. Presente los resultados de la estimación</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<p><a class="reference external" href="#Contenido">Contenido</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="o">.</span><span class="k">for</span><span class="o">&lt;-</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span><span class="n">n</span><span class="o">.</span><span class="n">ahead</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="k">for</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
$pred
Time Series:
Start = 52
End = 54
Frequency = 1
[1] 59.68508 60.18289 60.57702

$se
Time Series:
Start = 52
End = 54
Frequency = 1
[1] 1.233897 2.758452 4.412063

</pre></div></div>
</div>
<hr class="docutils" />
<p><strong>Ejercicio.–</strong> Utilice el modelo que ajusto para realizar el pronostico de 2 observaciones hacia adelante de manera manual y utilizando la función <code class="docutils literal notranslate"><span class="pre">predict</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<p><a class="reference external" href="#Contenido">Contenido</a></p>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Derechos de autor 2019, Juan D. Velasquez.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>