

<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Pronóstico con regresión usando StatModels &mdash; documentación de --- Cursos --- - </title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Modelos estocásticos de precios" href="2-07-modelado-precios.html" />
    <link rel="prev" title="Fundamentos de pronóstico de series de tiempo" href="2-01-fundamentos-pronostico.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Pregrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html">Redes Neuronales Artificiales y Algoritmos Bioinspirados</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Posgrado</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../analitica-de-grandes-datos/index.html">Analítica de Grandes Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ciencia-de-los-datos/index.html">Ciencia de los Datos Aplicada</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../analitica_avanzada/index.html">Analítica Avanzada</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-1">Semana 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-2">Semana 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-3">Semana 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-4">Semana 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-5">Semana 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-6">Semana 6</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-7">Semana 7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica_avanzada/index.html#semana-8">Semana 8</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../analitica_avanzada/index.html">Analítica Avanzada</a> &raquo;</li>
        
      <li>Pronóstico con regresión usando StatModels</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/notebooks/timeseries/2-06-regresion.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Pronóstico-con-regresión-usando-StatModels">
<h1>Pronóstico con regresión usando StatModels<a class="headerlink" href="#Pronóstico-con-regresión-usando-StatModels" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p>34:29 min | Ultima modificación: Marzo 21, 2021 | YouTube</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>


<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
<div class="section" id="Introducción">
<h2>Introducción<a class="headerlink" href="#Introducción" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El pronóstico se basa principalmente en los datos historicos de la serie, teniendo como suposición principal que este comportamiento pasado se puede repetir en el futuro.Existen cuatro patrones o componentes básicos en el estudio de las series de tiempo.</p>
<p><strong>1. Componente de tendencia :math:`{(T_t)}`</strong>: La tendencia es una evolución lenta y a largo plazo de la serie, caracterizado por un crecimiento o decrecimiento de los valores de esta.</p>
<p><a href="#id1"><span class="problematic" id="id2">**</span></a>2. Componente estacional <span class="math notranslate nohighlight">\({(S_t)}\)</span> <a href="#id3"><span class="problematic" id="id4">**</span></a>: La estacionalidad de una serie de tiempo es un patrón que se repite en periodos conocidos, normalmente en una base anual. Este comportamiento se debe principalmente a factores como el clima, días de vacaciones, consumos, estaciones,etc.</p>
<p><strong>3. Componente cíclico :math:`{(C_t)}`</strong> La componente cíclica se refleja en cambios o movimientos de los datos y generalmente estas fluctuaciones duran 2 años o mas. Este comportamiento se asocia normalmente a fluctuaciones economicas de largo plazo.</p>
<p>La diferencia de la componente estacional y cíclica en series de tiempo que la estacionalidad tiene una longitud constante y se repite sobre una base periodíca, mientras que los ciclos cambian en tanto el longitud como en magnitud.</p>
<p><strong>4. Componente aleatorio (Error) :math:`{(E_t)}`</strong>: El componente de error de una serie de tiempo está asociado con variaciones aleatorias sin ningún patrón o comportamiento definido alrededor de una media. Normalmente esta componente se debe a eventos extremos <em>(outliers)</em> en la serie de tiempo.</p>
</div>
</div>
<div class="section" id="Modelo-de-regresión-lineal-simple">
<h1>Modelo de regresión lineal simple<a class="headerlink" href="#Modelo-de-regresión-lineal-simple" title="Enlazar permanentemente con este título">¶</a></h1>
<p><p>El modelo matemático de una regresión lineal simple es expresado como:</p>
</p><center><div class="math notranslate nohighlight">
\[Y = {\beta_0 + \beta_1 {X}_1 + \epsilon}\]</div>
</div></center><p><p>Donde:</p>
</p><ul>
<li><p><p><span class="math notranslate nohighlight">\({Y}\)</span>: Variable dependendiente o variable respuesta</p>
</p></li>
<li><p><p><span class="math notranslate nohighlight">\({X}_1\)</span>: Variable independiente o explicatoria</p>
</p></li>
<li><p><p>$ <span class="math">\beta</span>_0$: Intercepto de la recta de regresión</p>
</p></li>
<li><p><p><span class="math notranslate nohighlight">\(\beta_1\)</span>: Parametro o coeficiente de regresión</p>
</p></li>
<li><p><p><span class="math notranslate nohighlight">\(\epsilon\)</span>: Error aleatorio</p>
</p></li>
</ul>
<p>Los supuestos del modelo:</p>
<p><p><span class="math notranslate nohighlight">\({B}_1\)</span> ~ <span class="math notranslate nohighlight">\(N(\mu_1,{\sigma_1}^2)\)</span></p>
</p><p><p><span class="math notranslate nohighlight">\({B}_0\)</span> ~ <span class="math notranslate nohighlight">\(N(\mu_0,{\sigma_0}^2)\)</span></p>
</p><p>Y en cuanto al error :</p>
<ol class="arabic">
<li><p><p><span class="math notranslate nohighlight">\({E(\epsilon)}\)</span>: 0</p>
</p></li>
<li><p><p><span class="math notranslate nohighlight">\({Var(\epsilon)}\)</span>: <span class="math notranslate nohighlight">\({σ^2}\)</span></p>
</p></li>
<li><p><p>Se supone que su distribución es normal, <span class="math notranslate nohighlight">\(\epsilon\)</span> ~ <span class="math notranslate nohighlight">\({N(0,σ^2)}\)</span></p>
</p></li>
</ol>
<div class="section" id="Modelo-de-tendencia-lineal">
<h2>Modelo de tendencia lineal<a class="headerlink" href="#Modelo-de-tendencia-lineal" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El modelo de regresión lineal simple para estimar la tendencia lineal es:</p>
<div class="math notranslate nohighlight">
\[T_t = \beta_0 + \beta_1 {t} + \epsilon_t\]</div>
<div class="section" id=" Generación-de-series-sintéticas">
<h3> Generación de series sintéticas<a class="headerlink" href="# Generación-de-series-sintéticas" title="Enlazar permanentemente con este título">¶</a></h3>
<p><strong>Ejercicio.—</strong> Grafique una realización del modelo <span class="math notranslate nohighlight">\(y_t = 10 + 0.7*t + e_t\)</span> con <span class="math notranslate nohighlight">\(T\)</span> = 100 y <span class="math notranslate nohighlight">\(e_t\)</span> ~ <span class="math notranslate nohighlight">\(N(0, 0.1^2)\)</span>.</p>
</div>
<div class="section" id="Pronóstico">
<h3>Pronóstico<a class="headerlink" href="#Pronóstico" title="Enlazar permanentemente con este título">¶</a></h3>
<p><strong>Ejercicio.—</strong> Si la serie del ejercicio anterior es la serie real, grafique el pronóstico para las siguientes 20 observaciones y los intervalos de confianza para una desviación estándar.</p>
</div>
<div class="section" id="Estimación">
<h3>Estimación<a class="headerlink" href="#Estimación" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El modelo matemático de tendencia lineal se define como:</p>
<div class="math notranslate nohighlight">
\[y_t = \beta_0 + \beta_1 * t + e_t\]</div>
<p>con:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_0\)</span> ~ <span class="math notranslate nohighlight">\(N(0, \sigma_0^2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_1\)</span> ~ <span class="math notranslate nohighlight">\(N(\mu_1, \sigma_1^2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(e_t\)</span> ~ <span class="math notranslate nohighlight">\(N(0, \sigma_e^2)\)</span></p></li>
</ul>
<p>Y se estima por mínimos cuadrados ordinarios (¿recuerda la formulación matemática?).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># datos</span>
<span class="c1">#</span>
<span class="n">yt_real</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">51.74</span><span class="p">,</span> <span class="mf">48.92</span><span class="p">,</span> <span class="mf">52.12</span><span class="p">,</span> <span class="mf">51.90</span><span class="p">,</span> <span class="mf">50.88</span><span class="p">,</span> <span class="mf">52.52</span><span class="p">,</span> <span class="mf">52.50</span><span class="p">,</span> <span class="mf">55.05</span><span class="p">,</span> <span class="mf">56.73</span><span class="p">,</span> <span class="mf">55.05</span><span class="p">,</span> <span class="mf">56.85</span><span class="p">,</span> <span class="mf">55.29</span><span class="p">,</span>
    <span class="mf">55.70</span><span class="p">,</span> <span class="mf">56.72</span><span class="p">,</span> <span class="mf">56.56</span><span class="p">,</span> <span class="mf">57.85</span><span class="p">,</span> <span class="mf">58.67</span><span class="p">,</span> <span class="mf">59.59</span><span class="p">,</span> <span class="mf">57.61</span><span class="p">,</span> <span class="mf">60.15</span><span class="p">,</span> <span class="mf">60.97</span><span class="p">,</span> <span class="mf">61.47</span><span class="p">,</span> <span class="mf">61.94</span><span class="p">,</span> <span class="mf">63.00</span><span class="p">,</span>
    <span class="mf">60.80</span><span class="p">,</span> <span class="mf">62.67</span><span class="p">,</span> <span class="mf">66.14</span><span class="p">,</span> <span class="mf">64.40</span><span class="p">,</span> <span class="mf">64.04</span><span class="p">,</span> <span class="mf">64.15</span><span class="p">,</span> <span class="mf">65.41</span><span class="p">,</span> <span class="mf">65.47</span><span class="p">,</span> <span class="mf">66.25</span><span class="p">,</span> <span class="mf">67.86</span><span class="p">,</span> <span class="mf">65.97</span><span class="p">,</span> <span class="mf">67.52</span><span class="p">,</span>
    <span class="mf">69.25</span><span class="p">,</span> <span class="mf">67.81</span><span class="p">,</span> <span class="mf">69.53</span><span class="p">,</span> <span class="mf">71.16</span><span class="p">,</span> <span class="mf">71.13</span><span class="p">,</span> <span class="mf">70.24</span><span class="p">,</span> <span class="mf">71.51</span><span class="p">,</span> <span class="mf">71.32</span><span class="p">,</span> <span class="mf">71.34</span><span class="p">,</span> <span class="mf">72.52</span><span class="p">,</span> <span class="mf">73.14</span><span class="p">,</span> <span class="mf">73.33</span><span class="p">,</span>
    <span class="mf">75.21</span><span class="p">,</span> <span class="mf">74.07</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Construcción de la tendencia lineal</span>
<span class="c1">#</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">yt_real</span><span class="p">)))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">yt_real</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Regression Results
==============================================================================
Dep. Variable:                      y   R-squared:                       0.982
Model:                            OLS   Adj. R-squared:                  0.981
Method:                 Least Squares   F-statistic:                     2554.
Date:                Fri, 23 Jul 2021   Prob (F-statistic):           2.78e-43
Time:                        21:38:18   Log-Likelihood:                -69.842
No. Observations:                  50   AIC:                             143.7
Df Residuals:                      48   BIC:                             147.5
Df Model:                           1
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const         50.5266      0.278    181.632      0.000      49.967      51.086
x1             0.4944      0.010     50.539      0.000       0.475       0.514
==============================================================================
Omnibus:                        1.707   Durbin-Watson:                   2.108
Prob(Omnibus):                  0.426   Jarque-Bera (JB):                0.978
Skew:                           0.308   Prob(JB):                        0.613
Kurtosis:                       3.299   Cond. No.                         56.1
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">forecast_plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">fitted_model</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="s1">&#39;o-r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">forecast_plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">fitted_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_16_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_16_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">diag_plot</span><span class="p">(</span><span class="n">fitted_model</span><span class="p">):</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">);</span>

<span class="n">diag_plot</span><span class="p">(</span><span class="n">fitted_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_17_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_17_0.png" />
</div>
</div>
<p><strong>Ejercicio.–</strong> Pronostique los siguientes 20 valores de la serie y grafique los intervalos de confianza.</p>
</div>
</div>
<div class="section" id="Modelo-de-regresión-lineal-multiple">
<h2>Modelo de regresión lineal multiple<a class="headerlink" href="#Modelo-de-regresión-lineal-multiple" title="Enlazar permanentemente con este título">¶</a></h2>
<p><p>Este modelo es una extensión del modelo lineal simple, por lo cual se sigue teniendo los supuestos inicialmente planteados. El modelo matemático de la regresión lineal multiple puede ser expresado como:</p>
</p><center><div class="math notranslate nohighlight">
\[Y = {{B}_0 + {B}_1 {X}_1 + {B}_2 {X}_2 +..+ {B}_k {X}_k + {e}}\]</div>
</div></center></div>
</div>
<div class="section" id="Modelo-de-tendencia-cuadrática">
<h1>Modelo de tendencia cuadrática<a class="headerlink" href="#Modelo-de-tendencia-cuadrática" title="Enlazar permanentemente con este título">¶</a></h1>
<p>El modelo de regresión multiple para estimar la tendencia cuadrática de una serie es:</p>
<div class="math notranslate nohighlight">
\[T_t = \beta_0 + \beta_1 {t} + \beta_2 {t}^2 + \epsilon_t\]</div>
<p><strong>Ejercicio.–</strong> Grafique una realización del modelo <span class="math notranslate nohighlight">\(y_t = 10 + 0.8*t + 0.05 * t^2 + e_t\)</span> con <span class="math notranslate nohighlight">\(T\)</span> = 100 y <span class="math notranslate nohighlight">\(e_t\)</span> ~ <span class="math notranslate nohighlight">\(N(0, 0.1^2)\)</span>.</p>
<p><strong>Ejercicio.–</strong> Si la serie del ejercicio anterior es la serie real, grafique el pronóstico para las siguientes 20 observaciones y los intervalos de confianza para una desviación estándar.</p>
<p>El modelo de regresión multiple para estimar la tendencia cuadrática de una serie es:</p>
<div class="math notranslate nohighlight">
\[y_t = \beta_0 + \beta_1 {t} + \beta_2 {t}^2 + e_t\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">yt_real</span> <span class="o">=</span> <span class="p">[</span>
     <span class="mf">23.47</span><span class="p">,</span>  <span class="mf">25.32</span><span class="p">,</span>  <span class="mf">19.66</span><span class="p">,</span>  <span class="mf">26.91</span><span class="p">,</span>  <span class="mf">19.08</span><span class="p">,</span>  <span class="mf">22.88</span><span class="p">,</span>  <span class="mf">35.49</span><span class="p">,</span>  <span class="mf">23.33</span><span class="p">,</span>  <span class="mf">25.26</span><span class="p">,</span>  <span class="mf">27.22</span><span class="p">,</span>  <span class="mf">32.99</span><span class="p">,</span>  <span class="mf">36.45</span><span class="p">,</span>
     <span class="mf">35.20</span><span class="p">,</span>  <span class="mf">39.99</span><span class="p">,</span>  <span class="mf">45.94</span><span class="p">,</span>  <span class="mf">47.29</span><span class="p">,</span>  <span class="mf">47.34</span><span class="p">,</span>  <span class="mf">46.39</span><span class="p">,</span>  <span class="mf">50.79</span><span class="p">,</span>  <span class="mf">53.07</span><span class="p">,</span>  <span class="mf">55.61</span><span class="p">,</span>  <span class="mf">59.22</span><span class="p">,</span>  <span class="mf">65.38</span><span class="p">,</span>  <span class="mf">63.58</span><span class="p">,</span>
     <span class="mf">69.53</span><span class="p">,</span>  <span class="mf">78.23</span><span class="p">,</span>  <span class="mf">78.52</span><span class="p">,</span>  <span class="mf">82.44</span><span class="p">,</span>  <span class="mf">90.66</span><span class="p">,</span>  <span class="mf">82.86</span><span class="p">,</span>  <span class="mf">93.54</span><span class="p">,</span>  <span class="mf">94.05</span><span class="p">,</span> <span class="mf">101.24</span><span class="p">,</span>  <span class="mf">97.06</span><span class="p">,</span> <span class="mf">119.74</span><span class="p">,</span> <span class="mf">119.75</span><span class="p">,</span>
    <span class="mf">118.28</span><span class="p">,</span> <span class="mf">116.69</span><span class="p">,</span> <span class="mf">126.91</span><span class="p">,</span> <span class="mf">132.68</span><span class="p">,</span> <span class="mf">137.10</span><span class="p">,</span> <span class="mf">151.43</span><span class="p">,</span> <span class="mf">151.47</span><span class="p">,</span> <span class="mf">146.06</span><span class="p">,</span> <span class="mf">154.55</span><span class="p">,</span> <span class="mf">156.77</span><span class="p">,</span> <span class="mf">164.12</span><span class="p">,</span> <span class="mf">176.14</span><span class="p">,</span>
    <span class="mf">171.41</span><span class="p">,</span> <span class="mf">192.8</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Construcción de la tendencia lineal</span>
<span class="c1">#</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">yt_real</span><span class="p">)))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Regression Results
==============================================================================
Dep. Variable:                      y   R-squared:                       0.992
Model:                            OLS   Adj. R-squared:                  0.992
Method:                 Least Squares   F-statistic:                     2929.
Date:                Fri, 23 Jul 2021   Prob (F-statistic):           4.69e-50
Time:                        21:38:18   Log-Likelihood:                -145.61
No. Observations:                  50   AIC:                             297.2
Df Residuals:                      47   BIC:                             303.0
Df Model:                           2
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const         19.6821      1.872     10.511      0.000      15.915      23.449
x1             0.8962      0.177      5.071      0.000       0.541       1.252
x2             0.0507      0.003     14.539      0.000       0.044       0.058
==============================================================================
Omnibus:                        1.895   Durbin-Watson:                   2.053
Prob(Omnibus):                  0.388   Jarque-Bera (JB):                1.813
Skew:                           0.436   Prob(JB):                        0.404
Kurtosis:                       2.666   Cond. No.                     3.16e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 3.16e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Pronostico</span>
<span class="n">forecast_plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">fitted_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_28_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_28_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diag_plot</span><span class="p">(</span><span class="n">fitted_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_29_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_29_0.png" />
</div>
</div>
<p><strong>Ejercicio.–</strong> Pronostique los siguientes 20 valores de la serie y grafique los intervalos de confianza.</p>
<p><strong>Ejercicio.–</strong>. Realice un modelo lineal , un modelo cuadrático y un modelo cúbico para ajustar la tendencia de la siguiente serie.</p>
<ul class="simple">
<li><p>Haga el diagnóstico completo de cada modelo.</p></li>
<li><p>¿Cuál es el mejor?</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">yt_real</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">152.50</span><span class="p">,</span> <span class="mf">212.01</span><span class="p">,</span>  <span class="mf">70.63</span><span class="p">,</span>  <span class="mf">58.90</span><span class="p">,</span>
    <span class="mf">134.84</span><span class="p">,</span> <span class="mf">163.58</span><span class="p">,</span> <span class="mf">105.02</span><span class="p">,</span>  <span class="mf">42.40</span><span class="p">,</span>
    <span class="mf">109.16</span><span class="p">,</span> <span class="mf">173.84</span><span class="p">,</span>  <span class="mf">86.63</span><span class="p">,</span>  <span class="mf">64.35</span><span class="p">,</span>
    <span class="mf">185.66</span><span class="p">,</span> <span class="mf">153.66</span><span class="p">,</span> <span class="mf">133.03</span><span class="p">,</span>  <span class="mf">56.12</span><span class="p">,</span>
    <span class="mf">151.76</span><span class="p">,</span> <span class="mf">205.41</span><span class="p">,</span> <span class="mf">121.47</span><span class="p">,</span>  <span class="mf">96.01</span><span class="p">,</span>
    <span class="mf">171.70</span><span class="p">,</span> <span class="mf">184.69</span><span class="p">,</span> <span class="mf">120.68</span><span class="p">,</span> <span class="mf">112.08</span><span class="p">,</span>
    <span class="mf">175.09</span><span class="p">,</span> <span class="mf">235.06</span><span class="p">,</span> <span class="mf">128.85</span><span class="p">,</span> <span class="mf">123.47</span><span class="p">,</span>
    <span class="mf">180.03</span><span class="p">,</span> <span class="mf">154.95</span><span class="p">,</span> <span class="mf">134.25</span><span class="p">,</span> <span class="mf">129.45</span><span class="p">,</span>
    <span class="mf">229.37</span><span class="p">,</span> <span class="mf">238.49</span><span class="p">,</span> <span class="mf">204.75</span><span class="p">,</span> <span class="mf">206.34</span><span class="p">,</span>
    <span class="mf">243.25</span><span class="p">,</span> <span class="mf">292.75</span><span class="p">,</span> <span class="mf">223.15</span><span class="p">,</span> <span class="mf">190.72</span><span class="p">,</span>
    <span class="mf">338.10</span><span class="p">,</span> <span class="mf">312.32</span><span class="p">,</span> <span class="mf">284.76</span><span class="p">,</span> <span class="mf">248.44</span><span class="p">,</span>
    <span class="mf">331.62</span><span class="p">,</span> <span class="mf">374.42</span><span class="p">,</span> <span class="mf">331.07</span><span class="p">,</span> <span class="mf">305.67</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="Modelo-de-regresión-multiple-para-componente-de-tendencia-y-estacionalidad.">
<h2>Modelo de regresión multiple para componente de tendencia y estacionalidad.<a class="headerlink" href="#Modelo-de-regresión-multiple-para-componente-de-tendencia-y-estacionalidad." title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para modelar la componente estacional <span class="math notranslate nohighlight">\(S_t\)</span> debe:</p>
<ol class="arabic simple">
<li><p>Identificar el periodo de la serie de tiempo <span class="math notranslate nohighlight">\(y_t\)</span></p></li>
<li><p>Generar las variables indicadoras <span class="math notranslate nohighlight">\(I_{j} (t)\)</span>, para <span class="math notranslate nohighlight">\(t=1,..S\)</span>, que indica al modelo de ajuste en que periodo de tiempo se encuentra mediante {0,1}.</p></li>
<li><p>Estimar los parametros del modelo.</p></li>
</ol>
<p>Por tanto el modelo de regresión completo queda como:</p>
<div class="math notranslate nohighlight">
\[Y_t = T_t + S_t = \beta_0 + \sum_{j=1}^{k} \beta_j {t^j} + \sum_{j=1}^{s-1} \delta_j I_j {t} + \epsilon_T\]</div>
<div class="section" id="Generación-de-series-sintéticas">
<h3>Generación de series sintéticas<a class="headerlink" href="#Generación-de-series-sintéticas" title="Enlazar permanentemente con este título">¶</a></h3>
<p><strong>Ejercicio.–</strong> Grafique una realización del modelo <span class="math notranslate nohighlight">\(y_t = 10 + 0.8*t + 0.05 * t^2 + 1.5 * I_{1, t} + 1.0 * I_{2, t} + 0.3 * I_{3, t} + e_t\)</span> con:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(T\)</span> = 40</p></li>
<li><p><span class="math notranslate nohighlight">\(e_t\)</span> ~ <span class="math notranslate nohighlight">\(N(0, 0.1^2)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(I_{1, t}\)</span> = 1, 0, 0, 0, 1, 0, 0, 0, 1, 0…</p></li>
<li><p><span class="math notranslate nohighlight">\(I_{2, t}\)</span> = 0, 1, 0, 0, 0, 1, 0, 0, 0, 1…</p></li>
<li><p><span class="math notranslate nohighlight">\(I_{3, t}\)</span> = 0, 0, 1, 0, 0, 0, 1, 0, 0, 0…</p></li>
</ul>
</div>
<div class="section" id="id6">
<h3>Pronóstico<a class="headerlink" href="#id6" title="Enlazar permanentemente con este título">¶</a></h3>
<p><strong>Ejercicio.–</strong> Si la serie del ejercicio anterior es la serie real, grafique el pronóstico para las siguientes 20 observaciones y los intervalos de confianza para una desviación estándar.</p>
</div>
<div class="section" id="id7">
<h3>Estimación<a class="headerlink" href="#id7" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El siguiente modelo matemático es estimado por mínimos cuadrados ordinarios, al igual que en los casos anteriores:</p>
<div class="math notranslate nohighlight">
\[y_t =  \beta_0 + \sum_{j=1}^{k} \beta_j * t^j + \sum_{j=1}^{s-1} \delta_j * I_t + e_t\]</div>
<p>Como paso adicional se deben generar las variables indicadoras <span class="math notranslate nohighlight">\(I_{s, t}\)</span> con <span class="math notranslate nohighlight">\(S=1, ..., S-1\)</span> donde <span class="math notranslate nohighlight">\(S\)</span> es el período de la componente cíclica del modelo.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Esta serie es trimestral</span>
<span class="n">yt_real</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">12.82</span><span class="p">,</span> <span class="mf">13.03</span><span class="p">,</span> <span class="mf">11.58</span><span class="p">,</span> <span class="mf">11.77</span><span class="p">,</span>
    <span class="mf">12.84</span><span class="p">,</span> <span class="mf">13.07</span><span class="p">,</span> <span class="mf">12.36</span><span class="p">,</span> <span class="mf">12.14</span><span class="p">,</span>
    <span class="mf">12.96</span><span class="p">,</span> <span class="mf">13.63</span><span class="p">,</span> <span class="mf">12.83</span><span class="p">,</span> <span class="mf">12.16</span><span class="p">,</span>
    <span class="mf">13.98</span><span class="p">,</span> <span class="mf">13.88</span><span class="p">,</span> <span class="mf">13.14</span><span class="p">,</span> <span class="mf">13.27</span><span class="p">,</span>
    <span class="mf">13.90</span><span class="p">,</span> <span class="mf">14.24</span><span class="p">,</span> <span class="mf">13.46</span><span class="p">,</span> <span class="mf">13.25</span><span class="p">,</span>
    <span class="mf">14.54</span><span class="p">,</span> <span class="mf">14.45</span><span class="p">,</span> <span class="mf">14.08</span><span class="p">,</span> <span class="mf">13.83</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="s1">&#39;o-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_40_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_40_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Longitud de la serie de tiempo</span>
<span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">yt_real</span><span class="p">)</span>

<span class="c1"># Tendencia lineal</span>
<span class="n">t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>

<span class="c1"># Variabes dummy</span>
<span class="n">q1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">t</span> <span class="o">%</span> <span class="mi">4</span> <span class="k">else</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">)]</span>
<span class="n">q2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="k">else</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">)]</span>
<span class="n">q3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="k">else</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">)]</span>

<span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q3</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
([1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0],
 [0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0],
 [0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Construcción de la tendencia lineal</span>
<span class="c1">#</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q3</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Particion en entrenamiento y prueba</span>
<span class="c1">#</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="mi">25</span><span class="p">,:]</span>
<span class="n">yt_train_real</span> <span class="o">=</span> <span class="n">yt_real</span><span class="p">[:</span><span class="mi">25</span><span class="p">]</span>

<span class="c1">#</span>
<span class="c1"># Estimación del modelo</span>
<span class="c1">#</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">yt_train_real</span><span class="p">,</span> <span class="n">x_train</span><span class="p">)</span>
<span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Regression Results
==============================================================================
Dep. Variable:                      y   R-squared:                       0.939
Model:                            OLS   Adj. R-squared:                  0.926
Method:                 Least Squares   F-statistic:                     72.59
Date:                Fri, 23 Jul 2021   Prob (F-statistic):           3.06e-11
Time:                        21:38:19   Log-Likelihood:                 4.6553
No. Observations:                  24   AIC:                            0.6893
Df Residuals:                      19   BIC:                             6.580
Df Model:                           4
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const         11.4713      0.126     90.876      0.000      11.207      11.735
x1             0.0973      0.007     14.543      0.000       0.083       0.111
x2             1.0620      0.131      8.115      0.000       0.788       1.336
x3             1.1747      0.130      9.035      0.000       0.903       1.447
x4             0.2690      0.130      2.077      0.052      -0.002       0.540
==============================================================================
Omnibus:                        0.434   Durbin-Watson:                   2.487
Prob(Omnibus):                  0.805   Jarque-Bera (JB):                0.559
Skew:                          -0.242   Prob(JB):                        0.756
Kurtosis:                       2.431   Cond. No.                         61.6
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Diagnostico</span>
<span class="c1">#</span>
<span class="n">diag_plot</span><span class="p">(</span><span class="n">fitted_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_43_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_43_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Pronostico</span>
<span class="c1">#</span>
<span class="n">yt_pred</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_predicted</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">yt_pred</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="s1">&#39;o-r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yt_pred</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_predicted</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">yt_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_44_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_44_0.png" />
</div>
</div>
<p><strong>Ejercicio.–</strong> La componente estacional también puede represntarse como:</p>
<div class="math notranslate nohighlight">
\[S_t =\beta * \cos (2\pi f t + \Phi)\]</div>
<p>Para el ejercicio anterior, reemplace las variables dummy por esta componente, estime el modelo y realice el pronóstico.</p>
</div>
</div>
</div>
<div class="section" id="Intervenciones-----Cambio-de-nivel">
<h1>Intervenciones — Cambio de nivel<a class="headerlink" href="#Intervenciones-----Cambio-de-nivel" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">yt_real</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">11.60</span><span class="p">,</span> <span class="mf">16.04</span><span class="p">,</span> <span class="mf">21.99</span><span class="p">,</span> <span class="mf">16.29</span><span class="p">,</span>
    <span class="mf">24.50</span><span class="p">,</span> <span class="mf">18.57</span><span class="p">,</span> <span class="mf">20.69</span><span class="p">,</span> <span class="mf">18.46</span><span class="p">,</span>
    <span class="mf">22.41</span><span class="p">,</span> <span class="mf">23.60</span><span class="p">,</span> <span class="mf">21.98</span><span class="p">,</span> <span class="mf">28.47</span><span class="p">,</span>
    <span class="mf">26.74</span><span class="p">,</span> <span class="mf">25.46</span><span class="p">,</span> <span class="mf">27.67</span><span class="p">,</span> <span class="mf">28.80</span><span class="p">,</span>
    <span class="mf">27.20</span><span class="p">,</span> <span class="mf">31.74</span><span class="p">,</span> <span class="mf">28.79</span><span class="p">,</span> <span class="mf">32.87</span><span class="p">,</span>
    <span class="mf">35.91</span><span class="p">,</span> <span class="mf">33.80</span><span class="p">,</span> <span class="mf">38.97</span><span class="p">,</span> <span class="mf">36.69</span><span class="p">,</span>
    <span class="mf">39.39</span><span class="p">,</span> <span class="mf">69.19</span><span class="p">,</span> <span class="mf">69.00</span><span class="p">,</span> <span class="mf">68.20</span><span class="p">,</span>
    <span class="mf">73.84</span><span class="p">,</span> <span class="mf">77.81</span><span class="p">,</span> <span class="mf">74.44</span><span class="p">,</span> <span class="mf">75.23</span><span class="p">,</span>
    <span class="mf">78.39</span><span class="p">,</span> <span class="mf">77.43</span><span class="p">,</span> <span class="mf">76.73</span><span class="p">,</span> <span class="mf">82.60</span><span class="p">,</span>
    <span class="mf">80.22</span><span class="p">,</span> <span class="mf">83.32</span><span class="p">,</span> <span class="mf">82.74</span><span class="p">,</span> <span class="mf">83.58</span><span class="p">,</span>
    <span class="mf">84.81</span><span class="p">,</span> <span class="mf">85.55</span><span class="p">,</span> <span class="mf">87.92</span><span class="p">,</span> <span class="mf">85.47</span><span class="p">,</span>
    <span class="mf">90.26</span><span class="p">,</span> <span class="mf">89.12</span><span class="p">,</span> <span class="mf">88.02</span><span class="p">,</span> <span class="mf">90.12</span><span class="p">,</span>
    <span class="mf">91.54</span><span class="p">,</span> <span class="mf">88.84</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="s1">&#39;o-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_48_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_48_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Longitud de la serie de tiempo</span>
<span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">yt_real</span><span class="p">)</span>

<span class="c1"># Tendencia lineal</span>
<span class="n">t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>

<span class="c1"># Se introduce una variable dummy que vale 0</span>
<span class="c1"># antes del cambio y 1 a partir del cambio</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">time</span> <span class="o">&lt;</span> <span class="n">t0</span> <span class="k">else</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">dummy</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Regression Results
==============================================================================
Dep. Variable:                      y   R-squared:                       0.994
Model:                            OLS   Adj. R-squared:                  0.994
Method:                 Least Squares   F-statistic:                     4150.
Date:                Fri, 23 Jul 2021   Prob (F-statistic):           1.38e-53
Time:                        21:38:20   Log-Likelihood:                -108.80
No. Observations:                  50   AIC:                             223.6
Df Residuals:                      47   BIC:                             229.3
Df Model:                           2
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const         15.0855      0.679     22.210      0.000      13.719      16.452
x1             0.9383      0.043     21.755      0.000       0.852       1.025
x2            31.5719      1.245     25.363      0.000      29.068      34.076
==============================================================================
Omnibus:                        2.307   Durbin-Watson:                   2.241
Prob(Omnibus):                  0.315   Jarque-Bera (JB):                1.672
Skew:                           0.443   Prob(JB):                        0.433
Kurtosis:                       3.131   Cond. No.                         118.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Pronostico</span>
<span class="c1">#</span>
<span class="n">forecast_plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">fitted_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_50_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_50_0.png" />
</div>
</div>
<p><strong>Pregunta.—</strong> Cómo se busca el punto exacto de un cambio de nivel?</p>
</div>
<div class="section" id="Intervenciones----cambio-de-pendiente">
<h1>Intervenciones – cambio de pendiente<a class="headerlink" href="#Intervenciones----cambio-de-pendiente" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">yt_real</span> <span class="o">=</span> <span class="p">[</span>
      <span class="mf">3.20</span><span class="p">,</span>   <span class="mf">2.79</span><span class="p">,</span>   <span class="mf">3.43</span><span class="p">,</span>   <span class="mf">5.55</span><span class="p">,</span>
      <span class="mf">6.69</span><span class="p">,</span>   <span class="mf">9.92</span><span class="p">,</span>   <span class="mf">7.45</span><span class="p">,</span>   <span class="mf">9.84</span><span class="p">,</span>
     <span class="mf">10.25</span><span class="p">,</span>  <span class="mf">13.15</span><span class="p">,</span>  <span class="mf">12.86</span><span class="p">,</span>  <span class="mf">14.80</span><span class="p">,</span>
     <span class="mf">17.48</span><span class="p">,</span>  <span class="mf">15.04</span><span class="p">,</span>  <span class="mf">17.01</span><span class="p">,</span>  <span class="mf">18.65</span><span class="p">,</span>
     <span class="mf">19.27</span><span class="p">,</span>  <span class="mf">19.45</span><span class="p">,</span>  <span class="mf">19.62</span><span class="p">,</span>  <span class="mf">20.91</span><span class="p">,</span>
     <span class="mf">23.82</span><span class="p">,</span>  <span class="mf">22.86</span><span class="p">,</span>  <span class="mf">24.63</span><span class="p">,</span>  <span class="mf">24.16</span><span class="p">,</span>
     <span class="mf">29.40</span><span class="p">,</span>  <span class="mf">34.67</span><span class="p">,</span>  <span class="mf">37.95</span><span class="p">,</span>  <span class="mf">38.31</span><span class="p">,</span>
     <span class="mf">48.16</span><span class="p">,</span>  <span class="mf">53.54</span><span class="p">,</span>  <span class="mf">53.70</span><span class="p">,</span>  <span class="mf">57.28</span><span class="p">,</span>
     <span class="mf">66.94</span><span class="p">,</span>  <span class="mf">63.06</span><span class="p">,</span>  <span class="mf">69.10</span><span class="p">,</span>  <span class="mf">72.28</span><span class="p">,</span>
     <span class="mf">80.93</span><span class="p">,</span>  <span class="mf">84.76</span><span class="p">,</span>  <span class="mf">88.22</span><span class="p">,</span>  <span class="mf">89.48</span><span class="p">,</span>
     <span class="mf">98.22</span><span class="p">,</span>  <span class="mf">99.90</span><span class="p">,</span> <span class="mf">103.34</span><span class="p">,</span> <span class="mf">110.44</span><span class="p">,</span>
    <span class="mf">108.02</span><span class="p">,</span> <span class="mf">110.50</span><span class="p">,</span> <span class="mf">115.34</span><span class="p">,</span> <span class="mf">117.55</span><span class="p">,</span>
    <span class="mf">125.79</span><span class="p">,</span> <span class="mf">127.41</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="s1">&#39;o-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_54_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_54_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Longitud de la serie de tiempo</span>
<span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">yt_real</span><span class="p">)</span>

<span class="c1"># Tendencia lineal</span>
<span class="n">t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>

<span class="c1"># Se introduce una variable dummy que vale 0</span>
<span class="c1"># antes del cambio de pendinete y luego vale</span>
<span class="c1"># 1, 2, 3, ...</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">t0</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">t0</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">dummy</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Regression Results
==============================================================================
Dep. Variable:                      y   R-squared:                       0.997
Model:                            OLS   Adj. R-squared:                  0.997
Method:                 Least Squares   F-statistic:                     8695.
Date:                Fri, 23 Jul 2021   Prob (F-statistic):           4.16e-61
Time:                        21:38:20   Log-Likelihood:                -106.88
No. Observations:                  50   AIC:                             219.8
Df Residuals:                      47   BIC:                             225.5
Df Model:                           2
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const          2.6228      0.791      3.314      0.002       1.031       4.215
x1             1.0309      0.050     20.646      0.000       0.930       1.131
x2             2.9432      0.083     35.311      0.000       2.776       3.111
==============================================================================
Omnibus:                        1.753   Durbin-Watson:                   1.720
Prob(Omnibus):                  0.416   Jarque-Bera (JB):                1.416
Skew:                           0.411   Prob(JB):                        0.493
Kurtosis:                       2.933   Cond. No.                         80.2
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Pronostico</span>
<span class="c1">#</span>
<span class="n">forecast_plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">fitted_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_56_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_56_0.png" />
</div>
</div>
</div>
<div class="section" id="Intervenciones----datos-atípicos-(outliers)">
<h1>Intervenciones – datos atípicos (outliers)<a class="headerlink" href="#Intervenciones----datos-atípicos-(outliers)" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">yt_real</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">17.60</span><span class="p">,</span> <span class="mf">19.16</span><span class="p">,</span> <span class="mf">21.21</span><span class="p">,</span> <span class="mf">21.67</span><span class="p">,</span>
    <span class="mf">21.79</span><span class="p">,</span> <span class="mf">22.59</span><span class="p">,</span> <span class="mf">23.52</span><span class="p">,</span> <span class="mf">20.00</span><span class="p">,</span>
    <span class="mf">23.37</span><span class="p">,</span> <span class="mf">28.46</span><span class="p">,</span> <span class="mf">29.89</span><span class="p">,</span> <span class="mf">27.80</span><span class="p">,</span>
    <span class="mf">28.34</span><span class="p">,</span> <span class="mf">25.85</span><span class="p">,</span> <span class="mf">26.98</span><span class="p">,</span> <span class="mf">29.90</span><span class="p">,</span>
    <span class="mf">91.40</span><span class="p">,</span> <span class="mf">30.13</span><span class="p">,</span> <span class="mf">35.28</span><span class="p">,</span> <span class="mf">35.01</span><span class="p">,</span>
    <span class="mf">33.57</span><span class="p">,</span> <span class="mf">35.71</span><span class="p">,</span> <span class="mf">39.49</span><span class="p">,</span> <span class="mf">37.16</span><span class="p">,</span>
    <span class="mf">38.32</span><span class="p">,</span> <span class="mf">40.10</span><span class="p">,</span> <span class="mf">41.66</span><span class="p">,</span> <span class="mf">43.71</span><span class="p">,</span>
    <span class="mf">44.17</span><span class="p">,</span> <span class="mf">44.29</span><span class="p">,</span> <span class="mf">45.09</span><span class="p">,</span> <span class="mf">46.02</span><span class="p">,</span>
    <span class="mf">42.50</span><span class="p">,</span> <span class="mf">45.87</span><span class="p">,</span> <span class="mf">50.96</span><span class="p">,</span> <span class="mf">52.39</span><span class="p">,</span>
    <span class="mf">50.30</span><span class="p">,</span> <span class="mf">50.84</span><span class="p">,</span> <span class="mf">48.35</span><span class="p">,</span> <span class="mf">49.48</span><span class="p">,</span>
    <span class="mf">52.40</span><span class="p">,</span> <span class="mf">54.19</span><span class="p">,</span> <span class="mf">52.63</span><span class="p">,</span> <span class="mf">57.78</span><span class="p">,</span>
    <span class="mf">57.51</span><span class="p">,</span> <span class="mf">56.07</span><span class="p">,</span> <span class="mf">58.21</span><span class="p">,</span> <span class="mf">61.99</span><span class="p">,</span>
    <span class="mf">59.66</span><span class="p">,</span> <span class="mf">60.82</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="s1">&#39;o-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_59_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_59_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Longitud de la serie de tiempo</span>
<span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">yt_real</span><span class="p">)</span>

<span class="c1"># Tendencia lineal</span>
<span class="n">t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>

<span class="c1"># Se introduce una variable dummy que vale 1</span>
<span class="c1"># en el outlier y 0 en caso contrario</span>

<span class="n">t0</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span>
<span class="n">dummy</span><span class="p">[</span><span class="n">t0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">dummy</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Regression Results
==============================================================================
Dep. Variable:                      y   R-squared:                       0.668
Model:                            OLS   Adj. R-squared:                  0.654
Method:                 Least Squares   F-statistic:                     47.31
Date:                Fri, 23 Jul 2021   Prob (F-statistic):           5.53e-12
Time:                        21:38:21   Log-Likelihood:                -177.94
No. Observations:                  50   AIC:                             361.9
Df Residuals:                      47   BIC:                             367.6
Df Model:                           2
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const         20.1719      2.448      8.240      0.000      15.247      25.097
x1             0.8356      0.086      9.727      0.000       0.663       1.008
x2            -0.9608      8.854     -0.109      0.914     -18.774      16.852
==============================================================================
Omnibus:                      106.142   Durbin-Watson:                   2.154
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             3660.708
Skew:                           6.284   Prob(JB):                         0.00
Kurtosis:                      42.990   Cond. No.                         203.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Pronostico</span>
<span class="c1">#</span>
<span class="n">forecast_plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="n">fitted_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_61_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_61_0.png" />
</div>
</div>
<p><strong>Ejercicio.—</strong> Determine que tipo de intervención presenta la siguiente serie de tiempo y ajuste un modelo de regresión.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">yt_real</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">14.12</span><span class="p">,</span> <span class="mf">16.23</span><span class="p">,</span> <span class="mf">14.99</span><span class="p">,</span> <span class="mf">14.73</span><span class="p">,</span>
    <span class="mf">16.33</span><span class="p">,</span> <span class="mf">16.82</span><span class="p">,</span> <span class="mf">14.94</span><span class="p">,</span> <span class="mf">15.50</span><span class="p">,</span>
    <span class="mf">14.86</span><span class="p">,</span> <span class="mf">14.83</span><span class="p">,</span> <span class="mf">13.34</span><span class="p">,</span> <span class="mf">15.03</span><span class="p">,</span>
    <span class="mf">15.47</span><span class="p">,</span> <span class="mf">15.96</span><span class="p">,</span> <span class="mf">15.94</span><span class="p">,</span> <span class="mf">15.18</span><span class="p">,</span>
    <span class="mf">15.54</span><span class="p">,</span> <span class="mf">15.35</span><span class="p">,</span> <span class="mf">13.05</span><span class="p">,</span> <span class="mf">13.77</span><span class="p">,</span>
    <span class="mf">16.83</span><span class="p">,</span> <span class="mf">14.32</span><span class="p">,</span> <span class="mf">13.94</span><span class="p">,</span> <span class="mf">14.40</span><span class="p">,</span>
    <span class="mf">16.90</span><span class="p">,</span> <span class="mf">29.36</span><span class="p">,</span> <span class="mf">31.25</span><span class="p">,</span> <span class="mf">30.13</span><span class="p">,</span>
    <span class="mf">28.60</span><span class="p">,</span> <span class="mf">30.91</span><span class="p">,</span> <span class="mf">30.54</span><span class="p">,</span> <span class="mf">32.30</span><span class="p">,</span>
    <span class="mf">30.47</span><span class="p">,</span> <span class="mf">30.73</span><span class="p">,</span> <span class="mf">29.94</span><span class="p">,</span> <span class="mf">29.41</span><span class="p">,</span>
    <span class="mf">28.52</span><span class="p">,</span> <span class="mf">30.92</span><span class="p">,</span> <span class="mf">31.22</span><span class="p">,</span> <span class="mf">28.21</span><span class="p">,</span>
    <span class="mf">29.84</span><span class="p">,</span> <span class="mf">29.37</span><span class="p">,</span> <span class="mf">29.33</span><span class="p">,</span> <span class="mf">30.66</span><span class="p">,</span>
    <span class="mf">28.92</span><span class="p">,</span> <span class="mf">28.70</span><span class="p">,</span> <span class="mf">30.07</span><span class="p">,</span> <span class="mf">29.94</span><span class="p">,</span>
    <span class="mf">30.08</span><span class="p">,</span> <span class="mf">31.36</span>
<span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yt_real</span><span class="p">,</span> <span class="s1">&#39;o-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_timeseries_2-06-regresion_63_0.png" src="../../_images/notebooks_timeseries_2-06-regresion_63_0.png" />
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Derechos de autor 2019, Juan D. Velasquez.

    </p>
  </div>
    
    
    
    Construido con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>